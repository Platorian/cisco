
In this lab, you will complete the following objectives:

- Part 1: Investigate Password Attacks
- Part 2: Crack Hashes with Hashcat Dictionary Attacks
- Part 3: Crack Hashes with John the Ripper Using Dictionary and Brute Force Attacks
- Part 4: Crack Hashes using RainbowCrack and Rainbow Tables

---

Which tool is a Microsoft password cracker that uses rainbow tables? Which subcategory contains this tool? Ophcrack, offline attacks.

### Crack hashes with Hashcat.

1. To crack the hashes contained in the **my_pw_hashes.txt** file use the following command:

┌──(kali㉿Kali)-[~]

└─$ **sudo hashcat -m 0 -a 0 -o cracked.txt my_pw_hashes.txt /usr/share/wordlists/rockyou.txt**

This command outputs the cracked passwords in the new **cracked.txt** file.

## Crack Hashes with John the Ripper Using Dictionary and Brute Force Attacks

Use the following command to crack the hashes in the **my_pw_hashes** file. This may take some time.

┌──(kali㉿Kali)-[~]

└─$ **john --format=raw-md5 my_pw_hashes.txt**

Larger wordlist

```
john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 my_pw_hashes.txt
```

### Use brute force.

To instruct John the Ripper to use only brute force cracking use the following command:

```
john --incremental my_pw_hashes.txt
```

### Show your cracked passwords.

In this example, if you interrupted the password cracking process using john and the raw-md5 format, you can still review the cracked passwords using the **--show** option.

┌──(kali㉿Kali)-[~]

└─$ **john --show --format=raw-md5 my_pw_hashes.txt**

---

### Install RainbowCrack.

The RainbowCrack utility may need to be installed. Rainbow crack differs from hash cracking utilities that use brute force algorithms in that it uses rainbow tables to crack password hashes.

To install RainbowCrack enter the following command:

┌──(kali㉿Kali)-[~]

└─$ **sudo apt install rainbowcrack**

### Creating rainbow tables with rtgen.

Rainbow tables are ordinary files and can be created with RainbowCrack, or they can be downloaded from the internet. Creating a rainbow table can take a considerable amount of time and storage space as they are very large, ranging in size from 20GB to more than a terabyte.

1. Create a small simple rainbow table that will crack MD5 passwords of up to 3 characters with only lowercase letters.

The **rtgen** program is used to generate rainbow tables based on user specified parameters.

1. Enter the **rtgen -h** command and review the options.

The example rainbow tables are given at the bottom of the output.

2. Create a rainbow table by entering:

┌──(kali㉿Kali)-[~]

└─$ **sudo rtgen md5 loweralpha 1 3 0 1000 1000 0**

- *Update the system if it doesn't want to install*

`sudo apt-get update`

This command creates a rainbow table that can crack passwords that are three characters long and only consist of lower-case letters. The application created a fille with 1000 entries. Creating more complex rainbow tables can take significant time and use significant resources.

2. Verify the rainbow table is created. Display the contents of the rainbowcrack directory by entering the command:

┌──(kali㉿Kali)-[~]

└─$ **cd /usr/share/rainbowcrack**

┌──(kali㉿Kali)-[/usr/share/rainbowcrack]

└─$ **ls**

The newly created rainbow table should be in the directory as an **.rt** file.

### Step 3: Sort the rainbow table.

1. Next, the rainbow table must be sorted. Entering the command**: sudo rtsort** **.** at the prompt. (**Note**: be sure to include the space and the period after **rtsort** as part of the command)

┌──(kali㉿Kali)-[/usr/share/rainbowcrack]

└─$ **sudo rtsort .**

2. Generate a hash for a simple 3-character password which can then be cracked. Enter the command: **echo -n 'dog' | md5sum | awk '{print $1}'**.

┌──(kali㉿Kali)-[/usr/share/rainbowcrack]

└─$ **echo -n 'dog' | md5sum | awk '{print $1}'**

06d80eb0c50b49a509b49f2424e8c805

3. Crack the hash with the rainbow table with RainbowCrack. At the prompt, enter the **rcrack . -h 06d80eb0c50b49a509b492424e8c805** command.

┌──(kali㉿Kali)-[/usr/share/rainbowcrack]

└─$ **rcrack . -h 06d80eb0c50b49a509b492424e8c805**

Within milliseconds RainbowCrack should crack the hash and reveal the password **dog**.

4. You can also crack hashes contained in a .txt file as was done in Part 1 of the lab. To create a .txt file with some hashes, enter the following commands at the prompt:

**echo -n** **'fox' | md5sum | awk '{print $1}'** **>** **~/my_rainbow_hashes.txt**

**echo -n** **'boo' | md5sum | awk '{print $1}'** **>>** **~/my_rainbow_hashes.txt**

**echo -n** **'pop' | md5sum | awk '{print $1}'** **>>** **~/my_rainbow_hashes.txt**

To crack the hashes in the file, enter the **rcrack . -l ~/my_rainbow_hashes.txt** command at the prompt. The **-l** option tells rcrack to use a hash list file as input.

┌──(kali㉿Kali)-[/usr/share/rainbowcrack]

└─$ **rcrack .** **-l ~/my_rainbow_hashes.txt**

### Step 4: Explore resources to download rainbow tables.

In addition to generating Rainbow Tables with the **rtgen** command, there are many resources on the internet for downloading rainbow tables.

Open a web browser and search for **rainbow table download**.

#### Note
Short simple password hashes are cracked almost immediately using dictionaries and rainbow tables. Even fairly complex passwords can be cracked in a matter of hours.

Changing passwords periodically, securing servers that house user account and password files, securing wired and wireless networks so that attackers cannot capture password hashes in transit.

