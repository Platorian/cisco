What did i learn?

![[Pasted image 20240617052107.png]]

This topic discusses the intricacies of HTTP and web sessions in the context of web applications. HTTP is stateless, which means that an HTTP transaction consists of a single client request and a single server response, and it doesn't rely on a persistent connection. Various methods such as GET, POST, TRACE, PUT, DELETE, OPTIONS, and CONNECT are used for different purposes within the HTTP protocol.

HTTP proxies act as intermediaries between clients and servers. These proxies can perform tasks like facilitating HTTP transfers across firewalls and supporting caching of HTTP messages.

HTTP messages have a specific structure consisting of a message header and a body. The header controls the operation of HTTP servers, browsers, and proxies, while the body contains the content.

A web session is a sequence of HTTP transactions between a client and a server. To keep track of sessions, applications provide users with session IDs or tokens, which are exchanged by the user and the web application throughout the session. The tokens need to be long and should be managed properly to avoid manipulation or session fixation attacks.

The Open Web Application Security Project (OWASP) is an international organization dedicated to enhancing web application security. OWASP publishes a list of the top 10 application security risks, which is regularly updated. The OWASP Top 10 is considered essential for understanding the key vulnerabilities in web application security.

---

![[Pasted image 20240617052146.png]]

This topic discusses three popular Linux distributions for ethical hacking: Kali Linux, Parrot OS, and BlackArch Linux. These systems are easy to install and use, especially for beginners. To practice and develop penetration testing skills, the author recommends setting up a lab environment with intentionally vulnerable systems. These can be found in Omar Santos' GitHub repository at [https://h4cker.org/github](https://h4cker.org/github). For beginners, it's suggested to install Kali Linux or Parrot OS in a virtual machine and use WebSploit Labs for practice.

**NOTE** The VM you already installed in previous modules is sufficient for completing all the labs in this course.

---

![[Pasted image 20240617052213.png]]

Business logic flaws are unique vulnerabilities in an application's normal operations that are difficult to detect with standard tools. Their exploitation can lead to serious consequences, but can be prevented with robust data validation and threat modeling. OWASP and MITRE provide guidance and detailed information on these flaws. MITRE has assigned Common Weakness Enumeration (CWE) ID 840 to business logic errors. Examples include unverified ownership, authentication bypasses, weak password recovery mechanisms, incorrect ownership assignment, and flaws that apply to improper resource management and insufficient enforcement of unique actions and workflows.

---

![[Pasted image 20240617052242.png]]

This topic discussed the following injection-based vulnerabilities:

**SQL Injection Vulnerabilities**

SQL injection vulnerabilities pose a serious risk as they allow an attacker to view, insert, delete, or modify records in a database. The attack occurs when an attacker injects SQL commands into input fields of a web application or a URL to execute predefined SQL commands.

SQL statements are used in various ways, such as obtaining, updating, deleting, and inserting data into a database, as well as creating and modifying databases, tables, and indexes. SQL injections can be accomplished using user-supplied strings or numeric input.

There are three types of SQL injection attacks:

- In-band SQL injection, where data is obtained via the same channel used to inject the SQL code.
- Out-of-band SQL injection, where the attacker retrieves data using a different channel.
- Blind SQL injection, where the attacker doesn't make the application display or transfer any data, but discerns the information by sending specific statements and observing the application and database's behavior.

There are several techniques to exploit SQL injection vulnerabilities, such as using the Union operator to combine queries, Boolean to verify conditions, error-based technique to generate an error to refine the attack, out-of-band technique to obtain records from the database via a different channel, and time delay to use database commands to delay answers.

Identifying SQL injection vulnerabilities involves understanding when the application interacts with a database, making a list of input fields whose values could be used in a SQL query, and adding a single quote or a semicolon to the field or parameter in a web form.

Prevention of SQL injections involves using immutable queries like static queries, parameterized queries, and stored procedures that don't generate dynamic SQL. Immutable queries don't contain data that could be interpreted, which prevents injection attacks.

**Command Injection Vulnerabilities**

Command injection is an attack where a attacker executes unauthorized commands on a system through a weak application. This often happens when user-supplied data isn't properly validated. Despite becoming less common due to improved defenses in modern web applications, it remains a threat.

**LDAP Injection Vulnerabilities**

Lightweight Directory Access Protocol (LDAP) injection vulnerabilities occur when user input isn't properly validated before its use in LDAP statements, leading to potential unauthorized access or data manipulation. Like SQL injection, attackers exploit these flaws to gain valuable data or further infiltrate systems. The two main types of LDAP injection attacks are authentication bypass, which sidesteps credential checks, and information disclosure, which uses crafted LDAP packets to reveal organizational resources for reconnaissance.

---

![[Pasted image 20240617052316.png]]

This topic provides an in-depth look at various methods through which attackers can exploit authentication-based vulnerabilities in a system.

- **Credential Brute Forcing**: This is an attack that involves trying multiple combinations of usernames and passwords until the correct one is found.
- **Session Hijacking**: This involves intercepting a user's web session, which can be achieved by stealing the user's session ID, enabling the attacker to impersonate the user. Various methods exist for maintaining session state, such as cookies, URL parameters, and URL arguments on GET requests.
- **Redirecting**: Redirecting is an attack where an attacker can exploit unvalidated redirects and forwards in a web application. This could result in users being sent to a malicious website or the attacker accessing restricted areas of the application.
- **Exploiting Default Credentials**: This vulnerability arises when default usernames and passwords provided by device manufacturers aren't changed. Attackers can easily find these default credentials online and gain unauthorized access to systems.
- **Exploiting Weak Credentials**: This involves attackers taking advantage of weak or easily guessable usernames and passwords to gain access to a system.
- **Exploiting Kerberos**: Kerberos, a network authentication protocol, can also be exploited. In one notable example, an attacker can carry out a Kerberos golden ticket attack by manipulating Kerberos tickets based on available password hashes. Another vulnerability involves the misuse of Kerberos delegation, allowing an application to reuse user credentials to access resources hosted on another server.

These vulnerabilities highlight the need for robust security measures, including the use of HTTPS encryption for all web sessions, enforcing strong user credentials, validating redirects, and carefully managing session IDs.

---

![[Pasted image 20240617052344.png]]

This topic provides an overview of two common authorization-based vulnerabilities:

- **Parameter Pollution**: This vulnerability can occur if multiple HTTP parameters share the same name, leading to potential misinterpretation of values by the application. Attackers can exploit these vulnerabilities to bypass input validation, trigger application errors, or modify internal variable values. This can be done by finding forms or actions that allow user-supplied input, appending the same parameter with a different value to the GET or POST data, and analyzing the application's response to these changes.
- **Insecure Direct Object Reference Vulnerabilities**: These vulnerabilities arise when web applications allow direct access to objects based on user input. This can allow attackers to bypass authorization and access protected resources, such as database records or system files. These vulnerabilities occur when an application does not adequately sanitize user input or perform proper authorization checks. Attackers can exploit these vulnerabilities by modifying the value of a parameter used to directly point to an object. Examples given in the topic illustrate how attackers might change parameter values to retrieve or manipulate data they shouldn't be able to access.

---

![[Pasted image 20240617052407.png]]

Cross-site scripting (XSS) is one of the most prevalent web application vulnerabilities. The three primary types are Reflected XSS, Stored (persistent) XSS, and DOM-based XSS. These attacks occur when malicious scripts are executed in a user's browser. Attackers can use these vulnerabilities to execute malicious code, compromise accounts, hijack session cookies, modify or reveal local files, or redirect users to other sites.

Common locations of XSS vulnerabilities include search fields, HTTP headers, input fields, error messages, hidden fields, and anywhere user-supplied data is displayed. Examples of XSS tests can be performed from a browser's address bar or in a user input field in a web form.

In Reflected XSS attacks, malicious code is injected into a response as part of a valid HTTP request, often through a malicious link that reflects the attack back to the user's browser.

Stored XSS attacks, on the other hand, occur when malicious code is permanently stored on a vulnerable server or database. These attacks are common on websites with user-generated content like blog comments or forums.

DOM-based XSS attacks involve manipulating the Document Object Model (DOM), the API that treats HTML or XML documents as a tree structure. These attacks are typically reflected XSS attacks, but the payload is processed by the web client rather than being sent to the server.

Attackers can employ several techniques to evade XSS protections and security products, such as using alternative encoding, exploiting HTML tags, or embedding malicious files.

Mitigations against XSS attacks are centered on sanitizing and escaping untrusted input data. The general rules according to OWASP include using an auto-escaping template system, HTML escaping, JavaScript escaping, CSS escaping, URL escaping, HTML sanitization, preventing DOM-based XSS, using HTTPOnly cookie flag, implementing content security policy, using X-XSS-Protection response header, and converting untrusted input into safe HTML entities. It's also crucial to educate users about safe browsing habits to reduce the risk of falling victim to XSS attacks.

---

![[Pasted image 20240617052429.png]]

Cross-site request forgery (CSRF) attacks misuse the trust an application has in a user's browser, leading to unauthorized actions. A common example is an attacker creating a malicious link that alters a user's password. When clicked, the application, trusting the authenticated user's browser, allows the unwanted change.

---

![[Pasted image 20240617052448.png]]

Clickjacking is a technique where users are tricked into clicking hidden links or buttons. It can also be used to capture user keystrokes. To mitigate clickjacking, OWASP recommends sending directive response headers to instruct browsers not to allow framing from other domains and using defensive code to ensure the current frame is the top-level window.

---

![[Pasted image 20240617052521.png]]

This topic discusses two commonly exploited security misconfigurations:

- **Directory Traversal Vulnerabilities**: Attackers can exploit these to access files outside the web root folder by manipulating file references or using URL encoding. Preventive measures include understanding OS filename processes, not storing sensitive files in the web root, and careful input validation.
- **Cookie Manipulation Attacks**: Vulnerable applications can store user input unsafely, allowing attackers to control cookie data through client-side scripts. These attacks allow for arbitrary user cookie values to be set.

---

![[Pasted image 20240617052544.png]]

This topic explains local and remote file inclusion vulnerabilities in web applications. Local File Inclusion (LFI) vulnerabilities allow attackers to read and execute files on a victim's system. Remote File Inclusion (RFI) vulnerabilities enable attackers to execute code hosted on their system. The topic provides examples for both types of vulnerabilities.

---

![[Pasted image 20240617052604.png]]

This topic provides an overview of the following insecure code practices that can be exploited by attackers during penetration testing engagements:

- **Comments in Source Code**: Developers sometimes include sensitive information, such as passwords or API credentials, in the comments of their source code. Attackers can leverage this information if they find it.
- **Lack of Error Handling and Overly Verbose Error Handling**: Improper error handling can provide valuable information to attackers. Detailed error messages, including error codes, database dumps, and stack traces, can reveal potential vulnerabilities in the application.
- **Hard-Coded Credentials**: Hard-coded credentials in an application can allow attackers to compromise the application or the underlying system. This practice is a catastrophic flaw that should be avoided.
- **Race Conditions**: Race conditions occur when a system or application attempts to perform multiple operations simultaneously, requiring them to be done in a specific sequence. Attackers can exploit vulnerabilities during the small window of time between security controls taking effect and the attack being performed.
- **Unprotected APIs**: Many modern applications use APIs to interact with other systems, but often these APIs lack adequate security controls. APIs can provide valuable information to penetration testers, and it is important to secure them properly by using HTTPS, validating and sanitizing input data, and employing strong authentication and authorization standards.
- **Hidden Elements**: Web application parameter tampering attacks can be carried out by manipulating hidden form fields. Attackers may attempt to modify the values stored in these fields to manipulate application data.
- **Lack of Code Signing**: Code signing is the process of adding a digital signature to software to verify its authenticity and integrity. Lack of code signing allows attackers to modify and potentially impersonate legitimate applications.
- **Additional Web Application Hacking Tools**: Web proxies, such as Burp Suite and OWASP ZAP, are commonly used by ethical and malicious hackers to exploit web application vulnerabilities. These tools intercept, modify, or delete transactions between a web browser and a web application. Other tools like DirBuster, gobuster, ffuf, and feroxbuster can be used for reconnaissance and enumeration of files and directories in web applications.

Overall, these practices highlight various vulnerabilities that attackers can exploit, and it is essential to address them to ensure the security of applications and systems.

