**Protego Security Solutions**

Cross-site request forgery (CSRF) is a way that attackers can leverage the trust granted to a logged-in user at one site to execute code from a malicious site. It sounds complicated, I know. Unfortunately, this type of attack can be used against users of financial websites, for example, to transfer money to a hacker’s account without the user’s knowledge. It can also be used to make unauthorized purchases from ecommerce sites. Because of the possibility for lost money, it is essential to test for this vulnerability. Many vulnerability and code scanners have automated tests that are effective.

Vulnerabilities to CSRF can be difficult to mitigate. A few strategies for protecting against CSRF exploits have been shared across the web, however many of them don't work well. It is possible that developers have unknowingly used these ineffective mitigation techniques in their applications and think that they have mitigated the vulnerability when they actually have not. We usually use automated scanning to test for it and then investigate manually if we get alerts that the vulnerability exists.

**_ross-site request forgery_** (abbreviated **CSRF** or **XSRF**) attacks occur when unauthorized commands are transmitted from a user who is trusted by an application. CSRF attacks are different from XSS attacks because they exploit the trust that an application has in a user’s browser.

**NOTE** CSRF vulnerabilities are also referred to as _one-click attacks_ or _session riding_.

CSRF attacks typically affect applications (or websites) that rely on a user’s identity. Attackers can trick the user’s browser into sending HTTP requests to a target website. An example of a CSRF attack is a user authenticated by the application through a cookie saved in the browser unwittingly sending an HTTP request to a site that trusts the user, subsequently triggering an unwanted action.

Figure 6-21 shows an example of a CSRF attack using DVWA.

**_Figure 6-21_** _- CSRF Example_

![[Pasted image 20240616090231.png]]

In Figure 6-21, the web form asks the user to change a password. If you take a closer look at the URL in Figure 6-21, you see that it contains the parameters **password_new=test&password_conf=test&Change=Change#**. Not only is the password displayed in the URL after the user has entered it in the web form, but because the application allows this, an attacker can easily send a crafted link to any user to change his or her password, as shown here:

`http://192.168.78.8:66/vulnerabilities/csrf/?password_new=newpasswd&password_conf=newpasswd &Change=Change#`

If the user follows this link, his or her password will be changed to **newpasswd**.

**NOTE** CSRF mitigations and defenses are implemented on the server side. The paper located at the following link describes several techniques to prevent or mitigate CSRF vulnerabilities: [_https://seclab.stanford.edu/websec/csrf/csrf.pdf_](https://seclab.stanford.edu/websec/csrf/csrf.pdf).

---

Practice - CSRF/XSRF Attacks

**Q.** Which statement describes a cross-site request forgery (CSRF/XSRF) attack?

**A.** Cross-site request forgery (CSRF or XSRF) attacks occur when unauthorized commands are transmitted from an application's trusted user. CSRF attacks differ from XSS attacks because they exploit an application's trust in the user's browser.

