The following are some of the most popular tools that can be used to brute force, crack, and compromise user credentials:

- John the Ripper
- Cain and Abel
- Hashcat
- Hydra
- RainbowCrack
- Medusa and Ncrack
- CeWL
- Mimikatz
- Patator

---

**John the Ripper**

**_John the Ripper_** is a very popular tool for offline password cracking. John the Ripper (or john for short) can use search patterns as well as password files (or wordlists) to crack passwords. It supports different cracking modes and understands many ciphertext formats, including several DES variants, MD5, and Blowfish. John the Ripper does not support AES and SHA-2. To list the supported formats, you can use the **john --list=formats** command, as shown in Example 10-25. John the Ripper can also be used to extract Kerberos AFS and Windows passwords. John the Ripper can be downloaded from [_https://www.openwall.com/john_](https://www.openwall.com/john).

**_Example 10-25_** _-_ _Ciphertext Formats Supported by John the Ripper_

```
omar@kali:~$ john --list=formats

descrypt, bsdicrypt, md5crypt, bcrypt, scrypt, LM, AFS, tripcode, dummy,dynamic_n, bfegg, dmd5, dominosec, dominosec8, EPI, Fortigate, FormSpring,has-160, hdaa, ipb2, krb4, krb5, KeePass, MSCHAPv2, mschapv2-naive, mysql,
```

```
john hashes.txt
```

**TIP** You can customize John the Ripper to allow you to build different configurations. The configuration file can be named either john.conf on Unix and Linux-based systems or john.ini on Windows. For additional information about John the Ripper customization and configuration files, see [_https://www.openwall.com/john/doc/CONFIG.shtml_](https://www.openwall.com/john/doc/CONFIG.shtml). The configuration file can include a set of rules, including rules regarding the use of wordlists. The rules syntax can be obtained from [_https://www.openwall.com/john/doc/RULES.shtml_](https://www.openwall.com/john/doc/RULES.shtml).

John the Ripper also keeps a log in the private john "home directory" for the current user ( **~.john** ). The following is an example of a few lines of the log:

**TIP** One of the most popular wordlists is the _rockyou_ wordlist, which includes thousands of passwords that have been exposed in real-world breaches. In addition, the following two sites have comprehensive lists of wordlists containing millions of passwords: [_https://www.openwall.com/wordlists_](https://www.openwall.com/wordlists) and [_https://github.com/berzerk0/Probable-Wordlists_](https://github.com/berzerk0/Probable-Wordlists).

To use a wordlist in John the Ripper, you can use the following command:

```
john --wordlist mylist.txt hashes_to_crack.txt
```

**OTE** The following website provides tutorials showing different use cases for John the Ripper: [_https://openwall.info/wiki/john/tutorials_](https://openwall.info/wiki/john/tutorials).

There is a GUI version of John the Ripper called Johnny. Figure 10-18 shows a screenshot of Johnny.

---

**Cain**

**_Cain_** (or Cain and Abel) is a tool that can be used to “recover” passwords of Windows-based systems. Cain and Abel can be used to decipher and recover user credentials by performing packet captures (sniffing); cracking encrypted passwords by using dictionary, brute-force, and cryptanalysis attacks; and using many other techniques. Cain and Abel is a legacy tool, and archived information about it can be obtained from [_https://sectools.org/tool/cain/_](https://sectools.org/tool/cain/).

---

**Hashcat**

**_Hashcat_** is another password-cracking tool that is very popular among pen testers. It allows you to use graphical processing units (GPUs) to accelerate the password-cracking process.

**NOTE** Hashcat comes with Kali Linux and other penetration testing Linux distributions. You can also download it from [_https://hashcat.net/hashcat_](https://hashcat.net/hashcat).

Let’s take a look at an example of using Hashcat to crack several MD5 password hashes with wordlists. In Example 10-31, a file called my_hashes has three MD5 password hashes.

**_Example 10-31_** _-_ _The Contents of the my_hashes File_

```
root@kali:~# cat my_hashes
dc647eb65e6711e155375218212b3964
cc03e747a6afbbcbf8be7668acfebee5
337d9b6931fd8ea8781e18999f9a1c82
```

Example 10-32 shows how to use Hashcat to crack the passwords in the my_hashes file and output the results to a file called cracked_passwords. A wordlist called my_list is used to crack the passwords in this example.

**_Example 10-32_** _-_ _Cracking Passwords with Hashcat_

```
root@kali:~# hashcat --force -m 0 -a 0 -o cracked_passwords my_hashes my_list
hashcat (v4.1.0) starting...
OpenCL Platform #1: The pocl project
====================================
```

```
hashcat -m 0 -a 0 -o cracked.txt hydra-hash.txt /usr/share/wordlists/rockyou.txt
```

---

**Hydra**

**_Hydra_** is another tool that can be used to guess and crack credentials. Hydra is typically used to interact with a victim server (for example, web server, FTP server, SSH server, file server) and try a list of username/password combinations. For example, say you know that an FTP user’s username is omar. You can then try a file that contains a list of passwords against an FTP server (10.1.2.3). To accomplish this, you use the following command:

`hydra -l omar -P passwords.txt ftp://10.1.2.3`

The file passwords.txt contains a list of common passwords to try. In addition, you can create a file that has a combination of usernames and passwords and use Hydra to perform a brute-force attack, as follows:

`hydra -L logins.txt -P passwords.txt ftp://10.1.2.3`

---

**RainbowCrack**

Attackers can use **_rainbow tables_** – precomputed tables for reversing cryptographic hash functions – to accelerate password cracking. It is possible to use a rainbow table to derive a password by looking at the hashed value. The tool RainbowCrack can be used to automate the cracking of passwords using rainbow tables. You can download RainbowCrack from [_http://project-rainbowcrack.com_](http://project-rainbowcrack.com).

**NOTE** The following website includes a list of rainbow tables that can be used with RainbowCrack: [_http://project-rainbowcrack.com/table.htm_](http://project-rainbowcrack.com/table.htm).

---

**Medusa and Ncrack**

The **_Medusa_** and Ncrack tools, which are similar to Hydra, can be used to perform brute-force credential attacks against a system. You can install Medusa by using the **apt install medusa** command in a Debian-based Linux system (such as Ubuntu, Kali Linux, or Parrot OS). You can download Ncrack from [_https://nmap.org/ncrack_](https://nmap.org/ncrack) or install it by using the **apt install ncrack** command.

Example 10-36 shows how Ncrack can be used to perform a brute-force attack with the username chris and the wordlist my_list against an SSH server with IP address 172.18.104.166. The highlighted line shows the password (password123).

**_Example 10-36_** _-_ _Using Ncrack to Perform a Brute-Force Attack_

![[Pasted image 20240620063624.png]]
```
ncrack -p 22 --user chris -P my_list 172.18.104.166
```

Example 10-37 demonstrates how to use Medusa to perform the same attack.

**_Example 10-37_** _-_ _Using Medusa to Perform a Brute-Force Attack_

![[Pasted image 20240620063725.png]]
```
medusa -u chris -P my_list -h 172.18.104.166 -M ssh
```

---

**CeWL**

**_CeWL_** is a great tool that can be used to create wordlists. You can use CeWL to crawl websites and retrieve words. Example 10-38 shows how to use CeWL to create the wordlist words.txt by crawling the website [_https://theartofhacking.org_](https://theartofhacking.org). You can download CeWL from [_https://digi.ninja/projects/cewl.php_](https://digi.ninja/projects/cewl.php).

**_Example 10-38_** _-_ _Using CeWL to Create Wordlists_

![[Pasted image 20240620063916.png]]

---

**Mimikatz**

**_Mimikatz_** is a tool that many penetration testers and attackers (and even malware) use for retrieving password hashes from memory. It is also a useful post-exploitation tool. The Mimikatz tool can be downloaded from [_https://github.com/gentilkiwi/mimikatz_](https://github.com/gentilkiwi/mimikatz). Metasploit also includes Mimikatz as a Meterpreter script to facilitate exploitation without the need to upload any files to the disk of the compromised host. You can obtain more information about the Mimikatz and Metasploit integration at [_https://www.offsec.com/metasploit-unleashed/mimikatz/_](https://www.offsec.com/metasploit-unleashed/mimikatz/).

**NOTE** Module 8, “Performing Post-Exploitation Techniques,” discusses how Mimikatz is often used for post-exploitation activities and how it is used and integrated in tools like Empire and PowerSploit.

---

**Patator**

**_Patator_** is another tool that can be used for brute-force attacks on enumerations of SNMPv3 usernames, VPN passwords, and other types of credential attacks. You can download Patator from [_https://github.com/lanjelot/patator_](https://github.com/lanjelot/patator).

---

### Practice - Common Tools for Credential Attacks

**Q.** Match the credential attack tools to their descriptions.

**A.**
![[Pasted image 20240620064500.png]]

---
**Q.** You have discovered a password file on a compromised system and you want to attempt to crack some of the passwords using your Kali VM. To save time you will be using tables of precomputed hashes and a custom specialized wordlist derived from relevant web pages that you will create.

Which tools can you use to help accomplish this? (Choose all that apply.)

**A.** CeWL is used to generate custom wordlists from URLs. This is a way to generate wordlists that are relevant to certain topics, business functions, or products, for example. RainbowCrack uses rainbow tables, or tables of precomputed hashes, as a way to accelerate password cracking.

---
**Q.** During the penetration test of the Pixel Paradise customer, you have found a rogue webserver that is operating on a network without the knowledge of network administration. Port scans indicate that it is also running a remote login service. You would like to challenge the credentials on the server in order to gain root access. 

What tool would you use to accomplish this?

**A.** The Hydra tool, which is similar to Medusa, can be used to challenge remote logins using lists of usernames and passwords. In addition, it can target specific services, such as RDP. It differs from John the Ripper, which is used to crack already obtained lists of password hashes offline.

---
**Q.** You have gained access to webserver on the Pixel Paradise network by using a tool to test various username and password combinations. You would like to escalate the privileges of the compromised account by attempting to pull the root password from the system's memory.

Which post-exploitation tool will allow you to do this?

**A.** Mimikatz is a post-exploitation tool that can retrieve passwords from the memory of a compromised host.

---
**Q.** After using DNS tools for reconnaissance, you have discovered an mail server that appears to be running an outdated version of SMTP. You would like to enumerate the SMTP user accounts, and brute force the associated passwords. 

Which tool should you use to accomplish these tasks?

**A.** Patator has several strategies for enumerating SMTP usernames and can then be used to brute force the passwords that are associated with those users.

---
**Q.** 

**A.** 

---
