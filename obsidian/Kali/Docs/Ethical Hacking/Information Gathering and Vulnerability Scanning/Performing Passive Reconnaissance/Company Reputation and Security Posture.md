Security breaches can have a direct impact on a company’s reputation. Attackers can leverage information from past security breaches that an organization might have experienced. They may, for example, leverage the following data while trying to gather information about their victims:

- Password dumps
- File metadata
- Strategic search engine analysis/enumeration
- Website archiving/caching
- Public source code repositories

---

**Password Dumps**

Attackers can leverage password dumps from previous breaches. There are a number of ways that an attacker can get access to such password dumps, such as by using Pastebin, dark web websites, and even GitHub in some cases. Several different tools and websites make this task very easy. An example of a tool that allows you to find email addresses and passwords exposed in previous breaches is **h8mail**. You can install h8mail by using the **pip3 install h8mail** command, as demonstrated in Example 3-9. Example 3-9 also shows the h8mail command-line usage.

**_Example 3-9_** **_-_** _Installing and Using h8mail_

![[Pasted image 20240621090351.png]]

The following are additional tools that allow you to search for breach data dumps:

- **WhatBreach:** _[https://github.com/Ekultek/WhatBreach](https://github.com/Ekultek/WhatBreach)_
- **LeakLooker:** _[https://github.com/woj-ciech/LeakLooker](https://github.com/woj-ciech/LeakLooker)_
- **Buster:** _[https://github.com/sham00n/buster](https://github.com/sham00n/buster)_
- **Scavenger:** _[https://github.com/rndinfosecguy/Scavenger](https://github.com/rndinfosecguy/Scavenger)_
- **PwnDB:** _[https://github.com/davidtavarez/pwndb](https://github.com/davidtavarez/pwndb)_

Tools like h8mail and WhatBreach take advantage of breached data repositories of websites such as haveibeenpwned.com and snusbase.com. Historically, websites such as weleakinfo.com (seized by the FBI) have been used by criminals to dump information from past security breaches.

**File Metadata**

You can obtain a lot of information from metadata in files such as images, Microsoft Word documents, Excel files, PowerPoint files, and more. For instance, Exchangeable Image File Format (Exif) is a specification that defines the formats for images, sound, and supplementary tags used by digital cameras, mobile phones, scanners, and other systems that process image and sound files. Figure 3-3 shows the Exif data of a digital image (picture) captured by an iPhone.

Several tools can show Exif details. One of the most popular of them, ExifTool, is demonstrated in Example 3-10. This example shows the Exif metadata details of the same image whose details are shown in Figure 3-3.

**_Figure 3-3_** _- Exif Metadata of an Image Captured by an iPhone_

![[Pasted image 20240621090433.png]]

**_Example 3-10_** **_-_** _Using ExifTool_

![[Pasted image 20240621090509.png]]

---

**Strategic Search Engine Analysis/Enumeration**

Most of us use search engines such as DuckDuckGo, Bing, and Google to locate information. What you might not know is that search engines, such as Google, can perform much more powerful searches than most people ever dream of. Google can translate documents, perform news searches, and do image searches. In addition, hackers and attackers can use it to do something that has been termed _Google hacking_.

By using basic search techniques combined with advanced operators, both you and attackers can use Google as a powerful vulnerability search tool. The following are some advanced operators:

- **Filetype:** Directs Google to search only within the text of a particular type of file (for example, filetype:xls)
- **Inurl:** Directs Google to search only within the specified URL of a document (for example, inurl:search-text)
- **Link:** Directs Google to search within hyperlinks for a specific term (for example, link:www.domain.com)
- **Intitle:** Directs Google to search for a term within the title of a document (for example, intitle: “Index of /etc”)

By using these advanced operators in combination with key terms, both you and attackers can get Google to uncover many pieces of sensitive information that shouldn’t be revealed. These search strings are often called _Google dorks_.

To see how Google dorking works, enter the following phrase into Google:

**intext:JSESSIONID OR intext:PHPSESSID inurl:access.log ext:log**

This query searches in a URL for the session IDs that could be used to potentially impersonate users. It's not unusual for this search to find more than 100 sites that store sensitive session IDs in logs that were publicly accessible. If these IDs have not timed out, they could be used to gain access to restricted resources.

You can use advanced operators to search for many types of data. The following is another example of a Google search string (or Google dork) that can reveal passwords of web applications:

**"public $user =" | "public $password = " | "public $secret =" | "public $db =" ext:txt | ext:log -git**

Now that we have discussed some basic Google search techniques, let’s look at advanced Google hacking. We recommend that you visit the Google Hacking Database (GHDB) repositories at _[https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/)_. GHDB has the following search categories:

- Footholds
- Files containing usernames
- Sensitive directories
- Web server detection
- Vulnerable files
- Vulnerable servers
- Error messages
- Files containing juicy info
- Files containing passwords
- Sensitive online shopping info
- Network or vulnerability data
- Pages containing login portals
- Various online devices
- Advisories and vulnerabilities

GHDB is a community effort. Anyone can upload a new Google dork to perform these types of searches. Once you start playing with the dorks in GHDB, you will be surprised by the unbelievable things found through Google hacking. GHDB has made using Google dorks very easy, and there are other options as well. Later in this module, you will learn about additional tools that can be used to perform similar searches (such as Recon-ng).

---

**Website Archiving/Caching**

Several organizations archive and cache website data on the Internet. One of the most popular repositories is the “Wayback Machine” of Internet Archive (_[https://archive.org/web](https://archive.org/web)_).

The Wayback Machine allows you to go back in time on the Internet. For example, Figure 3-4 shows what Cisco’s website looked like on November 3, 1999. You can access the archive of the site shown in Figure 3-4 by copying the following link into your browser address bar: https://web.archive.org/web/19991103121048/http://www.cisco.com/.

**_Figure 3-4_** _- The Internet Archive Wayback Machine_

![[Pasted image 20240621090552.png]]

---

**Public Source Code Repositories**

An attacker can obtain extremely valuable information from public source code repositories such as GitHub and GitLab. Most of the applications and products we consume today use open-source software that is freely available in these public repositories. Attackers can find vulnerabilities in those software packages and use them to their advantage. Similarly, as a penetration tester, you can obtain valuable information from these public repositories. Even if you do not immediately find security vulnerabilities in the code, these repositories can give you insights into the architecture and underlying code used in the organization’s applications and infrastructure.

---

Practice - File Metadata

An attacker downloaded the file ourmission.jpg from a government office website. The attacker then issued a command **exiftool ourmission.jpg** on the workstation. What is the purpose of this operation?

Many file types contain metadata in addition to file content. Exchangeable Image File Format (Exif) is a specification that defines the formats for images, sound, and supplementary tags used by digital cameras, mobile phones, scanners, and other systems that process image and sound files. The Exif tool can be used to reveal the metadata of an image.

---

Practice - Web Archiving, Caching, and Public Code Repositories

A cybersecurity professional is helping the XYZ corporation to perform vulnerability assessments of the web services. The professional performed a Google search with the following string:

**xyz.com intext:JSESSIONID OR intext:PHPSESSID inurl:access.log ext:log**

Which term describes the part “intext:JSESSIONID OR intext:PHPSESSID inurl:access.log ext:log”?

A Google dork query, referred to as a dork, is a search string or custom query that uses advanced search operators combined with key terms to find information not readily available on a website. This information includes pieces of sensitive information that should not be revealed.

