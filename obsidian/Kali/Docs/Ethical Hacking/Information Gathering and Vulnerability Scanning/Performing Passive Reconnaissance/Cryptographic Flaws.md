During the reconnaissance phase, attackers often can inspect Secure Sockets Layer (SSL) certificates to obtain information about the organization, potential cryptographic flaws, and weak implementations. You can find a lot inside digital certificates: the certificate serial number, the subject common name, the uniform resource identifier (URI) of the server it was assigned to, the organization name, Online Certificate Status Protocol (OCSP) information, the certificate revocation list (CRL) URI, and so on.

**TIP** _Certificate revocation_ is the act of invalidating a digital certificate. For instance, if an application has been decommissioned or the certificate assigned to such application is compromised, you should revoke the certificate and add its serial number to a CRL. OCSP and CRLs are used to verify whether a certificate has been revoked (that is, invalidated) by the issuing authority.

Figure 3-1 shows the digital certificate assigned to h4cker.org. The certificate shows the organization that issued the certificate – in this case, Let’s Encrypt (letsencrypt.org) – the serial number, validity period, and public key information, including the algorithm, key size, and so on. Attackers can use this information to reveal any weak cryptographic configuration or implementation.

**_Figure 3-1_** _- The Digital Certificate Assigned to h4cker.org_

![[Pasted image 20240621085603.png]]

Attackers can also leverage certificate transparency to reveal additional information and enumerate subdomains. What is certificate transparency? More than a decade ago, there was a major attack against DigiNotar (an organization that creates, maintains, and authorizes digital certificates for many companies and government institutions). This attack (along with other similar attacks) raised concerns around organizations that generate and manage digital certificates. Subsequently, certificate transparency was created to better detect the issuing of malicious certificates. The goal of certificate transparency is for any organization or individual to be able to “transparently” verify the issuance of a digital certificate. Certificate transparency allows certificate authorities (CAs) to provide details about all certificates that have been issued for a given domain and organization. Attackers can also use this information to reveal what other subdomains and systems an organization may own.

**NOTE** You can obtain detailed information about certificate transparency from [https://certificate.transparency.dev](https://certificate.transparency.dev).

Tools such as crt.sh enable you to obtain detailed certificate transparency information about any given domain. Figure 3-2 shows the result of the query https://crt.sh/?q=h4cker.org in crt.sh for the domain h4cker.org. You can see in the search results multiple subdomains that were not known to the attacker before.

**_Figure 3-2_** _- Revealing Additional Subdomains Using Digital Certificate Information in crt.sh_

![[Pasted image 20240621085627.png]]

