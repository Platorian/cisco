An attacker can cause some modification on the initialization vector (IV) of a wireless packet that is encrypted during transmission. The goal of the attacker is to obtain a lot of information about the plaintext of a single packet and generate another encryption key that can then be used to decrypt other packets using the same IV. WEP is susceptible to many different attacks, including IV attacks.

**Attacks Against WEP**

Because WEP is susceptible to many different attacks, it is considered an obsolete wireless protocol. WEP must be avoided, and many wireless network devices no longer support it. WEP keys exist in two sizes: 40-bit (5-byte) and 104-bit (13-byte) keys. In addition, WEP uses a 24-bit IV, which is prepended to the pre-shared key (PSK). When you configure a wireless infrastructure device with WEP, the IVs are sent in plaintext.

WEP has been defeated for decades. WEP uses RC4 in a manner that allows an attacker to crack the PSK with little effort. The problem is related to how WEP uses the IVs in each packet. When WEP uses RC4 to encrypt a packet, it prepends the IV to the secret key before including the key in RC4. Subsequently, an attacker has the first 3 bytes of an allegedly “secret” key used on every packet. In order to recover the PSK, an attacker just needs to collect enough data from the air. An attacker can accelerate this type of attack by just injecting ARP packets (because the length is predictable), which allows the attacker to recover the PSK much faster. After recovering the WEP key, the attacker can use it to access the wireless network.

An attacker can also use the Aircrack-ng set of tools to crack (recover) the WEP PSK. To perform this attack using the Aircrack-ng suite, an attacker first launches Airmon-ng

**_Example_** 1 - _Using Airmon-ng to Monitor a Wireless Network_
```
airmon-ng start wlan0 11 
```

In Example 1, the wireless interface is **wlan0**, and the selected wireless channel is **11**. Now the attacker wants to listen to all communications directed to the BSSID **08:02:8E:D3:88:82**, as shown in Example 2. The command in Example 2 writes all the traffic to a capture file called **omar_capture.cap**. The attacker only has to specify the prefix for the capture file.

**_Example 2_** - _Using_ **_Airodump-ng_** _to Listen to All Traffic to the BSSID_ **_08:02:8E:D3:88:82_**
```
airodump-ng -c 11 --bssid 08:02:8E:D3:88:82 -w omar_capture wlan0
```

The attacker can use Aireplay-ng to listen for ARP requests and then replay, or inject, them back into the wireless network, as shown in Example 3.

**_Example 3_**  _Using Aireplay-ng to Inject ARP Packets_
```
aireplay-ng -3 -b 08:02:8E:D3:88:82 -h 00:0F:B5:88:AC:82 wlan0
```

The attacker can use Aircrack-ng to crack the WEP PSK, as demonstrated in Example 4.

**_Example 4_** _-_ _Using_ **_Aircrack-ng_** _to Crack the WEP PSK_
```
aircrack-ng -b 08:02:8E:D3:88:82 omar_capture.cap
```

**Attacks Against WPA**

WPA and WPA version 2 (WPA2) are susceptible to different vulnerabilities. WPA version 3 (WPA3) addresses all the vulnerabilities to which WPA and WPA2 are susceptible, and many wireless professionals recommend WPA3 to organizations and individuals.

All versions of WPA support different authentication methods, including PSK. WPA is not susceptible to the IV attacks that affect WEP; however, it is possible to capture the WPA four-way handshake between a client and a wireless infrastructure device and then brute-force the WPA PSK.

Figure 1 illustrates the WPA four-way handshake.

![[Pasted image 20240614091104.png]]

_Capturing the WPA Four-Way Handshake and Cracking the PSK_

Figure 2 illustrates the following steps:

**Step 1.** _An attacker monitors the Wi-Fi network and finds wireless clients connected to the corp-net SSID.

**Step 2.** The attacker sends DeAuth packets to deauthenticate the wireless client.

**Step 3.** The attacker captures the WPA four-way handshake and cracks the WPA PSK. (It is possible to use word lists and tools such as Aircrack-ng to perform this attack.)

![[Pasted image 20240614091539.png]]

**KRACK Attacks**

Mathy Vanhoef and Frank Piessens, from the University of Leuven, found and disclosed a series of vulnerabilities that affect WPA and WPA2. These vulnerabilities – also referred to as KRACK (which stands for _key reinstallation attack_) – and details about them, are published at [_https://www.krackattacks.com_](https://www.krackattacks.com).

Exploitation of these vulnerabilities depends on the specific device configuration. Successful exploitation could allow unauthenticated attackers to reinstall a previously used encryption or integrity key (either through the client or the access point, depending on the specific vulnerability). When a previously used key has successfully been reinstalled (by exploiting the disclosed vulnerabilities), an attacker may proceed to capture traffic using the reinstalled key and attempt to decrypt such traffic. In addition, the attacker may attempt to forge or replay previously seen traffic. An attacker can perform these activities by manipulating retransmissions of handshake messages.

**NOTE** For details about KRACK attacks, see [_https://blogs.cisco.com/security/wpa-vulns_](https://blogs.cisco.com/security/wpa-vulns)
**WPA3 Vulnerabilities**

No technology or protocol is perfect. Several vulnerabilities in WPA3 have been discovered in recent years. The WPA3 protocol introduced a new handshake called the “dragonfly handshake” that uses Extensible Authentication Protocol (EAP) for authentication. Several vulnerabilities can allow an attacker to perform different side-channel attacks, downgrade attacks, and DoS conditions. Several of these vulnerabilities were found by security researcher Mathy Vanhoef. (For details about these attacks, see [_https://wpa3.mathyvanhoef.com_](https://wpa3.mathyvanhoef.com).)

FragAttacks (which stands for fragmentation and aggregation attacks) is another type of vulnerability that can allow an attacker to exploit WPA3. For details and a demo of FragAttacks, see [_https://www.fragattacks.com_](https://www.fragattacks.com).

**Wi-Fi Protected Setup (WPS) PIN Attacks**

Wi-Fi Protected Setup (WPS) is a protocol that simplifies the deployment of wireless networks. It is implemented so that users can simply generate a WPA PSK with little interaction with a wireless device. Typically, a PIN printed on the outside of the wireless device or in the box that came with it is used to provision the wireless device. Most implementations do not care if you incorrectly attempt millions of PIN combinations in a row, which means these devices are susceptible to brute-force attacks.

A tool called Reaver makes WPS attacks very simple and easy to execute. You can download Reaver from [_https://github.com/t6x/reaver-wps-fork-t6x_](https://github.com/t6x/reaver-wps-fork-t6x).

