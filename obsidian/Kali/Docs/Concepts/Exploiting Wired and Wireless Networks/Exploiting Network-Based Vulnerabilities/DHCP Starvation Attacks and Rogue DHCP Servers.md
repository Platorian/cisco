Most organizations run DHCP servers. The two most popular attacks against DHCP servers and infrastructure are _DHCP starvation_ and _DHCP spoofing_ (which involves rogue DHCP servers). In a DHCP starvation attack, an attacker broadcasts a large number of DHCP REQUEST messages with spoofed source MAC addresses.

![[Pasted image 20240613084934.png]]

If the DHCP server responds to all these fake DHCP REQUEST messages, available IP addresses in the DHCP server scope are depleted within a few minutes or seconds. After the available number of IP addresses in the DHCP server is depleted, the attacker can then set up a rogue DHCP server and respond to new DHCP requests from network DHCP clients.

![[Pasted image 20240613085049.png]]

The attacker can set the IP address of the default gateway and DNS server to itself so that it can intercept the traffic from the network hosts.

_Setting Up a Rogue DHCP Server in Yersenia_

![[Pasted image 20240613085241.png]]

### Extra

**Q:** n the Pixel Paradise pen testing engagement, a single LAN has been designated as in-scope for disruptive tests. You are able to access the LAN over VPN and connect a DHCP server that is running in your ethical hacking tools VM. Which exploits will this server enable you to perform? Choose all that apply.

**A:** You have setup a rogue DHCP server. A rogue DHCP server is a server that network administration does not control and is unaware of. It offers users host, default gateway, and DNS server addresses when their DHCP settings renew. By setting the default gateway IP address to its own address in the DHCP offers that it sends out, the rogue server can receive all the traffic that clients send to non-local networks. It can also barrage the real DHCP server with spoofed DHCP discover messages. The attacker can thereby use the server to launch DoS (DHCP starvation_)_ and MITM (DHCP spoofing) attacks.