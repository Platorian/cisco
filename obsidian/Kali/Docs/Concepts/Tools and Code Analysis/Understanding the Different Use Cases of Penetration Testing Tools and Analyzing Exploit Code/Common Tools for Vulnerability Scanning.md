There are numerous vulnerability scanning tools, including open-source and commercial vulnerability scanners, as well as cloud-based services and tools. The following are some of the most popular vulnerability scanners:

- OpenVAS
- Nessus
- Nexpose
- Qualys
- SQLmap
- Nikto
- OWASP Zed Attack Proxy (ZAP)
- w3af
- DirBuster
- Brakeman
- Open Security Content Automation Protocol (SCAP) scanners
- Wapiti
- Scout Suite
- WPScan (Wordpress scanner)

**NOTE** Brakeman, SCAP, Wapiti, Scout Suite, and WPScan are not discussed further in this course. For more information, visit their websites:  
_[https://brakemanscanner.org/](https://brakemanscanner.org/)  
[https://www.open-scap.org/](https://www.open-scap.org/)  
[https://wapiti.sourceforge.io/](https://wapiti.sourceforge.io/)  
[https://github.com/nccgroup/ScoutSuite](https://github.com/nccgroup/ScoutSuite)  
[https://wpscan.org/](https://wpscan.org/)_  
OWASP lists additional vulnerability scanning tools not covered in this module at [_https://www.owasp.org/index.php/Category:Vulnerability_Scanning_Tools_](https://www.owasp.org/index.php/Category:Vulnerability_Scanning_Tools).

---

**OpenVAS**

OpenVAS is an open-source vulnerability scanner that was created by Greenbone Networks. The OpenVAS framework includes several services and tools that enable you to perform detailed vulnerability scanning against hosts and networks.

OpenVAS can be downloaded from [_https://www.openvas.org_](https://www.openvas.org), and the documentation can be accessed at [_https://docs.greenbone.net/#user_documentation_](https://docs.greenbone.net/#user_documentation).

**TIP** OpenVAS also includes an API that allows you to programmatically interact with its tools and automate the scanning of hosts and networks. The OpenVAS API documentation can be accessed at [_https://docs.greenbone.net/#api_documentation_](https://docs.greenbone.net/#api_documentation).

![[Pasted image 20240620053802.png]]

---

**Nessus**

The **_Nessus_** scanner from Tenable has several features that allow you to perform continuous monitoring and compliance analysis. Nessus can be downloaded from [_https://www.tenable.com/downloads/nessus_](https://www.tenable.com/downloads/nessus).

**NOTE** Tenable also has a cloud-based solution called Tenable.io. For information about Tenable.io, see [_https://www.tenable.com/products/tenable-io_](https://www.tenable.com/products/tenable-io).

---

**Qualys**

Qualys is a security company that created one of the most popular vulnerability scanners in the industry. It also has a cloud-based service that performs continuous monitoring, vulnerability management, and compliance checking. This cloud solution interacts with cloud agents, virtual scanners, scanner appliances, and Internet scanners.

**NOTE** Information about the Qualys scanner and cloud platform can be accessed at [_https://www.qualys.com_](https://www.qualys.com).

Tools like Qualys and Nessus also provide features that can be used for configuration compliance.

---

**SQLmap**

**_SQLmap_** is often considered a web vulnerability and SQL injection tool. It helps automate the enumeration of vulnerable applications, as well as the exploitation of SQL injection techniques that you learned in Module 6, “Exploiting Application-Based Vulnerabilities.” You can download SQLmap from [_http://sqlmap.org_](http://sqlmap.org).

Let’s take a look at a quick example of how to use SQLmap to exploit an SQL injection vulnerability. Say that a host with IP address 10.1.1.14 is vulnerable to SQL injection. In order to automate the enumeration and exploitation of this vulnerability, you first connect to the vulnerable application and capture the HTTP **GET** request by using a proxy. ( Module 6 describes how proxies work.) Example 10-15 shows the captured HTTP **GET** request to the vulnerable server (10.1.1.14).

**_Example 10-15_** _-_ _HTTP_ **_GET_** _Request to a Vulnerable Web Application_

![[Pasted image 20240620054219.png]]

The first highlighted line in Example 10-15 shows the **GET** request’s URI. The second highlighted line shows the cookie and the session ID (**PHPSESSID=1558e11b491da91be3b68e5cce953ca4**). You can use this information to launch the SQLmap tool, as shown in Example 10-16.

**_Example 10-16_** _-_ _Using the SQLmap Tool to Exploit an SQL Injection Vulnerability_

```
root@kali:~# sqlmap -u "http://10.1.1.14/dvwa/vulnerabilities/sqli/?id=omar&Submit=Submit" --cookie="security=low; PHPSESSID=1558e11b491da91be3b68e5cce953ca4" --dbs
```

![[Pasted image 20240620054416.png]]

![[Pasted image 20240620054441.png]]

![[Pasted image 20240620054500.png]]

The first four highlighted lines in Example 10-16 show how SQLmap automates the various tests and payloads sent to the vulnerable application. (You might recognize some of these SQL statements and queries from Module 6.) The last few highlighted lines show how SQLmap was able to enumerate all the databases in the SQL server.

When you have a list of all available databases, you can try to retrieve the tables and records of the dvwa database by using the command shown in Example 10-17.

**_Example 10-17_** _-_ _Retrieving Sensitive Information from a Database_

```
root@kali:~# sqlmap -u "http://10.1.1.14/dvwa/vulnerabilities/sqli/?id=omar&Submit=Submit" --cookie="security=low; PHPSESSID=1558e11b491da91be3b68e5cce953ca4" -D dvwa --dump-all
```

![[Pasted image 20240620054758.png]]

![[Pasted image 20240620054822.png]]

The first four highlighted lines in Example 10-17 show how SQLmap was able to automatically enumerate users from the compromised database and crack their passwords. The rest of the highlighted lines show the contents (records) of the two tables in the database (users and guestbook).

**TIP** You can practice your penetration testing skills by using tools such as SQLmap against vulnerable applications. The Art of Hacking GitHub repository includes a list of vulnerable servers and applications that you can download and use to practice your skills in a safe environment; see [_https://github.com/The-Art-of-Hacking/art-of-hacking/tree/master/vulnerable_servers_](https://github.com/The-Art-of-Hacking/art-of-hacking/tree/master/vulnerable_servers).

nstead of just launching tools against vulnerable applications, try to read the debugging messages and understand what the tool is doing. For instance, in Example 10-16 and Example 10-17, you can see the different SQL statements that are being sent to the vulnerable application and subsequently to the SQL server.

**NOTE** You can obtain access to SQLmap’s source code and additional documentation at the following GitHub repository: [_https://github.com/sqlmapproject/sqlmap_](https://github.com/sqlmapproject/sqlmap)

---

**Nikto**

**_Nikto_** is an open-source web vulnerability scanner that can be downloaded from [_https://github.com/sullo/nikto_](https://github.com/sullo/nikto). Nikto’s official documentation can be accessed at [_https://cirt.net/nikto2-docs_](https://cirt.net/nikto2-docs) .

```
nikto -h <Target>
```

You can automate the scanning of multiple hosts by using Nmap and Nikto together. For example, you can scan the 10.1.1.0/24 subnet with Nmap and then pipe the results to Nikto, as demonstrated in Example 10-20.

**_Example 10-20_** _-_ _Combining Nmap and Nikto to Scan a Full Subnet_

```
root@kali:~# nmap -p 80 10.1.1.0/24 -oG - | nikto -h -
- Nikto v2.1.6
----------------------------------------------------------------------+ nmap Input Queued: 10.1.1.11:80
+ nmap Input Queued: 10.1.1.12:80
+ nmap Input Queued: 10.1.1.14:80
+ Target IP:               10.1.1.12
+ Target Hostname:       10.1.1.12
+ Target Port:            80
+ Start Time:          2018-06-23 22:56:15 (GMT-4)<output omitted for brevity>+ 22798 requests: 0 error(s) and 29 item(s) reported on remote host+ End Time:             2018-06-23 22:57:00 (GMT-4) (30 seconds)----------------------------------------------------------------------+ 3 host(s) tested
```

---

**OWASP Zed Attack Proxy (ZAP)**

According to OWASP, **_OWASP Zed Attack Proxy (ZAP)_** “is one of the world’s most popular free security tools and is actively maintained by hundreds of international volunteers.” Many offensive and defensive security engineers around the world use ZAP, which not only provides web vulnerability scanning capabilities but also can be used as a sophisticated web proxy. ZAP comes with an API and also can be used as a fuzzer. You can download and obtain more information about OWASP ZAP from [_https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project_](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project).

Figure 10-16 shows an active scan against a web server with IP address 10.1.1.14.

Figure 10-17 shows a few of the results of the scan. The vulnerability highlighted in Figure 10-17 is a path traversal vulnerability. Numerous other vulnerabilities were also found by ZAP. ZAP Spider automatically discovers URLs on the site that is being tested. It starts with a list of URLs to visit, called “seeds.” ZAP Spider then attempts to access these URLs, identifies all the hyperlinks in the page, and adds the hyperlinks to the list of URLs to visit; the process continues recursively as long as new resources are found. During the processing of a URL, ZAP Spider makes a request to access a resource and then parses the response.

**_Figure 10-16_** _- Scanning a Web Application Using OWASP ZAP_

![[Pasted image 20240620055345.png]]

---

**w3af**

Another popular open-source web application vulnerability scanner is **_w3af_**. w3af can be downloaded from [_https://w3af.org_](https://w3af.org), and its documentation can be obtained from [_https://w3af.org/howtos_](https://w3af.org/howtos).

Example 10-21 shows the help menu of the w3af console.

**_Example 10-21_** _-_ _The Help Menu of the w3af Console_

![[Pasted image 20240620055438.png]]

The w3af tool has a plugins menu that allows you to configure and enable mangle, crawl, bruteforce, audit, and other plugins.

When you are in the plugins mode, you can use the **list audit** command to list all the available audit plugins.

Example 10-24 shows the w3af tool being configured to perform an SQL injection audit against the web server with IP address 10.1.1.14.

**_Example 10-24_** _-_ _Launching an SQL Injection Audit Using w3af_

![[Pasted image 20240620055600.png]]

**NOTE** For detailed w3af usage and customization, refer to [_https://docs.w3af.org/en/latest_](https://docs.w3af.org/en/latest).

---

**DirBuster**

_DirBuster_ is a tool that was designed to brute force directory names and filenames on web application servers. DirBuster is currently an inactive project, and its functionality has been integrated into and enhanced in OWASP ZAP as an add-on.

**NOTE** DirBuster is a Java application designed to brute force directories and filenames on web/application servers. Often what looks like a web server with a default installation actually has pages and applications hidden within it. DirBuster attempts to find these. Two few additional alternatives to DirBuster are **_gobuster_** ([_https://github.com/OJ/gobuster_](https://github.com/OJ/gobuster)) and ffuf ([_https://github.com/ffuf/ffuf_](https://github.com/ffuf/ffuf)). Keep in mind that tools of this nature are often as only good as the directory and file lists they come with.

---

### Practice - Common Tools for Vulnerability Scanning

**Q.** Match the vulnerability scanning tool to its description.

**A.** 

![[Pasted image 20240620055953.png]]

---

**Q.** The scope of the penetration testing agreement with a customer includes vulnerability scanning of the client's cloud presence. Which tool should you choose for the job?

**A.** Scout Suite is a vulnerability scanner designed to assess the security posture of cloud environments.

---

**Q.** True or False. w3af is a vulnerability scanner that can also perform exploits.

**A.** w3af is a modular tool that includes vulnerability scanning and exploit creation.

---

**Q.** Which tool brute forces directories and filenames on web and application servers?

**A.** DirBuster was created to use brute force methods to discover hidden directories and files on web and application servers. It is no longer maintained and is now available as an add-on for OWASP ZAP. Gobuster is a more up-to-date alternative.

---

**Q.** You are testing the Pixel Paradise web application for injection vulnerabilities. What tool will discover injection vulnerabilities and also launch exploits of the underlying databases?

**A.** SQLmap is designed to uncover and exploit SQL injection vulnerabilities.

---

**Q.** 

**A.** 

---

