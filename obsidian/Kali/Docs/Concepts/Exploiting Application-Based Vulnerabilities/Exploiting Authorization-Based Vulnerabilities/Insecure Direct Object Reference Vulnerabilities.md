Insecure Direct Object Reference vulnerabilities can be exploited when web applications allow direct access to objects based on user input. Successful exploitation could allow attackers to bypass authorization and access resources that should be protected by the system (for example, database records, system files). This type of vulnerability occurs when an application does not sanitize user input and does not perform appropriate authorization checks.

An attacker can take advantage of Insecure Direct Object References vulnerabilities by modifying the value of a parameter used to directly point to an object. In order to exploit this type of vulnerability, an attacker needs to map out all locations in the application where user input is used to reference objects directly.

Let’s go over a few examples on how to take advantage of this type of vulnerability. The following example shows how the value of a parameter can be used directly to retrieve a database record:

`https://store.h4cker.org/buy?customerID=1188`

In this example, the value of the **customerID** parameter is used as an index in a table of a database holding customer contacts. The application takes the value and queries the database to obtain the specific customer record. An attacker may be able to change the value **1188** to another value and retrieve another customer record.

In the following example, the value of a parameter is used directly to execute an operation in the system:

`https://store.h4cker.org/changepassd?user=omar`

In this example, the value of the user parameter (**omar**) is used to have the system change the user’s password. An attacker can try other usernames and see if it is possible to modify the password of another user.

**TIP** Mitigations for this type of vulnerability include input validation, the use of per-user or session Indirect Object References, and access control checks to make sure the user is authorized for the requested object.

---

**Q.** You want to determine if a web application has authorization-based vulnerabilities. Which two exploits would you attempt in order to identify such vulnerabilities?

**A.** HTTP parameter pollution and Insecure Direct Object Reference are authorization-based vulnerabilities. Kerberos weakness, session hijacking, and default credentials are authentication-based vulnerabilities.

