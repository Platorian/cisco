**Protego Security Solutions Task**

We're completing reconnaissance and now want to catalog the vulnerabilities that are found on various systems, networks, and applications. Vulnerability scanners link discovered vulnerabilities with public vulnerability info, such as CVE numbers. From there, you can uncover details about the vulnerabilities and explore means of exploiting them for the next phase of the penetration test.

Practice with some different approaches to scanning for vulnerabilities before we get started with our scans of Pixel Perfect's resources.

n this lab, you will explore network vulnerability scanning tools and use them to perform a vulnerability scan on a target host.

- Perform network scans with Nmap.
- Use Greenbone Vulnerability Management to perform a vulnerability scan.

# Instructions

## Part 1: Run a Nmap Scan on a Target Computer

In this part, you will use Nmap and NSE scripts to uncover potential vulnerabilities in a target host.

### Step 1: Start and login to the Kali virtual machine.

1. Start and log into the Kali virtual machine.
2. Start a terminal session. Expand the terminal window to a full screen. Use the **ping** command to determine if the computer with the address **10.6.6.23** or **gravemind.vm** is reachable over the network.

```
ping -c5 10.6.6.23
```

The **-c5** option tells the ping command to stop after five tries. In Linux, when a -**c** option is not specified the **ping** command will continue indefinitely until **CTRL-C** is issued.

### Step 2: Identify open ports and services.

Review the results of a Nmap scan on the host with the IP address 10.6.6.23.

1. Execute a ping scan of the target host using the **nmap -sV** command. Note the list of ports and applications that are discovered on the host.

```
nmap -sV 10.6.6.23
```

Identify the operating system running on the target computer using the **nmap -O** command.

```
sudo nmap -o 10.6.6.23
```

### Step 3: Use the Nmap Vulners script to scan for vulnerabilities.

The Vulners script displays known vulnerabilities and the corresponding CVE. The Vulners script uses the open port and software version information to search for common platform enumeration (CPE) names that relate to the identified service. It then makes a request to a remote server to find out if any known vulnerabilities exist for that CPE.

1. Use the **nmap –script** command to launch the **vulners** script. The syntax for the command is `nmap -sV --script vulners [--script-args mincvss=<arg_val>] <target>` where the script argument **mincvss** restricts the output to only those CVEs that have a higher CVSS score than the one specified in the argument.

The vulnerabilities reported will be those with a CVE score equal to or higher than 4. The output of the command should look similar to what is shown below:

```
nmap -sV --script vulnvers --script-args mincvss=4 10.6.6.23
```

Use the National Vulnerability Database at NIST to learn more about the identified vulnerability and how it can be exploited. ([https://nvd.nist.gov/vuln/search](https://nvd.nist.gov/vuln/search))

## art 2: Use GVM to Scan for Vulnerabilities

GVM is part of the Open Source Vulnerability Management suite of products produced by Greenbone Networks GmbH. The GVM scanner is one of the most widely used open-source vulnerability scanners. Unlike Nmap, GVM uses a graphical user interface to initiate scans and report vulnerability scan results.

### Step 1: Verify the GVM Product Installation.

Before beginning any scan, it is important to verify that GVM is correctly installed and that the files it uses to identify vulnerabilities are up-to-date.

1. Verify the setup of the GVM service using the **sudo gvm-check-setup** command. This command verifies that the setup completed correctly and the necessary files are available. The verification will flag any issues that need fixing and will provide the commands to use to fix the issues.

```
sudo gvm-check-setup
```

2. If there are issues, execute the suggested command to fix the problem and then re-run the **gvm-check-setup** command. When all issues are addressed, the command outputs the string “**It seems like your GVM [_version_] installation is OK.**”.
3. Just for this activity, stop the GVM service so you can observe the startup output.

```
sudo gvm-stop
```

### Step 2: Open the GVM Scanner GUI.

1. Start the GVM scanner using the **sudo gvm-start** command. You can also access the **gvm-start** script using the Applications menu on the Kali desktop, **Kali ->02-Vulnerability Analysis -> gvm start.** It is possible that GVM may already be running as a result of the check setup process.

The output of the command should be similar to what is shown below. At the end of the output, a message that the scanner is loading in Firefox will appear.

```
sudo gvm-start
```

2. A browser window will open with a security warning that can be ignored. If the browser does not automatically open, start your browser manually and navigate to **https://127.0.0.1:9392**. Click the **Advanced** button and scroll down and accept the risk on the warning screen to proceed.
3. In the Greenbone Security Assistant login box, enter **admin** as the username and **kali** as the password.

Username: **admin**

Password: **kali**

4. The GVM Scanner application GUI should open in the browser. Select **Scans -> Tasks** from the menu bar. At the upper left of the **Tasks** window appear three icons. Select the **Task Wizard** icon that looks like a magic wand. Choose **Task Wizard** from the dropdown menu.

### Step 3: Scan the Target Host for Vulnerabilities

In this step you will scan the same target computer for vulnerabilities that you did with the earlier Nmap scan.

1. In the **IP address or hostname** box, enter the IP address **10.6.6.23** or **gravemind.vm**. Click the **Start Scan** button at the bottom of the screen. The scan will take a few minutes, so wait for it to complete. The status and percent complete are displayed on the screen. The scan will be finished when the status changes to **Done**.
2. Click the number under the **Reports** column while the scanning is running for the associated scan.
3. When the scan is complete, click the timestamp under the **Date** column to view the report detail.
4. The CVEs associated with the vulnerabilities that were found on the host can be viewed by clicking the **CVEs** tab. Explore the other tabs.
5. Download the report by clicking **the Download Filtered Report** button from the menu in the upper left of the report page. It has a downward-pointing arrow icon. In the settings box, choose to download the report in PDF format. After a brief delay, the PDF file should open in your browser.

When you are done with GVM services, use the following command to stop GVM.

┌──(kali㉿Kali)-[~]

└─$ **sudo gvm-stop**

