**Protego Security Solutions Task**

Nmap is a classic active reconnaissance tool for pentesters. Every pentester should be familiar with it because it has unparalleled flexibility. Nmap is a command line tool and Zenmap is a GUI version of it. While Zenmap makes knowledge of the wide range of Nmap options less crucial, Zenmap can not replace fluency at the Nmap command line.

We will begin doing active reconnaissance on our client's systems soon. Please practice your Nmap skills in this lab so you can fully participate as our team works on the Pixel Paradise engagement.

In this lab, you will complete the following objectives:

- Investigate Nmap
- Perform Basic Nmap Scans

Lab Network

![[Pasted image 20240621100005.png]]

# Instructions

## Part 1: Investigate Nmap

### Step 1: Log into Kali Linux and verify the environment.

1. Log into the Kali system with the username **kali** and the password **kali**_._ You are presented with the Kali desktop.
2. Open a terminal window.
3. Verify that Kali has an interface in the 10.6.6.0/24 network using the **ifconfig** command.
4. Use the **nmap -V** command to verify that Nmap is installed and to display the Nmap version. The output will be similar to what is shown below.

```
nmap -V
```

### Step 2: Investigate Nmap Options and Features

1. Using the command **nmap** without specifying any options or targets returns a list of commonly used Nmap options. To access the Nmap help system use the command **nmap -h**. The help output is divided into sections based on the type of detection that the option supports.
2. The man page for Nmap provides additional information. To access the man page, enter the command **man nmap**. To exit the man pages, press **q** to quit and return to the terminal prompt.

Use the man page for Nmap to complete the table.

![[Pasted image 20240621100203.png]]

## Part 2: Perform Basic Nmap Scans

### Step 1: Initiate a basic Nmap scan of the target computer.

1. To quickly scan the DMZ for active hosts, you can perform a discovery scan. In a discovery scan, the scanning host sends an ICMP echo request (ping), a TCP SYN to port 443, a TCP ACK to port 80, and an ICMP timestamp request. A response to any of the requests indicates that the host is up and the IP protocol stack on the host is functioning. Enter the following command to scan the DMZ network:

```
nmap -sn 10.6.6.0/24
```

The host 10.6.6.23 was identified as suspicious in a Wireshark capture, and it is necessary to perform additional reconnaissance to discover more about the computer and its services. Use the **nmap** command to execute a default scan on the target host.

```
nmap 10.6.6.23
```

By default, Nmap performs a connect scan of 1000 most common TCP ports. This makes use of the operating system’s networking software to establish a full TCP connection. This type of scan creates a lot of networking traffic and increases the probability of detection by intrusion detection services. You can also specify a TCP connect scan using the command option **nmap -sT**.

![[Pasted image 20240621100337.png]]

The **-O** option can be used to further determine information about the operating system running on the target host. Some Nmap options require additional permissions and must be run as **root** or using the **sudo** command. To find operating system information on the target host, use the **nmap -O** command. Enter the password of **kali** when prompted.

```
sudo nmap -O 10.6.6.23
```

### Step 2: Obtain additional information about the host and services.

1. To provide additional information about the target computer, it is possible to combine different options into a single command line. The previous command identified several potentially open ports on the 10.6.6.23 host. You can use **-v**, **-p**, and **-sV** to find additional information about the services running on the open ports. This command provides information about the FTP service running on port 21 on the target in verbose mode, with the timing set to fast (**-T4**):

```
nmap -v -p21 -sV -T4 10.6.6.23
```

2. The **-A** option executes OS detection, version detection, script scanning, and traceroute. The **-A** scan can be very intrusive and therefore will be detected by many IDS systems, so ensure that you have permission before attempting this scan outside of the lab environment. To gather more information regarding the FTP service, enter the command **nmap -p21 -sV -A 10.6.6.23**.

The sample detailed output of this command is shown below:

```
nmap -p21 -sV -A 10.6.6.23
```

Examine the output of the **nmap -A** command. Notice that the output indicates that a connection was made between the Kali Linux system and the target FTP service.

### Step 3: Investigate SMB Services with Scripts

The Server Message Block (SMB) protocol is a network file sharing protocol supported on Windows computers and by SAMBA on Linux. SMB enables applications to read and write files or request services over a network. Open public shares or shared devices such as print servers on a network, can be accessed through SMB.

1. The earlier scan of open ports on the target computer indicates that the SMB ports 139 and 445 are open. Find more information on these ports using the **-A** and **-p** command options. The **-A** option executes several functions including running the default scripts. Specify more than one port to scan by listing them separately with a comma between them.

```
nmap -A -p139,445 10.6.6.23
```

Examine the information returned by the Nmap scan. From this information, it can be determined that the target computer is a member of the default workgroup, named WORKGROUP, and that SMB supported on this host through SAMBA on Linux.

3. map contains the powerful Nmap Scripting Engine (NSE), which enables the programming of various Nmap options and conditional actions to be taken as a result of the responses. NSE has built-in scripts that enumerate users, groups, and network shares. One of the more commonly used scripts for SMB discovery is the **smb-enum-users.nse** script. Use the Nmap NSE script with the command:

```
nmap --script smb-enum-users.nse -p139,445 10.6.6.23
```

A serious security concern is the existence of publicly shared directories (folders). You can enumerate the network shares using another NSE script, **smb-enum-shares.nse.** To discover shared directories on the target computer. Use the Nmap share enumeration script with the command:

```
nmap --script smb-enum-shares.nse -p445 10.6.6.23
```

Examine the output created by the **smb-enum-shares** script. In the output, share names that end with a “$” character represent hidden shares that include system and administrative shares.

There are preprogrammed scripts that can provide additional SMB discovery capabilities if an authorized user account is available. Take time and investigate some of the NSE scripts that enumerate Windows and SAMBA systems.

