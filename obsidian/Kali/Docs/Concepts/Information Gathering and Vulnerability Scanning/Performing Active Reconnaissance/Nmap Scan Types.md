The following sections cover some of the most common Nmap scanning options used for specific scenarios, including the following:

- TCP Connect Scan (**-sT**)
- UDP Scan (**-sU**)
- TCP FIN Scan (**-sF**)
- Host Discovery Scan (**-sn**)
- Timing Options (**-T 0-5**)

---

**TCP Connect Scan ( -sT )**

A TCP connect scan actually makes use of the underlying operating system’s networking mechanism to establish a full TCP connection with the target device being scanned. Because it creates a full connection, it creates more traffic (and thus takes more time to run). This is the default scan type that is used if no scan type is specified with the **nmap** command. However, it should typically be used only when a SYN scan is not an option, such as when a user who is running the **nmap** command does not have raw packet privileges on the operating system because many of the Nmap scan types rely on writing raw packets. This section illustrates how a TCP connect scan works and provides an example of a scan from a Kali Linux system. Table 3-3 defines the TCP connect scan responses.

**_Table 3-3_** _-_ _TCP Connect Scan Responses_

![[Pasted image 20240621093401.png]]

Figure 3-9 illustrates how a TCP connect scan works.

**_Figure 3-9_** _- TCP Connect Scan Illustration_

![[Pasted image 20240621093422.png]]

Example 3-20 shows the output of a full TCP connection scan.

**_Example 3-20_** _-_ _Nmap TCP Connect Scan Sample Output_

![[Pasted image 20240621093439.png]]

The output in Example 3-20 shows the results of an Nmap TCP connect scan. As you can see, the results indicate that a number of TCP ports are listening on the target device, and these results are very similar to the result shown in Example 3-19.

A full TCP connect scan requires the scanner to send an additional packet per scan, which increases the amount of noise on the network and may trigger alarms that a half-open scan wouldn’t trigger. Security tools and the underlying targeted system are more likely to log a full TCP connection, and intrusion detection systems (IDSs) are similarly more likely to trigger alarms on several TCP connections from the same host.

**TIP** Nmap scans only the 1000 most common ports for each protocol. You can specify additional ports to scan by using the -p option. You can obtain additional information about the port specifications and scan order from _[https://nmap.org/book/man-port-specification.html](https://nmap.org/book/man-port-specification.html)_. Omar Santos has also created an Nmap Cheat Sheet that includes all options and is available in his GitHub repository, _[https://github.com/The-Art-of-Hacking/h4cker/blob/master/cheat_sheets/NMAP_cheat_sheet.md](https://github.com/The-Art-of-Hacking/h4cker/blob/master/cheat_sheets/NMAP_cheat_sheet.md)_.

---

**UDP Scan ( -sU )**

The majority of the time, you will be scanning for TCP ports, as this is how you connect to most services running on target systems. However, you might encounter some instances in which you need to scan for UDP ports – for example, if you are trying to enumerate a DNS, SNMP, or DHCP server. These services all use UDP for communication between client and server. To scan UDP ports, Nmap sends a UDP packet to all ports specified in the command-line configuration. It waits to hear back from the target. If it receives an ICMP port unreachable message back from a target, that port is marked as closed. If it receives no response from the target UDP port, Nmap marks the port as open/filtered. Table 3-4 shows the UDP scan responses.

**NOTE** You should be aware that ICMP unreachable messages can sometimes be rate limited, and when they are, a UDP port scan can take much longer. ICMP rate limiting is primarily used for throttling worm or virus-like behavior and should normally be configured to allow 1% to 5% of available inbound bandwidth (at 10Mbps or 100Mbps speeds) or 100kpbs to 10,000kbps (at 1Gbps or 10Gbps speeds) to be used for ICMP traffic.

**_Table 3-4_** _-_ _UDP Scan Responses_

![[Pasted image 20240621093517.png]]

Figure 3-10 illustrates how a UDP scan works.

**_Figure 3-10_** _- UDP Scan Illustration_

![[Pasted image 20240621093541.png]]

The output in Example 3-21 shows the results of an Nmap UDP scan on port 53 of the target 192.168.88.251. As you can see, the results indicate that this port is open.

**_Example 3-21_** _-_ _Nmap UDP Scan Sample Output_

![[Pasted image 20240621093557.png]]

---

**TCP FIN Scan ( -sF )**

There are times when a SYN scan might be picked up by a network filter or firewall. In such a case, you need to employ a different type of packet in a port scan. With the TCP FIN scan, a FIN packet is sent to a target port. If the port is actually closed, the target system sends back an RST packet. If nothing is received from the target port, you can consider the port open because the normal behavior would be to ignore the FIN packet. Table 3-5 shows the TCP FIN scan responses.

**NOTE** A TCP FIN scan is not useful when scanning Windows-based systems, as they respond with RST packets, regardless of the port state.

**_Table 3-5_** _-_ _TCP FIN Scan Responses_

![[Pasted image 20240621093621.png]]

Figure 3-11 illustrates how a TCP FIN scan works.

**_Figure 3-11_** _- TCP FIN Scan Illustration_

![[Pasted image 20240621093653.png]]

Example 3-22 shows the output of a TCP FIN scan against port 80 of the target. The output shows the results of an Nmap TCP FIN scan, specifying port 80 on the target. The response from the target indicates that the port is open/filtered.

**_Example 3-22_** _-_ _Nmap TCP FIN Scan Sample Output_

![[Pasted image 20240621094050.png]]

---

**Host Discovery Scan ( -sn )**

A host discovery scan is one of the most common types of scans used to enumerate hosts on a network because it can use different types of ICMP messages to determine whether a host is online and responding on a network.

**NOTE** The default for the -sn scan option is to send an ICMP echo request packet to the target, a TCP SYN to port 443, a TCP ACK to port 80, and an ICMP timestamp request. This is documented at _[https://nmap.org/book/man-host-discovery.html](https://nmap.org/book/man-host-discovery.html)_. If the target responds to the ICMP echo or the aforementioned packets, then it is considered alive.

Example 3-23 shows an example of a ping scan of the 192.168.88.0/24 subnet. This is a very basic host discovery scan that can be performed to determine what devices on a network are live. Such a scan for host discovery of an entire subnet is sometimes referred to as a _ping sweep_.

**_Example 3-23_** _-_ _Nmap Host Discovery Scan_

![[Pasted image 20240621094111.png]]

---

**Timing Options ( -T 0-5 )**

The Nmap scanner provides six timing templates that can be specified with the **-T** option and the template number (0 through 5) or name. Nmap timing templates enable you to dictate how aggressive a scan will be, while leaving Nmap to pick the exact timing values. These are the timing options:

- **-T0 (Paranoid)** : Very slow, used for IDS evasion
- **-T1 (Sneaky)** : Quite slow, used for IDS evasion
- **-T2 (Polite)** : Slows down to consume less bandwidth, runs about 10 times slower than the default
- **-T3 (Normal)** : Default, a dynamic timing model based on target responsiveness
- **-T4 (Aggressive)** : Assumes a fast and reliable network and may overwhelm targets
- **-T5 (Insane)** : Very aggressive; will likely overwhelm targets or miss open ports

**NOTE** Normal mode is the default Nmap mode. If you use this mode (by specifying - **T3**), you will not see any difference from a regular scan. You can find additional information about the Nmap timing options and performance at _[https://nmap.org/book/man-performance.html](https://nmap.org/book/man-performance.html)_.

---

Practice - Nmap Scan Types

A cybersecurity technician is using the Nmap tool to perform a port scan using the command:

**nmap -sn 172.16.50.0/24**

Which type of port scan is being used by the technician?

A host discovery scan is one of the most common scans used to enumerate hosts on a network. The command to perform a host discovery scan using the Nmap tool is **nmap -sn _network_/_prefix_**.

An attacker is using the Nmap tool to perform a port scan with the command:

**nmap -sn -T0 172.18.12.0/24**

What is the purpose of using option -T0?

The Nmap scanner provides six timing templates that can be specified with the -T option and the template number (0 through 5) or name:

- -T0 (Paranoid): Very slow, used for IDS evasion
- -T1 (Sneaky): Quite slow, used for IDS evasion
- -T2 (Polite): Slows down to consume less bandwidth and runs about ten times slower than the default
- -T3 (Normal): Default, a dynamic timing model based on target responsiveness
- -T4 (Aggressive): Assumes a fast and reliable network and may overwhelm targets
- -T5 (Insane): Very aggressive; will likely overwhelm targets or miss open ports

