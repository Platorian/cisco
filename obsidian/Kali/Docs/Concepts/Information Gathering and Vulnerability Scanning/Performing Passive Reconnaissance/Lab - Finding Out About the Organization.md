**Protego Security Solutions Task**

Part of our engagement with Pixel Paradise involves uncovering whether sensitive information has been leaked that could be available from stolen information brokers on the dark web. Enormous data breaches have resulted in millions of records containing personally identifiable information being made available to cybercriminals. Employees could use their company email addresses to register with companies that have later been breached. Some employees could even use their work account username and password to register. 

We need to see if data breaches have resulted in cybersecurity vulnerabilities at Pixel Paradise. We can use these vulnerabilities later in our penetration test, and we will certainly inform our customer about the vulnerabilities and provide strategies to mitigate them.

Use this lab to get familiar with the different ways that we learn about companies and the potential risks to them caused by data breaches.

In this lab, you will complete the following objectives:

- Find information about email breaches.
- View file metadata.

# Instructions

## Part 1: Find Information about Email Breaches.

It is possible to learn more about a person or organization by searching on a known email address. It is useful to determine if employees of a company have had their work email addresses compromised. Several online services provide the ability to search on individual email addresses and entire domains to reveal breaches. Some of those sites are:

- haveibeenpwned.com
- f-secure.com
- hacknotice.com
- breachdirectory.com
- keepersecurity.com

### Step 1: Investigate your email status.

Explore the different sites and search for your own email address or the domain of a company that you know of. It is especially concerning if a recent data breach has occurred for a domain. It is also possible that a penetration testing client is unaware of the breach.

Resources exist that will allow access to these data breach files. From there, you may be able to find usernames, email addresses, passwords, and other information about employees. This information will be very useful in the exploitation part of the PenTesting process.

Have your email addresses been part of a breach? If so, in which breach or breaches were they disclosed?

### Step 2: Use a tool to find email addresses for a domain.

You will use a tool called EmailHarvester to find information about a domain, including email addresses of personnel.

1. Open a terminal and enter the command **emailharvester**. The tool has not yet been installed in Kali, but it is part of the Kali toolset. Enter **y** to agree to install the tool and provide the password for the user **kali** if prompted.
2. After installation is complete, use the **-h** option to see the options available in the tool.

### Step 3: Use Spiderfoot to research email addresses.

1. Open the Spiderfoot GUI:

┌──(kali㉿Kali)-[~]

└─$ **spiderfoot -l 127.0.0.1:5001**

2. Minimize (don’t close) the terminal.
3. Open the Spiderfoot GUI in your browser using the IP address and port assigned above.
4. Click the **Settings** menu item and investigate the available modules. Read the descriptions of the modules and investigate the API requirements if any. Optionally, register for some of the free API keys. Configure the modules with the keys.

Look for modules that would be useful for doing email scans. For example, you would like to know whether the address is part of breach, what accounts are registered to the address on social media sites and code repositories, link sharing, and technical forums. Make note of your findings.

![[Pasted image 20240621090910.png]]

There are others.

5. Try running a new scan on an interesting email address by selecting the interesting modules in the **New Scan** > **By Module** tab.
6. After making your selections and supply scan name and target, scroll to the bottom of the page and click **Run Scan Now**.

## Part 2: View File Metadata.

File metadata can provide hackers with insights into organizations and personnel. For example, metadata within an image file can reveal the device that was used create the image. This can reveal information that can be used to determine if the device is potentially vulnerable. Some files have metadata consisting of comments, the author’s name, usernames, the operating system, or the location at which the file was created. Metadata varies by the type of file and the device on which it was created. Hackers can use this information to piece together a means of attack.

In general, files that are posted on the public internet should have their metadata stripped or at least scrutinized. You can use ExifTool, among others, to remove or edit tags from individual files or a directory of files.

ExifTool comes in a GUI version that is available for Windows, MacOS, and Linux.

### Step 1: Install ExifTool.

1. In Firefox, click the **Kali Tools** shortcut or navigate to [https://www.kali.org/tools](https://www.kali.org/tools).
2. Select **List all tools** as necessary. Locate the entry for **libimage-exiftool-perl**.
3. Follow the instructions to install ExifTool. 
4. ExifTool refers to metafile attributes as tags. Use the **-list** option to view all the tags that ExifTool can process.
5. Issue the **exiftool -listf** command to review the file types that ExifTool can analyze.

ExifTool can read metadata from a wide range of files. Review the output and complete the table with some of the common file formats that ExifTool can read by type.

![[Pasted image 20240621090942.png]]

### Step 2: Use ExifTool.

You will need some files that you can use to explore metadata with the tool. You can do so with files that you have on your PC, or better yet, files that you can find openly available online.

1. Go to the Google Hacker Database (GHDB). Locate dorks that will help you to find a variety of files of various types or modify the dorks that you find to do so.
2. Download the files to your VM. Make note of the path to the folder.
3. Experiment with ExifTools. Start by simply running the exiftool command followed by the path and file name for the target file. Review the metadata that is returned. Do this for a number of files.

Did you find any information that could be useful to ethical hackers?

Author, organization, location, or device-related information, among others.

4. Now try running ExifTool for the entire folder. For this, you only supply the path.
5. You can save the metadata for each image in the folder, or for individual images by adding the **-csv** option. For example:

```
┌──(kali㉿Kali)-[~]

└─$ exiftool -csv > /path/to/out.csv <File Or Dir>
```

6. On the internet, research some of the values that you find in the file. For example, the tag **CREATOR: gd-jpeg v1.0** indicates that the image was generated by the PHP GD library version 1.0. Search the internet **for PHP GD vulnerability** to learn more.

---

What types of files will ExifTool read metadata from? (Choose all that apply.)

Most common media files are supported by ExifTool. While it does read two database formats, the creator of the tool does not indicate that SQL-related files are supported.








