**Protego Security Solutions Task**

Open source information is a valuable resource for learning about organizations, their networks, and their employees. Here at Protego, we really like SpiderFoot and Recon-ng. Use this learning lab to get familiar with OSINT in general and these tools in particular.

I think you will enjoy exploring these resources. It is fun to play detective when doing reconnaissance of a client organization.

In this lab, you will explore several OSINT tools that are commonly used by pentesters.

- Examine OSINT resources.
- Use SpiderFoot
- Investigate Recon-ng
- Find interesting files with Recon-ng

---

## Part 1: Examine OSINT Resources

### Step 1: Access the OSINT Framework

The OSINT Framework is a useful way to visualize the OSINT tools and resources that are available. Unfortunately, it has become a bit outdated, with some resources no longer available. It is still valuable to help you understand the types of tools available and their uses. In many cases, the links are still good.

1. Go to the OSINT Framework site at [https://osintframework.com/](https://osintframework.com/).
2. You will see a vertical tree-like structure that consists of categories of OSINT tools and resources that can be reached from the framework. Click **Username** at the top of the tree. You will then see two subcategories appear. Click each to open the resource trees for each subcategory. Note in the upper-right corner of the page is a legend that identifies the type of resource.
3. Under **Username Search Engines**, click **"WhatsMyName(T)"**.
4. The link takes you to a Git repository for the WhatsMyName project. In the **README.md** content for the tool, the various sites that implement WhatsMyName are listed. Feel free to explore these, but we will click the first link [https://whatsmyname.app/](https://whatsmyname.app/) to visit a free website that implements WhatsMyName.

The parent organization for the site, [https://www.osintcombine.com/](https://www.osintcombine.com/), has several interesting free tools available.

5. In the search box, type in a few usernames, each on a separate line. Use your own usernames or others that you find. Try searching the internet for **common username wordlist** for other potential search terms. You can filter the results based on the category filters, but for now, just click the green magnifying glass button to start the search.

In a pentest, you would use another tool, such as **SpiderFoot** (below) to find usernames in email addresses that are associated with a company or domain.

6. Investigate the results. You can open the links to the accounts either from the green rectangles or the table of results.
7. WhatsMyName provides a very flexible report of the results. The results table can be sorted by column, and you can export the results as CSV or PDF for reporting purposes. In addition, you can easily filter by username and search within the results. Finally, you get links for the profile pages for the users at many different sites.

### Step 2: Investigate SMART - Start Me Aggregated Resource Tool.

The start.me web service is a popular bookmark manager and productivity tool. The people at My OSINT Training (MOT) have set up a search system that finds all OSINT-related links that people have bookmarked and shared on start.me. There are many. You can enter OSINT-relevant search terms to find links to related resources.

1. Go to [https://smart.myosint.training/](https://smart.myosint.training/).
2. In the search box, enter the term **usernames**. You will see a list of username-related OSINT tools that other people have found.
3. Open some of the links to review the resources. Be careful however, these websites come from public sources. Some may be malicious.
4. Choose some of the categories that you saw in the OSINT Framework and see what links appear.
5. Use this site to search for OSINT tools and resources to help you in your pentesting work.

## Part 2: Use SpiderFoot

SpiderFoot is an automated OSINT scanner. It is included with Kali. SpiderFoot queries over 1000 open-information sources and presents the results in an easy-to-use GUI. SpiderFoot can also be run from a console. SpiderFoot seeds its scan with one of the following:

- Domain names
- IP addresses
- Subnet addresses
- Autonomous System Numbers (ASN)
- Email addresses
- Phone numbers
- Personal names

SpiderFoot offers the option of choosing scans based on use case, required data, and by SpiderFoot module. The use cases are:

- All – Get every possible piece of information about the target. This use case can take a very long time to complete.
- Footprint – Understand the target’s network perimeter, associated identities and other information that is yielded by extensive web crawling and search engine use.
- Investigate – This is or targets that you suspect of malicious behavior. Footprinting, blacklist lookups, and other sources that report on malicious sites will be returned.
- Passive – This type of scan is used if it is undesirable for the target to suspect that it is being scanned. This is a form of passive OSINT.

### Step 1: Start and run SpiderFoot.

In a terminal, enter the following command:

┌──(kali㉿Kali)-[~]

└─$ **spiderfoot -l 127.0.0.1:5001**

The command should run without errors. Open a browser and enter the IP address and port for the SpiderFoot GUI. You will see the SpiderFoot interface appear. If this is the first time that SpiderFoot has been opened in this VM, you will see the Scans screen. This screen displays a list of all the scans recently run. In this example it is empty.

### Step 2: Explore SpiderFoot.

1. Before we get started, look at the scanners that SpiderFoot uses to build its reports. Go to the **Settings** tab.
2. The first two entries in the menu at the left are concerned with the operation of SpiderFoot. The entries below this are for the scanners that SpiderFoot uses. There are over 200 of them. Click the scanners to see their SpiderFoot module name, details about the scanner, and settings that can be made, if any. Complete the table below with some examples. The Scanner name is in the settings menu. The module name appears in the details for the scanner. All SpiderFoot modules are referred to as sfp_[module name].

**Hint**: scanners with a lock next to them indicate an API key is necessary. Further information regarding the key requirements is provided in the details for the scanner. Click the “?” icon next to the API Settings option.

**Hint**: You can interact with SpiderFoot from the terminal too. You can display all the modules that are available in SpiderFoot and pipe the output to a text file. Enter **spiderfoot –h** to view the command line options.

3. The **grep** command can then be used to search the file for keywords. This will not provide information about API requirements, but it will help you to make sense of the list of available modules.

┌──(kali㉿Kali)-[~]

└─$ **spiderfoot -M | grep _[search term]_**

4. Using the **grep** command and the GUI, complete the table below.

**Note**: Answers will vary. Some modules do the same thing or do multiple things.

![[Pasted image 20240621083436.png]]

### Step 3: Run a SpiderFoot Scan for a Domain.

1. Click the **New Scan** tab in the GUI.
2. Enter a name for the scan and select a target. In this case, we will use **h4cker.org**.
3. You will scan by use case. Note that you can also scan by the type of information required or by selecting the individual scanner modules that you would like to use. By executing narrower scans, you can learn more about the modules and information that can be gathered.
4. Select the scan use case as **Footprint**.

**Note**: The **All** use case scan may use active scanning. Unless you have permission to scan the target, you should avoid this setting. To be completely safe, the Passive use case should avoid any problems with unauthorized scanning.

5. Click the **Run Scan Now** button.
6. You should see a bar graph appear. The scan statistics will start to increment, and new bars will appear in the graph as new results are obtained. Mouse over the bars for a summary of the findings for that data type.
7. SpiderFoot scans are very detailed and can take a very long time. Give this scan at least 30 minutes so that there is a nice collection of information. To get the most details, a scan could take hours. While the scan is running, you can browse the results.

### Step 4: Investigate Scan Results.

1. Go back to the scan results, by clicking the **Scans** tab. You will see a table with the currently running scan and any previous scans displayed.
2. Click the black square in the right-most column of the scans table to stop the scan. Some information is not available until the scan is aborted or completed.
3. Click the name of the scan in the table to return to the scan view. You will be taken to the **Browse** tab. Each row in the table represents data found by the various modules. Some modules contribute to multiple types of data.
4. Investigate the results.

### Step 5: Register API Keys (optional).

API keys will enhance the functionality of SpiderFoot. Some of these API keys require free registration. The pentesting tools that are available are constantly evolving. Some tools or services that were once free and open can become fee-based over time.

**Note**: Some APIs may limit your results after you have reached a prescribed number of uses.

1. Go to the **Settings** tab.
2. Find the four modules in the table below. Open the page for the module and complete the table including the type of information that module searches for. For each module in the table, click the ? next to the API option. Follow the instructions to get API keys for the four modules.

![[Pasted image 20240621083525.png]]

3. Enter the API keys in the settings for each module. Be sure to save your changes.
4. Click **New Scan**. Go to the By Module tab. Select only the modules for which you have added API keys. All other modules should be unchecked.
5. Enter the target as **h4cker.org** and click **Start Scan**. Feel free to scan other domains but be sure to observe the terms and conditions of this course.

### Step 6: Analyze Results of API Modules Scans.

1. This scan should not take very long.
2. Browse the scan to look at the results. Pay attention to the **Source Module** column. You should see some of the scanners that you configured with API keys.
3. Go to the Leak Site URL type in the table of results.

## Part 3: Investigate Recon-ng

Recon-ng is an OSINT framework that is similar to the Metasploit exploitation framework or the Social-Engineering Tooklit (SET). If consists of a series of modules that can be run in their own workspaces. The modules can be configured to run with option settings that are specific to the module. This simplifies running Recon-ng at the command line because options for the modules are independently set within the workspace. When you run the module, it uses these settings to perform its searches.

As the name suggests, Recon-ng is used to perform a wide range of reconnaissance activities on different settings that you provide. Some modules are available with the Kali installation and others are available for download and installation in the Recon-ng modules marketplace.

### tep 1: Create a workspace.

Recon-ng has auto complete. Press the tab button to complete commands and command options. Use the tab key twice to list the available commands and options at different places in the command line. This is very handy.

1. To run Recon-ng, open a new terminal window and enter **recon-ng**. You can also start the program by going to the Kali tools menu, searching for the app, and clicking the icon.
2. Note that the terminal prompt changes to indicate that you are working within the Recon-ng framework. Enter **help** to get a sense of the commands that are available.
3. Recon-ng uses workspaces to isolate investigations from one another. Workspaces can be created for different parts of a test or different customers for example. Type **workspaces help** to view options for the workspaces command.
4. Create a workspace named **test** by entering **workspaces create** followed by the workspace name. Note that the prompt has changed to indicate that you are in this workspace.
5. Type **help** to see the commands that are available within workspaces.

### Step 2: Investigate modules.

Recon-ng is a modular framework. Modules are Python programs with different functions. They are stored in an external marketplace that permits developers to create their own modules and contribute them for use by others.

Return to the Recon-ng prompt. Enter the **modules search** command. This will display the currently installed modules.

### Step 3: Investigate the module marketplace.

Recon-ng will not function without modules. In this step, we will install modules from the Recon-ng marketplace. The module marketplace is a GitHub public repository. Search the web for **recon-ng-marketplace** to view the repository. Explore the folders to learn more about the modules.

1. In the terminal, view help for the **marketplace** command. Use the **search** option to list all the modules that are currently available.

[recon-ng][default] > **marketplace search**

2. Note that the modules are organized by their category and type. This appears as a path prepended to the name of the module. You can filter the output by adding a search term to the marketplace search command. Try a few different search terms that are related to OSINT information to get a sense of the modules that are available.

### Step 6: Investigate the web interface.

Recon-ng has a web interface that simplifies and improves viewing results that are stored in Recon-ng databases. It also allows easy export of the results tables for reporting purposes.

1. Open a new terminal.
2. Enter the **recon-web** command to start the Recon-ng server process. Note the command output.
3. In a new browser tab, access the webpage using the URL information provided in the output.
4. The web interface shows data from the default workspace when first opened. Click the orange workspace name at the top of the page to display data from different workspaces.

## Part 4: Find Interesting Files with Recon-ng

In this part of the lab, we will install and use another plugin.

### Step 1: Install another module.

1. Search the marketplace for a module that will discover interesting files in a domain. The plugin that you use should have no dependencies or key requirements. `discovery/info_disclosure/interesting_files`

### Step 2: Run the new module.

1. Set the source option to **hackxor.net** or another location of your choice. (Please comply with the terms of the course when choosing a domain.) The h4cker.org website is interesting also.
2. Run the command. This module creates a .csv file in the recon-ng/data folder.
3. Locate the file and view the contents. Some of these files can be downloaded or viewed using the URLs in the command output.

---

You are planning to use SpiderFoot to discover details about the Pixel Paradise domain as part of the reconnaissance effort. Which SpiderFoot use case should be used so that Pixel Paradise security staff will be not be aware of your activities?

Some of the Spiderfoot use cases employee active reconnaissance techniques that interact directly with some of the target's devices. To be absolutely sure that your efforts will not be detected, use the Passive use case.




