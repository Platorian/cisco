What Did I Learn in this Module?

![[Pasted image 20240618123516.png]]

This topic describes various methods of maintaining persistence on a compromised system, the use of shells and command and control (C2) systems, and the process of creating additional backdoors and accounts.

After compromising a system, persistence can be achieved through several methods, such as creating a bind or reverse shell, manipulating scheduled jobs and tasks, creating custom daemons and processes, creating new users, or creating additional backdoors. These measures allow the hacker to take actions like uploading additional tools, performing scans and enumerations, launching brute-force attacks, and performing system manipulation using compromised credentials.

Shells such as bind or reverse shells are software utilities that act as an interface between a user and the operating system. Tools like Meterpreter and Netcat can create these shells. A bind shell allows an attacker to open a port on the compromised system and wait for a connection, whereas a reverse shell can overcome firewall challenges by allowing the victim's system to initiate a connection to the attacker's system.

C2 systems are often used by attackers to send commands and instructions to compromised systems, and can be anything from the attacker’s system to a virtual server, or even cloud services like Dropbox or Twitter.

Scheduled jobs and tasks can also be manipulated by an attacker for persistence. Windows, for instance, has commands that allow for the automated execution of tasks. Similarly, custom daemons, processes, and additional backdoors can be created on a victim's system. If the attacker has administrator (root) access, they can even create additional accounts to maintain access and interaction with the victim system.

![[Pasted image 20240618123534.png]]

The concept of lateral movement, also known as pivoting, is a method cyber attackers use after breaching a network to move from one system to another. The aim is to avoid detection, steal sensitive data, and maintain persistent access for future data exfiltration. The importance of network segmentation is also highlighted as a preventive measure against such activities.

Post-exploitation scanning involves identifying other vulnerable systems within the network. This can be done through basic port scans or with tools like Nmap and Metasploit. Techniques like logging into SMB shares with compromised credentials, creating SMB shares, and using remote access protocols are also discussed.

Legitimate Windows utilities, such as PowerShell, Windows Management Instrumentation (WMI), and Sysinternals are used for post-exploitation activities, a practice often referred to as "living-off-the-land." PowerShell can be used for a range of tasks from getting directory listings to administrative tasks.

The PowerShell-based post-exploitation frameworks PowerSploit and Empire can be used for activities like keylogging, bind shells, reverse shells, Mimikatz, and more. Another tool is BloodHound, a JavaScript web application that reveals hidden relationships in a Windows Active Directory environment.

Windows Management Instrumentation (WMI) can be exploited by attackers to manage data and operations on Windows operating systems. Sysinternals, a suite of command-line tools, has the ability to reveal running processes and control Windows-based computers from a remote terminal.

Windows Remote Management (WinRM) provides another way for attackers to connect to Windows systems and maintain persistent access.

Privilege escalation is where a user gains additional privileges beyond those intended by the developer, either vertically (accessing higher-privileged functions) or horizontally (accessing functions or content reserved for other users).

Covering your tracks after a penetration testing engagement is important, along with methods such as suppressing logs, deleting user accounts and files, and removing any backdoors or services installed. Steganography is a technique for hiding messages inside other content is a method for obfuscation, evasion, and track covering.

---

Reflection Questions

You have exploited a vulnerability and gained access to devices on the network. So now what? Gaining access is just part of an attack. Why is merely gaining access during a pentest not enough? Persistence in a pentest means gaining access and maintaining a presence in the network that can be used in various ways. What are some of the things that pen testers (and threat actors) do while they have prolonged access to a network?

In order to maintain persistent access, it is necessary to avoid detection. If network security personnel become aware of your presence and activities, they will take measures to not only deny you access, but to also determine and mitigate the vulnerabilities and exploits that allowed you access. This will make it much more difficult to regain access in the future. What sort of activities could alert security personnel to your presence? What can you do to make detection of your activities more difficult while you continue to exploit the network?

---

Quiz - Performing Post-Exploitation Techniques

